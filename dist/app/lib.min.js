!function(a,b){"function"==typeof define&&define.amd?define("p5",[],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.p5=b()}(this,function(){var amdclean={};return amdclean.shim=function(){window.requestDraw=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}()}({}),amdclean.constants=function(){var a=Math.PI;return{ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",HALF_PI:a/2,PI:a,QUARTER_PI:a/4,TAU:2*a,TWO_PI:2*a,DEGREES:"degrees",RADIANS:"radians",CORNER:"corner",CORNERS:"corners",RADIUS:"radius",RIGHT:"right",LEFT:"left",CENTER:"center",TOP:"top",BOTTOM:"bottom",BASELINE:"alphabetic",POINTS:"points",LINES:"lines",TRIANGLES:"triangles",TRIANGLE_FAN:"triangles_fan",TRIANGLE_STRIP:"triangles_strip",QUADS:"quads",QUAD_STRIP:"quad_strip",CLOSE:"close",OPEN:"open",CHORD:"chord",PIE:"pie",PROJECT:"square",SQUARE:"butt",ROUND:"round",BEVEL:"bevel",MITER:"miter",RGB:"rgb",HSB:"hsb",AUTO:"auto",ALT:18,BACKSPACE:8,CONTROL:17,DELETE:46,DOWN_ARROW:40,ENTER:13,ESCAPE:27,LEFT_ARROW:37,OPTION:18,RETURN:13,RIGHT_ARROW:39,SHIFT:16,TAB:9,UP_ARROW:38,BLEND:"normal",ADD:"lighter",DARKEST:"darken",LIGHTEST:"lighten",DIFFERENCE:"difference",EXCLUSION:"exclusion",MULTIPLY:"multiply",SCREEN:"screen",REPLACE:"source-over",OVERLAY:"overlay",HARD_LIGHT:"hard-light",SOFT_LIGHT:"soft-light",DODGE:"color-dodge",BURN:"color-burn",NORMAL:"normal",ITALIC:"italic",BOLD:"bold",LINEAR:"linear",QUADRATIC:"quadratic",BEZIER:"bezier",CURVE:"curve"}}({}),amdclean.core=function(a,b,c){"use strict";var c=c,d=function(a,b,e){2===arguments.length&&"boolean"==typeof b&&(e=b,b=void 0),this._setupDone=!1,this._pixelDensity=window.devicePixelRatio||1,this._startTime=(new Date).getTime(),this._userNode=b,this._curElement=null,this._elements=[],this._preloadCount=0,this._updateInterval=0,this._isGlobal=!1,this._loop=!0,this._styles=[],this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,click:null,mousewheel:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._loadingScreenId="p5_loading",this._start=function(){if(this._userNode&&"string"==typeof this._userNode&&(this._userNode=document.getElementById(this._userNode)),this._loadingScreen=document.getElementById(this._loadingScreenId),!this._loadingScreen){this._loadingScreen=document.createElement("loadingDiv"),this._loadingScreen.innerHTML="loading...",this._loadingScreen.style.position="absolute";var a=this._userNode||document.body;a.appendChild(this._loadingScreen)}this.createCanvas(this._defaultCanvasSize.width,this._defaultCanvasSize.height,!0);var b=this.preload||window.preload,c=this._isGlobal?window:this;b?(this._preloadMethods.forEach(function(a){c[a]=function(){var b=Array.prototype.slice.call(arguments);return c._preload(a,b)}}),b(),0===this._preloadCount&&(this._setup(),this._runFrames(),this._draw())):(this._setup(),this._runFrames(),this._draw())}.bind(this),this._preload=function(a,b){var c=this._isGlobal?window:this;c._setProperty("_preloadCount",c._preloadCount+1);var e=function(){c._setProperty("_preloadCount",c._preloadCount-1),0===c._preloadCount&&(c._setup(),c._runFrames(),c._draw())};return b.push(e),d.prototype[a].apply(c,b)}.bind(this),this._setup=function(){var a=this._isGlobal?window:this;"function"==typeof a.preload&&this._preloadMethods.forEach(function(b){a[b]=d.prototype[b]}),"function"==typeof a.setup&&a.setup(),this.canvas.style.visibility="",this.canvas.className=this.canvas.className.replace("p5_hidden",""),this._setupDone=!0,this._loadingScreen.parentNode.removeChild(this._loadingScreen)}.bind(this),this._draw=function(){var a=(new Date).getTime();this._frameRate=1e3/(a-this._lastFrameTime),this._lastFrameTime=a,this._setProperty("frameCount",this.frameCount+1),this._loop&&(this._drawInterval&&clearInterval(this._drawInterval),this._drawInterval=setTimeout(function(){window.requestDraw(this._draw.bind(this))}.bind(this),1e3/this._targetFrameRate)),this.redraw(),this._updatePMouseCoords(),this._updatePTouchCoords()}.bind(this),this._runFrames=function(){this._updateInterval&&clearInterval(this._updateInterval)}.bind(this),this._setProperty=function(a,b){this[a]=b,this._isGlobal&&(window[a]=b)}.bind(this),this.remove=function(){if(this._curElement){this._loop=!1,this._drawInterval&&clearTimeout(this._drawInterval),this._updateInterval&&clearTimeout(this._updateInterval);for(var a in this._events)window.removeEventListener(a,this._events[a]);for(var b=0;b<this._elements.length;b++){var c=this._elements[b];c.elt.parentNode&&c.elt.parentNode.removeChild(c.elt);for(var e in c._events)c.elt.removeEventListener(e,c._events[e])}var f=this;if(this._registeredMethods.remove.forEach(function(a){"undefined"!=typeof a&&a.call(f)}),this._isGlobal){for(var g in d.prototype)try{delete window[g]}catch(h){window[g]=void 0}for(var i in this)if(this.hasOwnProperty(i))try{delete window[i]}catch(h){window[i]=void 0}}}}.bind(this);for(var f in c)d.prototype[f]=c[f];if(a)a(this);else{this._isGlobal=!0;for(var g in d.prototype)if("function"==typeof d.prototype[g]){var h=g.substring(2);this._events.hasOwnProperty(h)||(window[g]=d.prototype[g].bind(this))}else window[g]=d.prototype[g];for(var i in this)this.hasOwnProperty(i)&&(window[i]=this[i])}for(var j in this._events){var k=this["on"+j];if(k){var l=k.bind(this);window.addEventListener(j,l),this._events[j]=l}}var m=this;window.addEventListener("focus",function(){m._setProperty("focused",!0)}),window.addEventListener("blur",function(){m._setProperty("focused",!1)}),e?this._start():"complete"===document.readyState?this._start():window.addEventListener("load",this._start.bind(this),!1)};return d.prototype._preloadMethods=["loadJSON","loadImage","loadStrings","loadXML","loadShape","loadTable"],d.prototype._registeredMethods={pre:[],post:[],remove:[]},d.prototype.registerPreloadMethod=function(a){d.prototype._preloadMethods.push(a)}.bind(this),d.prototype.registerMethod=function(a,b){d.prototype._registeredMethods.hasOwnProperty(a)||(d.prototype._registeredMethods[a]=[]),d.prototype._registeredMethods[a].push(b)}.bind(this),d}({},amdclean.shim,amdclean.constants),amdclean.utilscolor_utils=function(a,b){var c=b;return c.ColorUtils={},c.ColorUtils.hsbaToRGBA=function(a){var b=a[0],c=a[1],d=a[2];b/=255,c/=255,d/=255;var e=[];if(0===c)e=[Math.round(255*d),Math.round(255*d),Math.round(255*d),a[3]];else{var f=6*b;6===f&&(f=0);var g,h,i,j=Math.floor(f),k=d*(1-c),l=d*(1-c*(f-j)),m=d*(1-c*(1-(f-j)));0===j?(g=d,h=m,i=k):1===j?(g=l,h=d,i=k):2===j?(g=k,h=d,i=m):3===j?(g=k,h=l,i=d):4===j?(g=m,h=k,i=d):(g=d,h=k,i=l),e=[Math.round(255*g),Math.round(255*h),Math.round(255*i),a[3]]}return e},c.ColorUtils.rgbaToHSBA=function(a){var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=Math.min(d,e,f),h=Math.max(d,e,f),i=h-g,j=h;if(0===i)b=0,c=0;else{c=i/h;var k=((h-d)/6+i/2)/i,l=((h-e)/6+i/2)/i,m=((h-f)/6+i/2)/i;d===h?b=m-l:e===h?b=1/3+k-m:f===h&&(b=2/3+l-k),0>b&&(b+=1),b>1&&(b-=1)}return[Math.round(255*b),Math.round(255*c),Math.round(255*j),a[3]]},c.ColorUtils}({},amdclean.core),amdclean.p5Color=function(a,b,c,d){var e=b,f=c,d=d;return e.Color=function(a,b){return this.color_array=e.Color._getFormattedColor.apply(a,b),this._normalizeColorArray(a),a._colorMode===d.HSB?(this.hsba=this.color_array,this.rgba=f.hsbaToRGBA(this.hsba)):(this.rgba=this.color_array,this.hsba=f.rgbaToHSBA(this.rgba)),this},e.Color.prototype._normalizeColorArray=function(a){var b=a._colorMode===d.RGB,c=b?a._maxRGB:a._maxHSB,e=this.color_array;return e[0]*=255/c[0],e[1]*=255/c[1],e[2]*=255/c[2],e[3]*=255/c[3],e},e.Color.prototype.getHue=function(){return this.hsba[0]},e.Color.prototype.getSaturation=function(){return this.hsba[1]},e.Color.prototype.getBrightness=function(){return this.hsba[2]},e.Color.prototype.getRed=function(){return this.rgba[0]},e.Color.prototype.getGreen=function(){return this.rgba[1]},e.Color.prototype.getBlue=function(){return this.rgba[2]},e.Color.prototype.getAlpha=function(){return this.rgba[3]},e.Color.prototype.toString=function(){for(var a=this.rgba,b=0;3>b;b++)a[b]=Math.floor(a[b]);var c="undefined"!=typeof a[3]?a[3]/255:1;return"rgba("+a[0]+","+a[1]+","+a[2]+","+c+")"},e.Color._getFormattedColor=function(){var a,b,c,e;return arguments.length>=3?(a=arguments[0],b=arguments[1],c=arguments[2],e="number"==typeof arguments[3]?arguments[3]:255):(this._colorMode===d.RGB?a=b=c=arguments[0]:(a=c=arguments[0],b=0),e="number"==typeof arguments[1]?arguments[1]:255),[a,b,c,e]},e.Color}({},amdclean.core,amdclean.utilscolor_utils,amdclean.constants),amdclean.p5Element=function(a,b){function c(a,b,c){var d=b.bind(c);c.elt.addEventListener(a,d,!1),c._events[a]=d}var d=b;return d.Element=function(a,b){this.elt=a,this._pInst=b,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight},d.Element.prototype.parent=function(a){return"string"==typeof a?a=document.getElementById(a):a instanceof d.Element&&(a=a.elt),a.appendChild(this.elt),this},d.Element.prototype.id=function(a){return this.elt.id=a,this},d.Element.prototype["class"]=function(a){return this.elt.className+=" "+a,this},d.Element.prototype.mousePressed=function(a){return c("mousedown",a,this),c("touchstart",a,this),this},d.Element.prototype.mouseWheel=function(a){return c("mousewheel",a,this),this},d.Element.prototype.mouseReleased=function(a){return c("mouseup",a,this),c("touchend",a,this),this},d.Element.prototype.mouseClicked=function(a){return c("click",a,this),this},d.Element.prototype.mouseMoved=function(a){return c("mousemove",a,this),c("touchmove",a,this),this},d.Element.prototype.mouseOver=function(a){return c("mouseover",a,this),this},d.Element.prototype.mouseOut=function(a){return c("mouseout",a,this),this},d.Element.prototype.touchStarted=function(a){return c("touchstart",a,this),c("mousedown",a,this),this},d.Element.prototype.touchMoved=function(a){return c("touchmove",a,this),c("mousemove",a,this),this},d.Element.prototype.touchEnded=function(a){return c("touchend",a,this),c("mouseup",a,this),this},d.Element.prototype.dragOver=function(a){return c("dragover",a,this),this},d.Element.prototype.dragLeave=function(a){return c("dragleave",a,this),this},d.Element.prototype.drop=function(a,b){function e(b){var c=new d.File(b);return function(b){c.data=b.target.result,a(c)}}return window.File&&window.FileReader&&window.FileList&&window.Blob?(c("dragover",function(a){a.stopPropagation(),a.preventDefault()},this),c("dragleave",function(a){a.stopPropagation(),a.preventDefault()},this),arguments.length>1&&c("drop",b,this),c("drop",function(a){a.stopPropagation(),a.preventDefault();for(var b=a.dataTransfer.files,c=0;c<b.length;c++){var d=b[c],f=new FileReader;f.onload=e(d),"text"===d.type?f.readAsText(d):f.readAsDataURL(d)}},this)):console.log("The File APIs are not fully supported in this browser."),this},d.Element.prototype._setProperty=function(a,b){this[a]=b},d.Element}({},amdclean.core),amdclean.p5Graphics=function(a,b,c){var d=b,c=c;return d.Graphics=function(a,b,c){d.Element.call(this,a,b),this.canvas=a,this.drawingContext=this.canvas.getContext("2d"),this._pInst=b,c?(this._isMainCanvas=!0,this._pInst._setProperty("_curElement",this),this._pInst._setProperty("canvas",this.canvas),this._pInst._setProperty("drawingContext",this.drawingContext),this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)):(this.canvas.style.display="none",this._styles=[])},d.Graphics.prototype=Object.create(d.Element.prototype),d.Graphics.prototype._applyDefaults=function(){this.drawingContext.fillStyle="#FFFFFF",this.drawingContext.strokeStyle="#000000",this.drawingContext.lineCap=c.ROUND,this.drawingContext.font="normal 12px sans-serif"},d.Graphics.prototype.resize=function(a,b){this.width=a,this.height=b,this.elt.width=a*this._pInst._pixelDensity,this.elt.height=b*this._pInst._pixelDensity,this.elt.style.width=a+"px",this.elt.style.height=b+"px",this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)},d.Graphics}({},amdclean.core,amdclean.constants),amdclean.filters=function(){"use strict";function a(a){var b=3.5*a|0;if(b=1>b?1:248>b?b:248,d!==b){d=b,e=1+d<<1,f=new Int32Array(e),g=new Array(e);for(var c=0;e>c;c++)g[c]=new Int32Array(256);for(var h,i,j,k,l=1,m=b-1;b>l;l++){f[b+l]=f[m]=i=m*m,j=g[b+l],k=g[m--];for(var n=0;256>n;n++)j[n]=k[n]=i*n}h=f[b]=b*b,j=g[b];for(var o=0;256>o;o++)j[o]=h*o}}function b(b,h){for(var i=c._toPixels(b),j=b.width,k=b.height,l=j*k,m=new Int32Array(l),n=0;l>n;n++)m[n]=c._getARGB(i,n);var o,p,q,r,s,t,u,v,w,x,y=new Int32Array(l),z=new Int32Array(l),A=new Int32Array(l),B=new Int32Array(l),C=0;a(h);var D,E,F,G;for(E=0;k>E;E++){for(D=0;j>D;D++){if(r=q=p=s=o=0,t=D-d,0>t)x=-t,t=0;else{if(t>=j)break;x=0}for(F=x;e>F&&!(t>=j);F++){var H=m[t+C];G=g[F],s+=G[(-16777216&H)>>>24],p+=G[(16711680&H)>>16],q+=G[(65280&H)>>8],r+=G[255&H],o+=f[F],t++}u=C+D,y[u]=s/o,z[u]=p/o,A[u]=q/o,B[u]=r/o}C+=j}for(C=0,v=-d,w=v*j,E=0;k>E;E++){for(D=0;j>D;D++){if(r=q=p=s=o=0,0>v)x=u=-v,t=D;else{if(v>=k)break;x=0,u=v,t=D+w}for(F=x;e>F&&!(u>=k);F++)G=g[F],s+=G[y[t]],p+=G[z[t]],q+=G[A[t]],r+=G[B[t]],o+=f[F],u++,t+=j;m[D+C]=s/o<<24|p/o<<16|q/o<<8|r/o}C+=j,w+=j,v++}c._setPixels(i,m)}var c={};c._toPixels=function(a){return a instanceof ImageData?a.data:a.getContext("2d").getImageData(0,0,a.width,a.height).data},c._getARGB=function(a,b){var c=4*b;return a[c+3]<<24&4278190080|a[c]<<16&16711680|a[c+1]<<8&65280|255&a[c+2]},c._setPixels=function(a,b){for(var c=0,d=0,e=a.length;e>d;d++)c=4*d,a[c+0]=(16711680&b[d])>>>16,a[c+1]=(65280&b[d])>>>8,a[c+2]=255&b[d],a[c+3]=(4278190080&b[d])>>>24},c._toImageData=function(a){return a instanceof ImageData?a:a.getContext("2d").getImageData(0,0,a.width,a.height)},c._createImageData=function(a,b){return c._tmpCanvas=document.createElement("canvas"),c._tmpCtx=c._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(a,b)},c.apply=function(a,b,c){var d=a.getContext("2d"),e=d.getImageData(0,0,a.width,a.height),f=b(e,c);f instanceof ImageData?d.putImageData(f,0,0,0,0,a.width,a.height):d.putImageData(e,0,0,0,0,a.width,a.height)},c.threshold=function(a,b){var d=c._toPixels(a);void 0===b&&(b=.5);for(var e=Math.floor(255*b),f=0;f<d.length;f+=4){var g,h=d[f],i=d[f+1],j=d[f+2],k=.2126*h+.7152*i+.0722*j;g=k>=e?255:0,d[f]=d[f+1]=d[f+2]=g}},c.gray=function(a){for(var b=c._toPixels(a),d=0;d<b.length;d+=4){var e=b[d],f=b[d+1],g=b[d+2],h=.2126*e+.7152*f+.0722*g;b[d]=b[d+1]=b[d+2]=h}},c.opaque=function(a){for(var b=c._toPixels(a),d=0;d<b.length;d+=4)b[d+3]=255;return b},c.invert=function(a){for(var b=c._toPixels(a),d=0;d<b.length;d+=4)b[d]=255-b[d],b[d+1]=255-b[d+1],b[d+2]=255-b[d+2]},c.posterize=function(a,b){var d=c._toPixels(a);if(2>b||b>255)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var e=b-1,f=0;f<d.length;f+=4){var g=d[f],h=d[f+1],i=d[f+2];d[f]=255*(g*b>>8)/e,d[f+1]=255*(h*b>>8)/e,d[f+2]=255*(i*b>>8)/e}},c.dilate=function(a){for(var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=c._toPixels(a),u=0,v=t.length?t.length/4:0,w=new Int32Array(v);v>u;)for(b=u,d=u+a.width;d>u;)e=f=c._getARGB(t,u),i=u-1,h=u+1,j=u-a.width,k=u+a.width,b>i&&(i=u),h>=d&&(h=u),0>j&&(j=0),k>=v&&(k=u),n=c._getARGB(t,j),m=c._getARGB(t,i),o=c._getARGB(t,k),l=c._getARGB(t,h),g=77*(e>>16&255)+151*(e>>8&255)+28*(255&e),q=77*(m>>16&255)+151*(m>>8&255)+28*(255&m),p=77*(l>>16&255)+151*(l>>8&255)+28*(255&l),r=77*(n>>16&255)+151*(n>>8&255)+28*(255&n),s=77*(o>>16&255)+151*(o>>8&255)+28*(255&o),q>g&&(f=m,g=q),p>g&&(f=l,g=p),r>g&&(f=n,g=r),s>g&&(f=o,g=s),w[u++]=f;c._setPixels(t,w)},c.erode=function(a){for(var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=c._toPixels(a),u=0,v=t.length?t.length/4:0,w=new Int32Array(v);v>u;)for(b=u,d=u+a.width;d>u;)e=f=c._getARGB(t,u),i=u-1,h=u+1,j=u-a.width,k=u+a.width,b>i&&(i=u),h>=d&&(h=u),0>j&&(j=0),k>=v&&(k=u),n=c._getARGB(t,j),m=c._getARGB(t,i),o=c._getARGB(t,k),l=c._getARGB(t,h),g=77*(e>>16&255)+151*(e>>8&255)+28*(255&e),q=77*(m>>16&255)+151*(m>>8&255)+28*(255&m),p=77*(l>>16&255)+151*(l>>8&255)+28*(255&l),r=77*(n>>16&255)+151*(n>>8&255)+28*(255&n),s=77*(o>>16&255)+151*(o>>8&255)+28*(255&o),g>q&&(f=m,g=q),g>p&&(f=l,g=p),g>r&&(f=n,g=r),g>s&&(f=o,g=s),w[u++]=f;c._setPixels(t,w)};var d,e,f,g;return c.blur=function(a,c){b(a,c)},c}({}),amdclean.p5Image=function(a,b,c){"use strict";var d=b,e=c;return d.Image=function(a,b){this.width=a,this.height=b,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),this.pixels=[]},d.Image.prototype._setProperty=function(a,b){this[a]=b},d.Image.prototype.loadPixels=function(){d.prototype.loadPixels.call(this)},d.Image.prototype.updatePixels=function(a,b,c,e){d.prototype.updatePixels.call(this,a,b,c,e)},d.Image.prototype.get=function(a,b,c,e){return d.prototype.get.call(this,a,b,c,e)},d.Image.prototype.set=function(a,b,c){d.prototype.set.call(this,a,b,c)},d.Image.prototype.resize=function(a,b){a=a||this.canvas.width,b=b||this.canvas.height;var c=document.createElement("canvas");c.width=a,c.height=b,c.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,c.width,c.height),this.canvas.width=this.width=a,this.canvas.height=this.height=b,this.drawingContext.drawImage(c,0,0,a,b,0,0,a,b),this.pixels.length>0&&this.loadPixels()},d.Image.prototype.copy=function(){d.prototype.copy.apply(this,arguments)},d.Image.prototype.mask=function(a){void 0===a&&(a=this);var b=this.drawingContext.globalCompositeOperation,c=1;a instanceof d.Graphics&&(c=a._pInst._pixelDensity);var e=[a,0,0,c*a.width,c*a.height,0,0,this.width,this.height];this.drawingContext.globalCompositeOperation="destination-in",this.copy.apply(this,e),this.drawingContext.globalCompositeOperation=b},d.Image.prototype.filter=function(a,b){e.apply(this.canvas,e[a.toLowerCase()],b)},d.Image.prototype.blend=function(){d.prototype.blend.apply(this,arguments)},d.Image.prototype.save=function(a,b){var c;if(b)switch(b.toLowerCase()){case"png":c="image/png";break;case"jpeg":c="image/jpeg";break;case"jpg":c="image/jpeg";break;default:c="image/png"}else b="png",c="image/png";var e="image/octet-stream",f=this.canvas.toDataURL(c);f=f.replace(c,e),d.prototype.downloadFile(f,a,b)},d.Image}({},amdclean.core,amdclean.filters),amdclean.p5File=function(a,b){var c=b;return c.File=function(a,b){this.file=a,this._pInst=b;var c=a.type.split("/");this.type=c[0],this.subtype=c[1],this.name=a.name,this.size=a.size,this.data=void 0},c.File}({},amdclean.core),amdclean.polargeometry=function(){return{degreesToRadians:function(a){return 2*Math.PI*a/360},radiansToDegrees:function(a){return 360*a/(2*Math.PI)}}}({}),amdclean.p5Vector=function(a,b,c,d){"use strict";var e=b,f=c,d=d;return e.Vector=function(){var a,b,c;arguments[0]instanceof e?(this.p5=arguments[0],a=arguments[1][0]||0,b=arguments[1][1]||0,c=arguments[1][2]||0):(a=arguments[0]||0,b=arguments[1]||0,c=arguments[2]||0),this.x=a,this.y=b,this.z=c},e.Vector.prototype.set=function(a,b,c){return a instanceof e.Vector?(this.x=a.x||0,this.y=a.y||0,this.z=a.z||0,this):a instanceof Array?(this.x=a[0]||0,this.y=a[1]||0,this.z=a[2]||0,this):(this.x=a||0,this.y=b||0,this.z=c||0,this)},e.Vector.prototype.copy=function(){return this.p5?new e.Vector(this.p5,[this.x,this.y,this.z]):new e.Vector(this.x,this.y,this.z)},e.Vector.prototype.add=function(a,b,c){return a instanceof e.Vector?(this.x+=a.x||0,this.y+=a.y||0,this.z+=a.z||0,this):a instanceof Array?(this.x+=a[0]||0,this.y+=a[1]||0,this.z+=a[2]||0,this):(this.x+=a||0,this.y+=b||0,this.z+=c||0,this)},e.Vector.prototype.sub=function(a,b,c){return a instanceof e.Vector?(this.x-=a.x||0,this.y-=a.y||0,this.z-=a.z||0,this):a instanceof Array?(this.x-=a[0]||0,this.y-=a[1]||0,this.z-=a[2]||0,this):(this.x-=a||0,this.y-=b||0,this.z-=c||0,this)},e.Vector.prototype.mult=function(a){return this.x*=a||0,this.y*=a||0,this.z*=a||0,this},e.Vector.prototype.div=function(a){return this.x/=a,this.y/=a,this.z/=a,this},e.Vector.prototype.mag=function(){return Math.sqrt(this.magSq())},e.Vector.prototype.magSq=function(){var a=this.x,b=this.y,c=this.z;return a*a+b*b+c*c},e.Vector.prototype.dot=function(a,b,c){return a instanceof e.Vector?this.dot(a.x,a.y,a.z):this.x*(a||0)+this.y*(b||0)+this.z*(c||0)},e.Vector.prototype.cross=function(a){var b=this.y*a.z-this.z*a.y,c=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x;return this.p5?new e.Vector(this.p5,[b,c,d]):new e.Vector(b,c,d)},e.Vector.prototype.dist=function(a){var b=a.copy().sub(this);return b.mag()},e.Vector.prototype.normalize=function(){return this.div(this.mag())},e.Vector.prototype.limit=function(a){var b=this.magSq();return b>a*a&&(this.div(Math.sqrt(b)),this.mult(a)),this},e.Vector.prototype.setMag=function(a){return this.normalize().mult(a)},e.Vector.prototype.heading=function(){var a=Math.atan2(this.y,this.x);return this.p5?this.p5._angleMode===d.RADIANS?a:f.radiansToDegrees(a):a},e.Vector.prototype.rotate=function(a){this.p5&&this.p5._angleMode===d.DEGREES&&(a=f.degreesToRadians(a));var b=this.heading()+a,c=this.mag();return this.x=Math.cos(b)*c,this.y=Math.sin(b)*c,this},e.Vector.prototype.lerp=function(a,b,c,d){return a instanceof e.Vector?this.lerp(a.x,a.y,a.z,b):(this.x+=(a-this.x)*d||0,this.y+=(b-this.y)*d||0,this.z+=(c-this.z)*d||0,this)},e.Vector.prototype.array=function(){return[this.x||0,this.y||0,this.z||0]},e.Vector.fromAngle=function(a){return this.p5&&this.p5._angleMode===d.DEGREES&&(a=f.degreesToRadians(a)),this.p5?new e.Vector(this.p5,[Math.cos(a),Math.sin(a),0]):new e.Vector(Math.cos(a),Math.sin(a),0)},e.Vector.random2D=function(){var a;return a=this.p5?this.p5.random(this.p5._angleMode===d.DEGREES?360:d.TWO_PI):Math.random()*Math.PI*2,this.fromAngle(a)},e.Vector.random3D=function(){var a,b;this.p5?(a=this.p5.random(0,d.TWO_PI),b=this.p5.random(-1,1)):(a=Math.random()*Math.PI*2,b=2*Math.random()-1);var c=Math.sqrt(1-b*b)*Math.cos(a),f=Math.sqrt(1-b*b)*Math.sin(a);return this.p5?new e.Vector(this.p5,[c,f,b]):new e.Vector(c,f,b)},e.Vector.add=function(a,b,c){return c?c.set(a):c=a.copy(),c.add(b),c},e.Vector.sub=function(a,b,c){return c?c.set(a):c=a.copy(),c.sub(b),c},e.Vector.mult=function(a,b,c){return c?c.set(a):c=a.copy(),c.mult(b),c},e.Vector.div=function(a,b,c){return c?c.set(a):c=a.copy(),c.div(b),c},e.Vector.dot=function(a,b){return a.dot(b)},e.Vector.cross=function(a,b){return a.cross(b)},e.Vector.dist=function(a,b){return a.dist(b)},e.Vector.lerp=function(a,b,c,d){return d?d.set(a):d=a.copy(),d.lerp(b,c),d},e.Vector.angleBetween=function(a,b){var c=Math.acos(a.dot(b)/(a.mag()*b.mag()));return this.p5&&this.p5._angleMode===d.DEGREES&&(c=f.radiansToDegrees(c)),c},e.Vector}({},amdclean.core,amdclean.polargeometry,amdclean.constants),amdclean.p5TableRow=function(a,b){"use strict";var c=b;return c.TableRow=function(a,b){var c=[],d={};a&&(b=b||",",c=a.split(b));for(var e=0;e<c.length;e++){var f=e,g=c[e];d[f]=g}this.arr=c,this.obj=d,this.table=null},c.TableRow.prototype.set=function(a,b){if("string"==typeof a){var c=this.table.columns.indexOf(a);if(!(c>=0))throw'This table has no column named "'+a+'"';this.obj[a]=b,this.arr[c]=b}else{if(!(a<this.table.columns.length))throw"Column #"+a+" is out of the range of this table";this.arr[a]=b;var d=this.table.columns[a];this.obj[d]=b}},c.TableRow.prototype.setNum=function(a,b){var c=parseFloat(b,10);this.set(a,c)},c.TableRow.prototype.setString=function(a,b){var c=b.toString();this.set(a,c)},c.TableRow.prototype.get=function(a){return"string"==typeof a?this.obj[a]:this.arr[a]},c.TableRow.prototype.getNum=function(a){var b;if(b="string"==typeof a?parseFloat(this.obj[a],10):parseFloat(this.arr[a],10),"NaN"===b.toString())throw"Error: "+this.obj[a]+" is NaN (Not a Number)";return b},c.TableRow.prototype.getString=function(a){return"string"==typeof a?this.obj[a].toString():this.arr[a].toString()},c.TableRow}({},amdclean.core),amdclean.p5Table=function(a,b){"use strict";var c=b;return c.Table=function(){this.columns=[],this.rows=[]},c.Table.prototype.addRow=function(a){var b=a||new c.TableRow;if("undefined"==typeof b.arr||"undefined"==typeof b.obj)throw"invalid TableRow: "+b;return b.table=this,this.rows.push(b),b},c.Table.prototype.removeRow=function(a){this.rows[a].table=null;var b=this.rows.splice(a+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(b)},c.Table.prototype.getRow=function(a){return this.rows[a]},c.Table.prototype.getRows=function(){return this.rows},c.Table.prototype.findRow=function(a,b){if("string"==typeof b){for(var c=0;c<this.rows.length;c++)if(this.rows[c].obj[b]===a)return this.rows[c]}else for(var d=0;d<this.rows.length;d++)if(this.rows[d].arr[b]===a)return this.rows[d];return null},c.Table.prototype.findRows=function(a,b){var c=[];if("string"==typeof b)for(var d=0;d<this.rows.length;d++)this.rows[d].obj[b]===a&&c.push(this.rows[d]);else for(var e=0;e<this.rows.length;e++)this.rows[e].arr[b]===a&&c.push(this.rows[e]);return c},c.Table.prototype.matchRow=function(a,b){if("number"==typeof b){for(var c=0;c<this.rows.length;c++)if(this.rows[c].arr[b].match(a))return this.rows[c]}else for(var d=0;d<this.rows.length;d++)if(this.rows[d].obj[b].match(a))return this.rows[d];return null},c.Table.prototype.matchRows=function(a,b){var c=[];if("number"==typeof b)for(var d=0;d<this.rows.length;d++)this.rows[d].arr[b].match(a)&&c.push(this.rows[d]);else for(var e=0;e<this.rows.length;e++)this.rows[e].obj[b].match(a)&&c.push(this.rows[e]);return c},c.Table.prototype.getColumn=function(a){var b=[];if("string"==typeof a)for(var c=0;c<this.rows.length;c++)b.push(this.rows[c].obj[a]);else for(var d=0;d<this.rows.length;d++)b.push(this.rows[d].arr[a]);return b},c.Table.prototype.clearRows=function(){delete this.rows,this.rows=[]},c.Table.prototype.addColumn=function(a){var b=a||null;this.columns.push(b)},c.Table.prototype.getColumnCount=function(){return this.columns.length},c.Table.prototype.getRowCount=function(){return this.rows.length},c.Table.prototype.removeTokens=function(a,b){for(var c=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},d=[],e=0;e<a.length;e++)d.push(c(a.charAt(e)));var f=new RegExp(d.join("|"),"g");if("undefined"==typeof b)for(var g=0;g<this.columns.length;g++)for(var h=0;h<this.rows.length;h++){var i=this.rows[h].arr[g];i=i.replace(f,""),this.rows[h].arr[g]=i,this.rows[h].obj[this.columns[g]]=i}else if("string"==typeof b)for(var j=0;j<this.rows.length;j++){var k=this.rows[j].obj[b];k=k.replace(f,""),this.rows[j].obj[b]=k;var l=this.columns.indexOf(b);this.rows[j].arr[l]=k}else for(var m=0;m<this.rows.length;m++){var n=this.rows[m].arr[b];n=n.replace(f,""),this.rows[m].arr[b]=n,this.rows[m].obj[this.columns[b]]=n}},c.Table.prototype.trim=function(a){var b=new RegExp(" ","g");if("undefined"==typeof a)for(var c=0;c<this.columns.length;c++)for(var d=0;d<this.rows.length;d++){var e=this.rows[d].arr[c];e=e.replace(b,""),this.rows[d].arr[c]=e,this.rows[d].obj[this.columns[c]]=e}else if("string"==typeof a)for(var f=0;f<this.rows.length;f++){var g=this.rows[f].obj[a];g=g.replace(b,""),this.rows[f].obj[a]=g;var h=this.columns.indexOf(a);this.rows[f].arr[h]=g}else for(var i=0;i<this.rows.length;i++){var j=this.rows[i].arr[a];j=j.replace(b,""),this.rows[i].arr[a]=j,this.rows[i].obj[this.columns[a]]=j}},c.Table.prototype.removeColumn=function(a){var b,c;"string"==typeof a?(b=a,c=this.columns.indexOf(a),console.log("string")):(c=a,b=this.columns[a]);var d=this.columns.splice(c+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(d);for(var e=0;e<this.rows.length;e++){var f=this.rows[e].arr,g=f.splice(c+1,f.length);f.pop(),this.rows[e].arr=f.concat(g),delete this.rows[e].obj[b]}},c.Table.prototype.set=function(a,b,c){this.rows[a].set(b,c)},c.Table.prototype.setNum=function(a,b,c){this.rows[a].set(b,c)},c.Table.prototype.setString=function(a,b,c){this.rows[a].set(b,c)},c.Table.prototype.get=function(a,b){return this.rows[a].get(b)},c.Table.prototype.getNum=function(a,b){return this.rows[a].getNum(b)},c.Table.prototype.getString=function(a,b){return this.rows[a].getString(b)},c.Table}({},amdclean.core),amdclean.colorcreating_reading=function(a,b){"use strict";var c=b;return c.prototype.alpha=function(a){if(a instanceof c.Color||a instanceof Array)return this.color(a).getAlpha();throw new Error("Needs p5.Color or pixel array as argument.")},c.prototype.blue=function(a){if(a instanceof c.Color||a instanceof Array)return this.color(a).getBlue();throw new Error("Needs p5.Color or pixel array as argument.")},c.prototype.brightness=function(a){if(!a instanceof c.Color)throw new Error("Needs p5.Color as argument.");return a.getBrightness()},c.prototype.color=function(){if(arguments[0]instanceof c.Color)return arguments[0];if(arguments[0]instanceof Array)return new c.Color(this,arguments[0]);var a=Array.prototype.slice.call(arguments);return new c.Color(this,a)},c.prototype.green=function(a){if(a instanceof c.Color||a instanceof Array)return this.color(a).getGreen();throw new Error("Needs p5.Color or pixel array as argument.")},c.prototype.hue=function(a){if(!a instanceof c.Color)throw new Error("Needs p5.Color as argument.");return a.getHue()},c.prototype.lerpColor=function(a,b,d){if(a instanceof Array){for(var e=[],f=0;f<a.length;f++)e.push(c.prototype.lerp(a[f],b[f],d));return e}if(a instanceof c.Color){for(var g=[],h=0;4>h;h++)g.push(c.prototype.lerp(a.rgba[h],b.rgba[h],d));return new c.Color(this,g)}return c.prototype.lerp(a,b,d)},c.prototype.red=function(a){if(a instanceof c.Color||a instanceof Array)return this.color(a).getRed();throw new Error("Needs p5.Color or pixel array as argument.")},c.prototype.saturation=function(a){if(!a instanceof c.Color)throw new Error("Needs p5.Color as argument.");return a.getSaturation()},c}({},amdclean.core,amdclean.p5Color),amdclean.colorsetting=function(a,b,c){"use strict";var d=b,c=c;return d.prototype._doStroke=!0,d.prototype._doFill=!0,d.prototype._colorMode=c.RGB,d.prototype._maxRGB=[255,255,255,255],d.prototype._maxHSB=[255,255,255,255],d.prototype.background=function(){if(this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),arguments[0]instanceof d.Image)this.image(arguments[0],0,0,this.width,this.height);else{var a=this.drawingContext.fillStyle,b=this.color.apply(this,arguments),c=b.toString();this.drawingContext.fillStyle=c,this.drawingContext.fillRect(0,0,this.width,this.height),this.drawingContext.fillStyle=a}this.drawingContext.restore()},d.prototype.clear=function(){this.drawingContext.clearRect(0,0,this.width,this.height)},d.prototype.colorMode=function(){if(arguments[0]===c.RGB||arguments[0]===c.HSB){this._colorMode=arguments[0];var a=this._colorMode===c.RGB,b=a?this._maxRGB:this._maxHSB;2===arguments.length?(b[0]=arguments[1],b[1]=arguments[1],b[2]=arguments[1],b[3]=arguments[1]):arguments.length>2&&(b[0]=arguments[1],b[1]=arguments[2],b[2]=arguments[3]),5===arguments.length&&(b[3]=arguments[4])}},d.prototype.fill=function(){this._setProperty("_doFill",!0);var a=this.drawingContext,b=this.color.apply(this,arguments);a.fillStyle=b.toString()},d.prototype.noFill=function(){this._setProperty("_doFill",!1)},d.prototype.noStroke=function(){this._setProperty("_doStroke",!1)},d.prototype.stroke=function(){this._setProperty("_doStroke",!0);var a=this.drawingContext,b=this.color.apply(this,arguments);a.strokeStyle=b.toString()},d}({},amdclean.core,amdclean.constants,amdclean.p5Color),amdclean.dataconversion=function(a,b){"use strict";var c=b;return c.prototype["float"]=function(a){return parseFloat(a)},c.prototype["int"]=function(a,b){return"string"==typeof a?(b=b||10,parseInt(a,b)):"number"==typeof a?0|a:"boolean"==typeof a?a?1:0:a instanceof Array?a.map(c.prototype["int"]):void 0;

},c}({},amdclean.core),amdclean.dataarray_functions=function(a,b){"use strict";var c=b;return c.prototype.append=function(a,b){return a.push(b),a},c.prototype.arrayCopy=function(a,b,c,d,e){var f,g;"undefined"!=typeof e?(g=Math.min(e,a.length),f=d,a=a.slice(b,g+b)):("undefined"!=typeof c?(g=c,g=Math.min(g,a.length)):g=a.length,f=0,c=b,a=a.slice(0,g)),Array.prototype.splice.apply(c,[f,g].concat(a))},c.prototype.concat=function(a,b){return a.concat(b)},c.prototype.reverse=function(a){return a.reverse()},c.prototype.shorten=function(a){return a.pop(),a},c.prototype.sort=function(a,b){var c=b?a.slice(0,Math.min(b,a.length)):a,d=b?a.slice(Math.min(b,a.length)):[];return c="string"==typeof c[0]?c.sort():c.sort(function(a,b){return a-b}),c.concat(d)},c.prototype.splice=function(a,b,c){return Array.prototype.splice.apply(a,[c,0].concat(b)),a},c.prototype.subset=function(a,b,c){return"undefined"!=typeof c?a.slice(b,b+c):a.slice(b,a.length)},c}({},amdclean.core),amdclean.datastring_functions=function(a,b){"use strict";function c(){var a=arguments[0],b=0>a,c=b?a.toString().substring(1):a.toString(),d=c.indexOf("."),e=-1!==d?c.substring(0,d):c,f=-1!==d?c.substring(d+1):"",g=b?"-":"";if(3===arguments.length){for(var h=0;h<arguments[1]-e.length;h++)g+="0";g+=e,g+=".",g+=f;for(var i=0;i<arguments[2]-f.length;i++)g+="0";return g}for(var j=0;j<Math.max(arguments[1]-e.length,0);j++)g+="0";return g+=c}function d(){var a=arguments[0].toString(),b=a.indexOf("."),c=-1!==b?a.substring(b):"",d=-1!==b?a.substring(0,b):a;return d=d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),0===arguments[1]&&(c=""),arguments.length>1&&(c=c.substring(0,arguments[1]+1)),d+c}function e(){return parseFloat(arguments[0])>0?"+"+arguments[0].toString():arguments[0].toString()}function f(){return parseFloat(arguments[0])>0?" "+arguments[0].toString():arguments[0].toString()}var g=b;return g.prototype.join=function(a,b){return a.join(b)},g.prototype.match=function(a,b){return a.match(b)},g.prototype.matchAll=function(a,b){for(var c=new RegExp(b,"g"),d=c.exec(a),e=[];null!==d;)e.push(d),d=c.exec(a);return e},g.prototype.nf=function(){if(arguments[0]instanceof Array){var a=arguments[1],b=arguments[2];return arguments[0].map(function(d){return c(d,a,b)})}return c.apply(this,arguments)},g.prototype.nfc=function(){if(arguments[0]instanceof Array){var a=arguments[1];return arguments[0].map(function(b){return d(b,a)})}return d.apply(this,arguments)},g.prototype.nfp=function(){var a=this.nf(arguments);return a instanceof Array?a.map(e):e(a)},g.prototype.nfs=function(){var a=this.nf(arguments);return a instanceof Array?a.map(f):f(a)},g.prototype.split=function(a,b){return a.split(b)},g.prototype.splitTokens=function(){var a=arguments.length>0?arguments[1]:/\s/g;return arguments[0].split(a).filter(function(a){return a})},g.prototype.trim=function(a){return a instanceof Array?a.map(this.trim):a.trim()},g}({},amdclean.core),amdclean.environment=function(a,b,c){"use strict";function d(a){var b=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled;if(!b)throw new Error("Fullscreen not enabled in this browser.");a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function e(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}var f=b,g=c,h=[g.ARROW,g.CROSS,g.HAND,g.MOVE,g.TEXT,g.WAIT];return f.prototype._frameRate=0,f.prototype._lastFrameTime=(new Date).getTime(),f.prototype._targetFrameRate=60,f.prototype.frameCount=0,f.prototype.focused=!0,f.prototype.cursor=function(a,b,c){var d="auto",e=this._curElement.elt;if(h.indexOf(a)>-1)d=a;else if("string"==typeof a){var f="";b&&c&&"number"==typeof b&&"number"==typeof c&&(f=b+" "+c),d="http://"!==a.substring(0,6)?"url("+a+") "+f+", auto":/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(a)?"url("+a+") "+f+", auto":a}e.style.cursor=d},f.prototype.frameRate=function(a){return"undefined"==typeof a?this._frameRate:(this._setProperty("_targetFrameRate",a),this._runFrames(),this)},f.prototype.getFrameRate=function(){return this.frameRate()},f.prototype.setFrameRate=function(a){return this.frameRate(a)},f.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},f.prototype.displayWidth=screen.width,f.prototype.displayHeight=screen.height,f.prototype.windowWidth=window.innerWidth,f.prototype.windowHeight=window.innerHeight,f.prototype.onresize=function(a){this._setProperty("windowWidth",window.innerWidth),this._setProperty("windowHeight",window.innerHeight);var b,c=this._isGlobal?window:this;"function"==typeof c.windowResized&&(b=c.windowResized(a),void 0===b||b||a.preventDefault())},f.prototype.width=0,f.prototype.height=0,f.prototype.fullscreen=function(a){return"undefined"==typeof a?document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement:void(a?d(document.documentElement):e())},f.prototype.devicePixelScaling=function(a){this._pixelDensity=a?window.devicePixelRatio||1:1,this.resizeCanvas(this.width,this.height,!0)},f.prototype.getURL=function(){return location.href},f.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(a){return""!==a})},f.prototype.getURLParams=function(){for(var a,b=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,c={};null!=(a=b.exec(location.search));)a.index===b.lastIndex&&b.lastIndex++,c[a[1]]=a[2];return c},f}({},amdclean.core,amdclean.constants),amdclean.imageimage=function(a,b,c){"use strict";var d=b,c=c;return d.prototype._imageMode=c.CORNER,d.prototype._tint=null,d.prototype.createImage=function(a,b){return new d.Image(a,b)},d}({},amdclean.core,amdclean.constants),amdclean.canvas=function(a,b){var b=b;return{modeAdjust:function(a,c,d,e,f){return f===b.CORNER?{x:a,y:c,w:d,h:e}:f===b.CORNERS?{x:a,y:c,w:d-a,h:e-c}:f===b.RADIUS?{x:a-d,y:c-e,w:2*d,h:2*e}:f===b.CENTER?{x:a-.5*d,y:c-.5*e,w:d,h:e}:void 0},arcModeAdjust:function(a,c,d,e,f){return f===b.CORNER?{x:a+.5*d,y:c+.5*e,w:d,h:e}:f===b.CORNERS?{x:a,y:c,w:d+a,h:e+c}:f===b.RADIUS?{x:a,y:c,w:2*d,h:2*e}:f===b.CENTER?{x:a,y:c,w:d,h:e}:void 0}}}({},amdclean.constants),amdclean.imageloading_displaying=function(a,b,c,d,e){"use strict";var f=b,g=c,d=d,e=e;return f.prototype.loadImage=function(a,b,c){var d=new Image,e=new f.Image(1,1,this);return d.onload=function(){e.width=e.canvas.width=d.width,e.height=e.canvas.height=d.height,e.canvas.getContext("2d").drawImage(d,0,0),"function"==typeof b&&b(e)},d.onerror=function(a){"function"==typeof c&&c(a)},0!==a.indexOf("data:image/")&&(d.crossOrigin="Anonymous"),d.src=a,e},f.prototype.image=function(a,b,c,e,f){var g=a.canvas||a.elt;b=b||0,c=c||0,e=e||a.width,f=f||a.height;var h=d.modeAdjust(b,c,e,f,this._imageMode);try{this._tint&&a.canvas?this.drawingContext.drawImage(this._getTintedImageCanvas(a),h.x,h.y,h.w,h.h):this.drawingContext.drawImage(g,h.x,h.y,h.w,h.h)}catch(i){if("NS_ERROR_NOT_AVAILABLE"!==i.name)throw i}},f.prototype.tint=function(){var a=this.color.apply(this,arguments);this._tint=a.rgba},f.prototype.noTint=function(){this._tint=null},f.prototype._getTintedImageCanvas=function(a){if(!a.canvas)return a;var b=g._toPixels(a.canvas),c=document.createElement("canvas");c.width=a.canvas.width,c.height=a.canvas.height;for(var d=c.getContext("2d"),e=d.createImageData(a.canvas.width,a.canvas.height),f=e.data,h=0;h<b.length;h+=4){var i=b[h],j=b[h+1],k=b[h+2],l=b[h+3];f[h]=i*this._tint[0]/255,f[h+1]=j*this._tint[1]/255,f[h+2]=k*this._tint[2]/255,f[h+3]=l*this._tint[3]/255}return d.putImageData(e,0,0),c},f.prototype.imageMode=function(a){(a===e.CORNER||a===e.CORNERS||a===e.CENTER)&&(this._imageMode=a)},f}({},amdclean.core,amdclean.filters,amdclean.canvas,amdclean.constants),amdclean.imagepixels=function(a,b,c){"use strict";var d=b,e=c;return d.prototype.pixels=[],d.prototype.blend=function(){var a=this.drawingContext.globalCompositeOperation,b=arguments[arguments.length-1],c=Array.prototype.slice.call(arguments,0,arguments.length-1);this.drawingContext.globalCompositeOperation=b,this.copy.apply(this,c),this.drawingContext.globalCompositeOperation=a},d.prototype.copy=function(){var a,b,c,d,e,f,g,h,i;if(9===arguments.length)a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=arguments[5],g=arguments[6],h=arguments[7],i=arguments[8];else{if(8!==arguments.length)throw new Error("Signature not supported");b=arguments[0],c=arguments[1],d=arguments[2],e=arguments[3],f=arguments[4],g=arguments[5],h=arguments[6],i=arguments[7],a=this}var j=a.canvas.width/a.width;this.drawingContext.drawImage(a.canvas,j*b,j*c,j*d,j*e,f,g,h,i)},d.prototype.filter=function(a,b){e.apply(this.canvas,e[a.toLowerCase()],b)},d.prototype.get=function(a,b,c,e){if(void 0===a&&void 0===b&&void 0===c&&void 0===e?(a=0,b=0,c=this.width,e=this.height):void 0===c&&void 0===e&&(c=1,e=1),a>this.width||b>this.height||0>a||0>b)return[0,0,0,255];var f=this.drawingContext.getImageData(a,b,c,e),g=f.data;if(1===c&&1===e){for(var h=[],i=0;i<g.length;i+=4)h.push(g[i],g[i+1],g[i+2],g[i+3]);return h}c=Math.min(c,this.width),e=Math.min(e,this.height);var j=new d.Image(c,e);return j.canvas.getContext("2d").putImageData(f,0,0,0,0,c,e),j},d.prototype.loadPixels=function(){var a=this.width,b=this.height,c=this.drawingContext.getImageData(0,0,a,b);this._setProperty("imageData",c),this._setProperty("pixels",c.data)},d.prototype.set=function(a,b,c){if(c instanceof d.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this.drawingContext.drawImage(c.canvas,a,b),this.loadPixels.call(this),this.drawingContext.restore();else{var e=4*(b*this.width+a);if(this.imageData||this.loadPixels.call(this),"number"==typeof c)e<this.pixels.length&&(this.pixels[e]=c,this.pixels[e+1]=c,this.pixels[e+2]=c,this.pixels[e+3]=255);else if(c instanceof Array){if(c.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");e<this.pixels.length&&(this.pixels[e]=c[0],this.pixels[e+1]=c[1],this.pixels[e+2]=c[2],this.pixels[e+3]=c[3])}else c instanceof d.Color&&e<this.pixels.length&&(this.pixels[e]=c.rgba[0],this.pixels[e+1]=c.rgba[1],this.pixels[e+2]=c.rgba[2],this.pixels[e+3]=c.rgba[3])}},d.prototype.updatePixels=function(a,b,c,d){void 0===a&&void 0===b&&void 0===c&&void 0===d&&(a=0,b=0,c=this.width,d=this.height),this.drawingContext.putImageData(this.imageData,a,b,0,0,c,d)},d}({},amdclean.core,amdclean.filters,amdclean.p5Color),!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof define&&define.amd?define("reqwest",c):b[a]=c()}("reqwest",amdclean,function(){function succeed(a){var b=protocolRe.exec(a.url);return b=b&&b[1]||window.location.protocol,httpsRe.test(b)?twoHundo.test(a.request.status):!!a.request.response}function handleReadyState(a,b,c){return function(){return a._aborted?c(a.request):a._timedOut?c(a.request,"Request is aborted: timeout"):void(a.request&&4==a.request[readyState]&&(a.request.onreadystatechange=noop,succeed(a)?b(a.request):c(a.request)))}}function setHeaders(a,b){var c,d=b.headers||{};d.Accept=d.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"];var e="function"==typeof FormData&&b.data instanceof FormData;b.crossOrigin||d[requestedWith]||(d[requestedWith]=defaultHeaders.requestedWith),d[contentType]||e||(d[contentType]=b.contentType||defaultHeaders.contentType);for(c in d)d.hasOwnProperty(c)&&"setRequestHeader"in a&&a.setRequestHeader(c,d[c])}function setCredentials(a,b){"undefined"!=typeof b.withCredentials&&"undefined"!=typeof a.withCredentials&&(a.withCredentials=!!b.withCredentials)}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||reqwest.getcallbackPrefix(e),h=new RegExp("((^|\\?|&)"+f+")=([^&]+)"),i=d.match(h),j=doc.createElement("script"),k=0,l=-1!==navigator.userAgent.indexOf("MSIE 10.0");return i?"?"===i[3]?d=d.replace(h,"$1="+g):g=i[3]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,"undefined"==typeof j.onreadystatechange||l||(j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){return j[readyState]&&"complete"!==j[readyState]&&"loaded"!==j[readyState]||k?!1:(j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),b(lastValue),lastValue=void 0,head.removeChild(j),void(k=1))},head.appendChild(j),{abort:function(){j.onload=j.onreadystatechange=null,c({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(j),k=1}}}function getRequest(a,b){var c,d=this.o,e=(d.method||"GET").toUpperCase(),f="string"==typeof d?d:d.url,g=d.processData!==!1&&d.data&&"string"!=typeof d.data?reqwest.toQueryString(d.data):d.data||null,h=!1;return"jsonp"!=d.type&&"GET"!=e||!g||(f=urlappend(f,g),g=null),"jsonp"==d.type?handleJsonp(d,a,b,f):(c=d.xhr&&d.xhr(d)||xhr(d),c.open(e,f,d.async===!1?!1:!0),setHeaders(c,d),setCredentials(c,d),win[xDomainRequest]&&c instanceof win[xDomainRequest]?(c.onload=a,c.onerror=b,c.onprogress=function(){},h=!0):c.onreadystatechange=handleReadyState(this,a,b),d.before&&d.before(c),h?setTimeout(function(){c.send(g)},200):c.send(g),c)}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){return a.match("json")?"json":a.match("javascript")?"js":a.match("text")?"html":a.match("xml")?"xml":void 0}function init(o,fn){function complete(a){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(a)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(a,b,c){for(a=self.request,self._responseArgs.resp=a,self._responseArgs.msg=b,self._responseArgs.t=c,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(a,b,c);complete(a)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c,d,e,f,g=a.name,h=a.tagName.toLowerCase(),i=function(a){a&&!a.disabled&&b(g,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(!a.disabled&&g)switch(h){case"input":/reset|button|image|file/i.test(a.type)||(c=/checkbox/i.test(a.type),d=/radio/i.test(a.type),e=a.value,(!(c||d)||a.checked)&&b(g,normalize(c&&""===e?"on":e)));break;case"textarea":b(g,normalize(a.value));break;case"select":if("select-one"===a.type.toLowerCase())i(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(f=0;a.length&&f<a.length;f++)a.options[f].selected&&i(a.options[f])}}function eachFormElement(){var a,b,c=this,d=function(a,b){var d,e,f;for(d=0;d<b.length;d++)for(f=a[byTag](b[d]),e=0;e<f.length;e++)serial(f[e],c)};for(b=0;b<arguments.length;b++)a=arguments[b],/input|select|textarea/i.test(a.tagName)&&serial(a,c),d(a,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}function buildParams(a,b,c,d){var e,f,g,h=/\[\]$/;if(isArray(b))for(f=0;b&&f<b.length;f++)g=b[f],c||h.test(a)?d(a,g):buildParams(a+"["+("object"==typeof g?f:"")+"]",g,c,d);else if(b&&"[object Object]"===b.toString())for(e in b)buildParams(a+"["+e+"]",b[e],c,d);else d(a,b)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(a){return a instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(a){if(a.crossOrigin===!0){var b=win[xmlHttpRequest]?new XMLHttpRequest:null;if(b&&"withCredentials"in b)return b;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(a){return a}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(a,b){return a=a||function(){},b=b||function(){},this._fulfilled?this._responseArgs.resp=a(this._responseArgs.resp):this._erred?b(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(a),this._errorHandlers.push(b)),this},always:function(a){return this._fulfilled||this._erred?a(this._responseArgs.resp):this._completeHandlers.push(a),this},fail:function(a){return this._erred?a(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(a),this},"catch":function(a){return this.fail(a)}},reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(0===arguments.length)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),b="map"==a?serializeHash:"array"==a?reqwest.serializeArray:serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a,b){var c,d,e=b||!1,f=[],g=encodeURIComponent,h=function(a,b){b="function"==typeof b?b():null==b?"":b,f[f.length]=g(a)+"="+g(b)};if(isArray(a))for(d=0;a&&d<a.length;d++)h(a[d].name,a[d].value);else for(c in a)a.hasOwnProperty(c)&&buildParams(c,a[c],e,h);return f.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest.ajaxSetup=function(a){a=a||{};for(var b in a)globalSetupOptions[b]=a[b]},reqwest}),amdclean.inputfiles=function(a,b,c){"use strict";function d(a,b){var c={};if(b=b||[],"undefined"==typeof b)for(var d=0;d<a.length;d++)b[d.toString()]=d;for(var e=0;e<b.length;e++){var f=b[e],g=a[e];c[f]=g}return c}var e=b,c=c;return e.prototype.createInput=function(){throw"not yet implemented"},e.prototype.createReader=function(){throw"not yet implemented"},e.prototype.loadBytes=function(){throw"not yet implemented"},e.prototype.loadJSON=function(){var a=arguments[0],b=arguments[1],d=[],e="json";return"string"==typeof arguments[2]&&("jsonp"===arguments[2]||"json"===arguments[2])&&(e=arguments[2]),c({url:a,type:e,crossOrigin:!0}).then(function(a){for(var c in a)d[c]=a[c];"undefined"!=typeof b&&b(a)}),d},e.prototype.loadStrings=function(a,b){var c=[],d=new XMLHttpRequest;return d.open("GET",a,!0),d.onreadystatechange=function(){if(4===d.readyState&&(200===d.status||0===d.status)){var a=d.responseText.match(/[^\r\n]+/g);for(var e in a)c[e]=a[e];"undefined"!=typeof b&&b(c)}},d.send(null),c},e.prototype.loadTable=function(a){for(var b=null,f=[],g=!1,h=",",i=!1,j=1;j<arguments.length;j++)if("function"==typeof arguments[j])b=arguments[j];else if("string"==typeof arguments[j])if(f.push(arguments[j]),"header"===arguments[j]&&(g=!0),"csv"===arguments[j]){if(i)throw new Error("Cannot set multiple separator types.");h=",",i=!0}else if("tsv"===arguments[j]){if(i)throw new Error("Cannot set multiple separator types.");h="	",i=!0}var k=new e.Table;return c({url:a,crossOrigin:!0,type:"csv"}).then(function(a){a=a.responseText;for(var c,f={},i=0,l=1,m=2,n=4,o='"',p="\r",q="\n",r=[],s=0,t=null,u=function(){f.escaped=!1,t=[],w()},v=function(){f.currentState=n,r.push(t),t=null},w=function(){f.currentState=i,f.token=""},x=function(){t.push(f.token),w()};;){if(c=a[s++],null==c){if(f.escaped)throw new Error("Unclosed quote in file.");if(t){x(),v();break}}if(null===t&&u(),f.currentState===i){if(c===o){f.escaped=!0,f.currentState=l;continue}f.currentState=l}f.currentState===l&&f.escaped?c===o?a[s]===o?(f.token+=o,s++):(f.escaped=!1,f.currentState=m):f.token+=c:c===p?(a[s]===q&&s++,x(),v()):c===q?(x(),v()):c===h?x():f.currentState===l&&(f.token+=c)}if(g)k.columns=r.shift();else for(j=0;j<r.length;j++)k.columns[j]=j.toString();var y;for(j=0;j<r.length;j++)y=new e.TableRow,y.arr=r[j],y.obj=d(r[j],k.columns),k.addRow(y);null!==b&&b(k)}).fail(function(){"undefined"!=typeof b&&b(!1)}),k},e.prototype.loadXML=function(a,b){var d=[];return c({url:a,type:"xml",crossOrigin:!0}).then(function(a){b(a)}),d},e.prototype.parseXML=function(){throw"not yet implemented"},e.prototype.selectFolder=function(){throw"not yet implemented"},e.prototype.selectInput=function(){throw"not yet implemented"},e.prototype.httpGet=function(){var a=Array.prototype.slice.call(arguments);a.push("GET"),e.prototype.httpDo.apply(this,a)},e.prototype.httpPost=function(){var a=Array.prototype.slice.call(arguments);a.push("POST"),e.prototype.httpDo.apply(this,a)},e.prototype.httpDo=function(){for(var a,b="GET",d=arguments[0],e={},f="",g=1;g<arguments.length;g++){var h=arguments[g];"string"==typeof h?"GET"===h||"POST"===h||"PUT"===h?b=h:f=h:"object"==typeof h?e=h:"function"==typeof h&&(a=h)}""===f&&(f=-1!==d.indexOf("json")?"json":-1!==d.indexOf("xml")?"xml":"text"),c({url:d,method:b,data:e,type:f,crossOrigin:!0,success:function(b){"undefined"!=typeof a&&a("text"===f?b.response:b)}})},e}({},amdclean.core,amdclean.reqwest),amdclean.inputkeyboard=function(a,b){"use strict";var c=b,d={};return c.prototype.isKeyPressed=!1,c.prototype.keyIsPressed=!1,c.prototype.key="",c.prototype.keyCode=0,c.prototype.onkeydown=function(a){this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",a.which),d[a.which]=!0;var b=String.fromCharCode(a.which);b||(b=a.which),this._setProperty("key",b);var c=this.keyPressed||window.keyPressed;if("function"==typeof c&&!a.charCode){var e=c(a);e===!1&&a.preventDefault()}},c.prototype.onkeyup=function(a){var b=this.keyReleased||window.keyReleased;this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1),d[a.which]=!1;var c=String.fromCharCode(a.which);if(c||(c=a.which),this._setProperty("key",c),this._setProperty("keyCode",a.which),"function"==typeof b){var e=b(a);e===!1&&a.preventDefault()}},c.prototype.onkeypress=function(a){this._setProperty("keyCode",a.which),this._setProperty("key",String.fromCharCode(a.which));var b=this.keyTyped||window.keyTyped;if("function"==typeof b){var c=b(a);c===!1&&a.preventDefault()}},c.prototype.onblur=function(){d={}},c.prototype.keyIsDown=function(a){return d[a]},c}({},amdclean.core),amdclean.inputmouse=function(a,b,c){"use strict";function d(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}var e=b,c=c;return e.prototype.mouseX=0,e.prototype.mouseY=0,e.prototype.pmouseX=0,e.prototype.pmouseY=0,e.prototype.winMouseX=0,e.prototype.winMouseY=0,e.prototype.pwinMouseX=0,e.prototype.pwinMouseY=0,e.prototype.mouseButton=0,e.prototype.mouseIsPressed=!1,e.prototype.isMousePressed=!1,e.prototype._updateMouseCoords=function(a){if("touchstart"===a.type||"touchmove"===a.type||"touchend"===a.type)this._setProperty("mouseX",this.touchX),this._setProperty("mouseY",this.touchY);else if(null!==this._curElement){var b=d(this._curElement.elt,a);this._setProperty("mouseX",b.x),this._setProperty("mouseY",b.y)}this._setProperty("winMouseX",a.pageX),this._setProperty("winMouseY",a.pageY)},e.prototype._updatePMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY)},e.prototype._setMouseButton=function(a){1===a.button?this._setProperty("mouseButton",c.CENTER):2===a.button?this._setProperty("mouseButton",c.RIGHT):(this._setProperty("mouseButton",c.LEFT),("touchstart"===a.type||"touchmove"===a.type)&&(this._setProperty("mouseX",this.touchX),this._setProperty("mouseY",this.touchY)))},e.prototype.onmousemove=function(a){var b,c=this._isGlobal?window:this;this._updateMouseCoords(a),this.isMousePressed?"function"==typeof c.mouseDragged?(b=c.mouseDragged(a),b===!1&&a.preventDefault()):"function"==typeof c.touchMoved&&(b=c.touchMoved(a),b===!1&&a.preventDefault(),this._updateTouchCoords(a)):"function"==typeof c.mouseMoved&&(b=c.mouseMoved(a),b===!1&&a.preventDefault())},e.prototype.onmousedown=function(a){var b,c=this._isGlobal?window:this;this._setProperty("isMousePressed",!0),this._setProperty("mouseIsPressed",!0),this._setMouseButton(a),this._updateMouseCoords(a),"function"==typeof c.mousePressed?(b=c.mousePressed(a),b===!1&&a.preventDefault()):"function"==typeof c.touchStarted&&(b=c.touchStarted(a),b===!1&&a.preventDefault(),this._updateTouchCoords(a))},e.prototype.onmouseup=function(a){var b,c=this._isGlobal?window:this;this._setProperty("isMousePressed",!1),this._setProperty("mouseIsPressed",!1),"function"==typeof c.mouseReleased?(b=c.mouseReleased(a),b===!1&&a.preventDefault()):"function"==typeof c.touchEnded&&(b=c.touchEnded(a),b===!1&&a.preventDefault(),this._updateTouchCoords(a))},e.prototype.onclick=function(a){var b=this._isGlobal?window:this;if("function"==typeof b.mouseClicked){var c=b.mouseClicked(a);c===!1&&a.preventDefault()}},e.prototype.onmousewheel=function(a){var b=this._isGlobal?window:this;if("function"==typeof b.mouseWheel){var c=b.mouseWheel(a);c===!1&&a.preventDefault()}},e}({},amdclean.core,amdclean.constants),amdclean.inputtime_date=function(a,b){"use strict";var c=b;return c.prototype.day=function(){return(new Date).getDate()},c.prototype.hour=function(){return(new Date).getHours()},c.prototype.minute=function(){return(new Date).getMinutes()},c.prototype.millis=function(){return(new Date).getTime()-this._startTime},c.prototype.month=function(){return(new Date).getMonth()+1},c.prototype.second=function(){return(new Date).getSeconds()},c.prototype.year=function(){return(new Date).getFullYear()},c}({},amdclean.core),amdclean.inputtouch=function(a,b){"use strict";function c(a,b,c){c=c||0;var d=a.getBoundingClientRect();return{x:b.changedTouches[c].pageX-d.left,y:b.changedTouches[c].pageY-d.top}}var d=b;return d.prototype.touchX=0,d.prototype.touchY=0,d.prototype.ptouchX=0,d.prototype.ptouchY=0,d.prototype.touches=[],d.prototype.touchIsDown=!1,d.prototype._updateTouchCoords=function(a){if("mousedown"===a.type||"mousemove"===a.type||"mouseup"===a.type)this._setProperty("touchX",this.mouseX),this._setProperty("touchY",this.mouseY);else{var b=c(this._curElement.elt,a,0);this._setProperty("touchX",b.x),this._setProperty("touchY",b.y);for(var d=[],e=0;e<a.changedTouches.length;e++){var f=c(this._curElement.elt,a,e);d[e]={x:f.x,y:f.y}}this._setProperty("touches",d)}},d.prototype._updatePTouchCoords=function(){this._setProperty("ptouchX",this.touchX),this._setProperty("ptouchY",this.touchY)},d.prototype.ontouchstart=function(a){var b,c=this._isGlobal?window:this;this._updateTouchCoords(a),this._setProperty("touchIsDown",!0),"function"==typeof c.touchStarted?(b=c.touchStarted(a),b===!1&&a.preventDefault()):"function"==typeof c.mousePressed&&(b=c.mousePressed(a),b===!1&&a.preventDefault())},d.prototype.ontouchmove=function(a){var b,c=this._isGlobal?window:this;this._updateTouchCoords(a),"function"==typeof c.touchMoved?(b=c.touchMoved(a),b===!1&&a.preventDefault()):"function"==typeof c.mouseDragged&&(b=c.mouseDragged(a),b===!1&&a.preventDefault(),this._updateMouseCoords(a))},d.prototype.ontouchend=function(a){this._updateTouchCoords(a),0===this.touches.length&&this._setProperty("touchIsDown",!1);var b,c=this._isGlobal?window:this;"function"==typeof c.touchEnded?(b=c.touchEnded(a),b===!1&&a.preventDefault()):"function"==typeof c.mouseReleased&&(b=c.mouseReleased(a),b===!1&&a.preventDefault(),this._updateMouseCoords(a))},d}({},amdclean.core),amdclean.mathmath=function(a,b){"use strict";var c=b;return c.prototype.createVector=function(a,b,d){return this instanceof c?new c.Vector(this,arguments):new c.Vector(a,b,d)},c}({},amdclean.core),amdclean.mathcalculation=function(a,b){"use strict";var c=b;return c.prototype.abs=Math.abs,c.prototype.ceil=Math.ceil,c.prototype.constrain=function(a,b,c){return Math.max(Math.min(a,c),b)},c.prototype.dist=function(a,b,c,d){return Math.sqrt((c-a)*(c-a)+(d-b)*(d-b))},c.prototype.exp=Math.exp,c.prototype.floor=Math.floor,c.prototype.lerp=function(a,b,c){return c*(b-a)+a},c.prototype.log=Math.log,c.prototype.mag=function(a,b){return Math.sqrt(a*a+b*b)},c.prototype.map=function(a,b,c,d,e){return(a-b)/(c-b)*(e-d)+d},c.prototype.max=function(){return arguments[0]instanceof Array?Math.max.apply(null,arguments[0]):Math.max.apply(null,arguments)},c.prototype.min=function(){return arguments[0]instanceof Array?Math.min.apply(null,arguments[0]):Math.min.apply(null,arguments)},c.prototype.norm=function(a,b,c){return this.map(a,b,c,0,1)},c.prototype.pow=Math.pow,c.prototype.round=Math.round,c.prototype.sq=function(a){return a*a},c.prototype.sqrt=Math.sqrt,c}({},amdclean.core),amdclean.mathrandom=function(a,b){"use strict";var c=b,d=!1,e=function(){var a,b,c=4294967296,d=1664525,e=1013904223;return{setSeed:function(d){b=a=(null==d?Math.random()*c:d)>>>0},getSeed:function(){return a},rand:function(){return b=(d*b+e)%c,b/c}}}();c.prototype.randomSeed=function(a){e.setSeed(a),d=!0},c.prototype.random=function(a,b){var c;if(c=d?e.rand():Math.random(),0===arguments.length)return c;if(1===arguments.length)return c*a;if(a>b){var f=a;a=b,b=f}return c*(b-a)+a};var f,g=!1;return c.prototype.randomGaussian=function(a,b){var c,d,e,h;if(g)c=f,g=!1;else{do d=this.random(2)-1,e=this.random(2)-1,h=d*d+e*e;while(h>=1);h=Math.sqrt(-2*Math.log(h)/h),c=d*h,f=e*h,g=!0}var i=a||0,j=b||1;return c*j+i},c}({},amdclean.core),amdclean.mathnoise=function(a,b){"use strict";for(var c=b,d=4,e=1<<d,f=8,g=1<<f,h=4095,i=4,j=.5,k=.5,l=Math.floor(360/k),m=new Array(l),n=new Array(l),o=Math.PI/180,p=0;l>p;p++)m[p]=Math.sin(p*o*k),n[p]=Math.cos(p*o*k);

var q=l;q>>=1;var r;return c.prototype.noise=function(a,b,c){if(b=b||0,c=c||0,null==r){r=new Array(h+1);for(var k=0;h+1>k;k++)r[k]=Math.random()}0>a&&(a=-a),0>b&&(b=-b),0>c&&(c=-c);for(var m,o,p,s,t,u=Math.floor(a),v=Math.floor(b),w=Math.floor(c),x=a-u,y=b-v,z=c-w,A=0,B=.5,C=function(a){return.5*(1-n[Math.floor(a*q)%l])},D=0;i>D;D++){var E=u+(v<<d)+(w<<f);m=C(x),o=C(y),p=r[E&h],p+=m*(r[E+1&h]-p),s=r[E+e&h],s+=m*(r[E+e+1&h]-s),p+=o*(s-p),E+=g,s=r[E&h],s+=m*(r[E+1&h]-s),t=r[E+e&h],t+=m*(r[E+e+1&h]-t),s+=o*(t-s),p+=C(z)*(s-p),A+=p*B,B*=j,u<<=1,x*=2,v<<=1,y*=2,w<<=1,z*=2,x>=1&&(u++,x--),y>=1&&(v++,y--),z>=1&&(w++,z--)}return A},c.prototype.noiseDetail=function(a,b){a>0&&(i=a),b>0&&(j=b)},c.prototype.noiseSeed=function(a){var b=function(){var a,b,c=4294967296,d=1664525,e=1013904223;return{setSeed:function(d){b=a=(null==d?Math.random()*c:d)>>>0},getSeed:function(){return a},rand:function(){return b=(d*b+e)%c,b/c}}}();b.setSeed(a),r=new Array(h+1);for(var c=0;h+1>c;c++)r[c]=b.rand()},c}({},amdclean.core),amdclean.mathtrigonometry=function(a,b,c,d){"use strict";var e=b,f=c,d=d;return e.prototype._angleMode=d.RADIANS,e.prototype.acos=function(a){return this._angleMode===d.RADIANS?Math.acos(a):f.radiansToDegrees(Math.acos(a))},e.prototype.asin=function(a){return this._angleMode===d.RADIANS?Math.asin(a):f.radiansToDegrees(Math.asin(a))},e.prototype.atan=function(a){return this._angleMode===d.RADIANS?Math.atan(a):f.radiansToDegrees(Math.atan(a))},e.prototype.atan2=function(a,b){return this._angleMode===d.RADIANS?Math.atan2(a,b):f.radiansToDegrees(Math.atan2(a,b))},e.prototype.cos=function(a){return Math.cos(this._angleMode===d.RADIANS?a:this.radians(a))},e.prototype.sin=function(a){return Math.sin(this._angleMode===d.RADIANS?a:this.radians(a))},e.prototype.tan=function(a){return Math.tan(this._angleMode===d.RADIANS?a:this.radians(a))},e.prototype.degrees=function(a){return f.radiansToDegrees(a)},e.prototype.radians=function(a){return f.degreesToRadians(a)},e.prototype.angleMode=function(a){(a===d.DEGREES||a===d.RADIANS)&&(this._angleMode=a)},e}({},amdclean.core,amdclean.polargeometry,amdclean.constants),amdclean.outputfiles=function(a,b){"use strict";function c(a,b){b||(b=""),a||(a="untitled");var c="";return a&&a.indexOf(".")>-1&&(c=a.split(".").pop()),b&&c!==b&&(c=b,a=a+"."+c),[a,c]}function d(a){document.body.removeChild(a.target)}var e=b;window.URL=window.URL||window.webkitURL,e.prototype._pWriters=[],e.prototype.beginRaw=function(){throw"not yet implemented"},e.prototype.beginRecord=function(){throw"not yet implemented"},e.prototype.createOutput=function(){throw"not yet implemented"},e.prototype.createWriter=function(a,b){var c;for(var d in e.prototype._pWriters)if(e.prototype._pWriters[d].name===a)return c=new e.PrintWriter(a+window.millis(),b),e.prototype._pWriters.push(c),c;return c=new e.PrintWriter(a,b),e.prototype._pWriters.push(c),c},e.prototype.endRaw=function(){throw"not yet implemented"},e.prototype.endRecord=function(){throw"not yet implemented"},e.PrintWriter=function(a,b){var c=this;this.name=a,this.content="",this.print=function(a){this.content+=a},this.println=function(a){this.content+=a+"\n"},this.flush=function(){this.content=""},this.close=function(){var d=[];d.push(this.content),e.prototype.writeFile(d,a,b);for(var f in e.prototype._pWriters)e.prototype._pWriters[f].name===this.name&&e.prototype._pWriters.splice(f,1);c.flush(),c={}}},e.prototype.saveBytes=function(){throw"not yet implemented"},e.prototype.save=function(){var a=arguments,b=this._curElement.elt;if(0===a.length)return void e.prototype.saveCanvas(b);if(a[0]instanceof e.Graphics)return void e.prototype.saveCanvas(a[0].elt,a[1],a[2]);if("string"==typeof a[0])e.prototype.saveCanvas(b,a[0]);else{var d=c(a[1],a[2])[1];switch(d){case"json":e.prototype.saveJSON(a[0],a[1],a[2]);break;case"txt":e.prototype.saveStrings(a[0],a[1],a[2]);break;default:a[0]instanceof Array?e.prototype.saveStrings(a[0],a[1],a[2]):a[0]instanceof e.Table?e.prototype.saveTable(a[0],a[1],a[2],a[3]):a[0]instanceof e.Image?e.prototype.saveCanvas(a[0].canvas,a[1]):a[0]instanceof e.SoundFile?e.prototype.saveSound(a[0],a[1],a[2],a[3]):a[0]instanceof Object&&e.prototype.saveJSON(a[0],a[1],a[2])}}},e.prototype.saveJSON=function(a,b,c){var d;d=c?JSON.stringify(a):JSON.stringify(a,void 0,2),this.saveStrings(d.split("\n"),b,"json")},e.prototype.saveJSONObject=e.prototype.saveJSON,e.prototype.saveJSONArray=e.prototype.saveJSON,e.prototype.saveStream=function(){throw"not yet implemented"},e.prototype.saveStrings=function(a,b,c){var d=c||"txt",e=this.createWriter(b,d);for(var f in a)f<a.length-1?e.println(a[f]):e.print(a[f]);e.close(),e.flush()},e.prototype.saveXML=function(){throw"not yet implemented"},e.prototype.selectOutput=function(){throw"not yet implemented"},e.prototype.saveTable=function(a,b,c){var d=this.createWriter(b,c),e=a.columns,g=",";if("tsv"===c&&(g="	"),"html"!==c){if("0"!==e[0])for(var h=0;h<e.length;h++)h<e.length-1?d.print(e[h]+g):d.println(e[h]);for(var i=0;i<a.rows.length;i++){var j;for(j=0;j<a.rows[i].arr.length;j++)j<a.rows[i].arr.length-1?d.print(a.rows[i].arr[j]+g):i<a.rows.length-1?d.println(a.rows[i].arr[j]):d.print(a.rows[i].arr[j])}}else{d.println("<html>"),d.println("<head>");var k='  <meta http-equiv="content-type" content';if(k+='="text/html;charset=utf-8" />',d.println(k),d.println("</head>"),d.println("<body>"),d.println("  <table>"),"0"!==e[0]){d.println("    <tr>");for(var l=0;l<e.length;l++){var m=f(e[l]);d.println("      <td>"+m),d.println("      </td>")}d.println("    </tr>")}for(var n=0;n<a.rows.length;n++){d.println("    <tr>");for(var o=0;o<a.columns.length;o++){var p=a.rows[n].getString(o),q=f(p);d.println("      <td>"+q),d.println("      </td>")}d.println("    </tr>")}d.println("  </table>"),d.println("</body>"),d.print("</html>")}d.close(),d.flush()};var f=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};return e.prototype.writeFile=function(a,b,c){var d="application/octet-stream";e.prototype._isSafari()&&(d="text/plain");var f=new Blob(a,{type:d}),g=window.URL.createObjectURL(f);e.prototype.downloadFile(g,b,c)},e.prototype.downloadFile=function(a,b,f){var g=c(b,f),h=g[0],i=g[1],j=document.createElement("a");if(j.href=a,j.download=h,j.onclick=d,j.style.display="none",document.body.appendChild(j),e.prototype._isSafari()){var k="Hello, Safari user! To download this file...\n";k+="1. Go to File --> Save As.\n",k+='2. Choose "Page Source" as the Format.\n',k+='3. Name it with this extension: ."'+i+'"',alert(k)}j.click(),a=null},e.prototype._checkFileExtension=c,e.prototype._isSafari=function(){var a=Object.prototype.toString.call(window.HTMLElement);return a.indexOf("Constructor")>0},e}({},amdclean.core),amdclean.outputimage=function(a,b){"use strict";var c=b,d=[];return c.prototype.saveCanvas=function(a,b,d){d||(d=c.prototype._checkFileExtension(b,d)[1],""===d&&(d="png"));var e;if(a?e=a:this._curElement&&this._curElement.elt&&(e=this._curElement.elt),c.prototype._isSafari()){var f="Hello, Safari user!\n";f+="Now capturing a screenshot...\n",f+="To save this image,\n",f+="go to File --> Save As.\n",alert(f),window.location.href=e.toDataURL()}else{var g;if("undefined"==typeof d)d="png",g="image/png";else switch(d){case"png":g="image/png";break;case"jpeg":g="image/jpeg";break;case"jpg":g="image/jpeg";break;default:g="image/png"}var h="image/octet-stream",i=e.toDataURL(g);i=i.replace(g,h),c.prototype.downloadFile(i,b,d)}},c.prototype.saveFrames=function(a,b,e,f,g){var h=e||3;h=c.prototype.constrain(h,0,15),h=1e3*h;var i=f||15;i=c.prototype.constrain(i,0,22);var j=0,k=c.prototype._makeFrame,l=this._curElement.elt,m=setInterval(function(){k(a+j,b,l),j++},1e3/i);setTimeout(function(){if(clearInterval(m),g)g(d);else for(var a=0;a<d.length;a++){var b=d[a];c.prototype.downloadFile(b.imageData,b.filename,b.ext)}d=[]},h+.01)},c.prototype._makeFrame=function(a,b,c){var e;e=this?this._curElement.elt:c;var f;if(b)switch(b.toLowerCase()){case"png":f="image/png";break;case"jpeg":f="image/jpeg";break;case"jpg":f="image/jpeg";break;default:f="image/png"}else b="png",f="image/png";var g="image/octet-stream",h=e.toDataURL(f);h=h.replace(f,g);var i={};i.imageData=h,i.filename=a,i.ext=b,d.push(i)},c}({},amdclean.core),amdclean.outputtext_area=function(a,b){"use strict";var c=b;return c.prototype.print=window.console&&console.log?console.log.bind(console):function(){},c.prototype.println=c.prototype.print,c}({},amdclean.core),amdclean.renderingrendering=function(a,b,c){var d=b,c=c;return d.prototype.createCanvas=function(a,b,c){var e;return c?(e=document.createElement("canvas"),e.id="defaultCanvas"):e=this.canvas,this._setupDone||(e.className+=" p5_hidden",e.style.visibility="hidden"),this._userNode?this._userNode.appendChild(e):document.body.appendChild(e),this._defaultGraphics||(this._defaultGraphics=new d.Graphics(e,this,!0),this._elements.push(this._defaultGraphics)),this._defaultGraphics.resize(a,b),this._defaultGraphics._applyDefaults(),this._defaultGraphics},d.prototype.resizeCanvas=function(a,b,c){this._defaultGraphics&&(this._defaultGraphics.resize(a,b),this._defaultGraphics._applyDefaults(),c||this.redraw())},d.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},d.prototype.createGraphics=function(a,b){var c=document.createElement("canvas"),e=this._userNode||document.body;e.appendChild(c);var f=new d.Graphics(c,this,!1);this._elements.push(f);for(var g in d.prototype)f.hasOwnProperty(g)||(f[g]="function"==typeof d.prototype[g]?d.prototype[g].bind(f):d.prototype[g]);return f.resize(a,b),f._applyDefaults(),f},d.prototype.blendMode=function(a){if(a!==c.BLEND&&a!==c.DARKEST&&a!==c.LIGHTEST&&a!==c.DIFFERENCE&&a!==c.MULTIPLY&&a!==c.EXCLUSION&&a!==c.SCREEN&&a!==c.REPLACE&&a!==c.OVERLAY&&a!==c.HARD_LIGHT&&a!==c.SOFT_LIGHT&&a!==c.DODGE&&a!==c.BURN&&a!==c.ADD&&a!==c.NORMAL)throw new Error("Mode "+a+" not recognized.");this.drawingContext.globalCompositeOperation=a},d}({},amdclean.core,amdclean.constants),amdclean.shape2d_primitives=function(a,b,c,d){"use strict";function e(a,b,c){for(var d=2*Math.PI,e=[],g=Math.PI/2,i=c>b?1:-1,j=b,k=Math.min(d,Math.abs(c-b));k>h;){var l=j+i*Math.min(k,g);e.push(f(a,j,l)),k-=Math.abs(l-j),j=l}return e}function f(a,b,c){var d=(c-b)/2,e=a*Math.cos(d),f=a*Math.sin(d),g=e,h=-f,i=.5522847498,j=i*Math.tan(d),k=g+j*f,l=h+j*e,m=k,n=-l,o=d+b,p=Math.cos(o),q=Math.sin(o);return{x1:a*Math.cos(b),y1:a*Math.sin(b),x2:k*p-l*q,y2:k*q+l*p,x3:m*p-n*q,y3:m*q+n*p,x4:a*Math.cos(c),y4:a*Math.sin(c)}}var g=b,c=c,d=d,h=1e-5;return g.prototype.arc=function(a,b,f,g,h,i,j){if(this._doStroke||this._doFill){this._angleMode===d.DEGREES&&(h=this.radians(h),i=this.radians(i));var k=this.drawingContext,l=c.arcModeAdjust(a,b,f,g,this._ellipseMode),m=e(1,h,i),n=l.w/2,o=l.h/2;return k.beginPath(),m.forEach(function(a,b){0===b&&k.moveTo(l.x+a.x1*n,l.y+a.y1*o),k.bezierCurveTo(l.x+a.x2*n,l.y+a.y2*o,l.x+a.x3*n,l.y+a.y3*o,l.x+a.x4*n,l.y+a.y4*o)}),this._doFill&&((j===d.PIE||null==j)&&k.lineTo(l.x,l.y),k.closePath(),k.fill(),this._doStroke&&(j===d.CHORD||j===d.PIE))?(k.stroke(),this):(this._doStroke&&(j===d.OPEN||null==j)&&(k.beginPath(),m.forEach(function(a,b){0===b&&k.moveTo(l.x+a.x1*n,l.y+a.y1*o),k.bezierCurveTo(l.x+a.x2*n,l.y+a.y2*o,l.x+a.x3*n,l.y+a.y3*o,l.x+a.x4*n,l.y+a.y4*o)}),k.stroke()),this)}},g.prototype.ellipse=function(a,b,d,e){if(this._doStroke||this._doFill){d=Math.abs(d),e=Math.abs(e);var f=this.drawingContext,g=c.modeAdjust(a,b,d,e,this._ellipseMode);if(f.beginPath(),d===e)f.arc(g.x+g.w/2,g.y+g.w/2,g.w/2,0,2*Math.PI,!1);else{var h=.5522848,i=g.w/2*h,j=g.h/2*h,k=g.x+g.w,l=g.y+g.h,m=g.x+g.w/2,n=g.y+g.h/2;f.moveTo(g.x,n),f.bezierCurveTo(g.x,n-j,m-i,g.y,m,g.y),f.bezierCurveTo(m+i,g.y,k,n-j,k,n),f.bezierCurveTo(k,n+j,m+i,l,m,l),f.bezierCurveTo(m-i,l,g.x,n+j,g.x,n),f.closePath()}return this._doFill&&f.fill(),this._doStroke&&f.stroke(),this}},g.prototype.line=function(a,b,c,d){if(this._doStroke){var e=this.drawingContext;if("rgba(0,0,0,0)"!==e.strokeStyle)return e.beginPath(),e.moveTo(a,b),e.lineTo(c,d),e.stroke(),this}},g.prototype.point=function(a,b){if(this._doStroke){var c=this.drawingContext,e=c.strokeStyle,f=c.fillStyle;if("rgba(0,0,0,0)"!==e)return a=Math.round(a),b=Math.round(b),c.fillStyle=e,c.lineWidth>1?(c.beginPath(),c.arc(a,b,c.lineWidth/2,0,d.TWO_PI,!1),c.fill()):c.fillRect(a,b,1,1),c.fillStyle=f,this}},g.prototype.quad=function(a,b,c,d,e,f,g,h){if(this._doStroke||this._doFill){var i=this.drawingContext;return i.beginPath(),i.moveTo(a,b),i.lineTo(c,d),i.lineTo(e,f),i.lineTo(g,h),i.closePath(),this._doFill&&i.fill(),this._doStroke&&i.stroke(),this}},g.prototype.rect=function(a,b,d,e){if(this._doStroke||this._doFill){var f=c.modeAdjust(a,b,d,e,this._rectMode),g=this.drawingContext;return this._doStroke&&g.lineWidth%2===1&&g.translate(.5,.5),g.beginPath(),g.rect(f.x,f.y,f.w,f.h),this._doFill&&g.fill(),this._doStroke&&g.stroke(),this._doStroke&&g.lineWidth%2===1&&g.translate(-.5,-.5),this}},g.prototype.triangle=function(a,b,c,d,e,f){if(this._doStroke||this._doFill){var g=this.drawingContext;return g.beginPath(),g.moveTo(a,b),g.lineTo(c,d),g.lineTo(e,f),g.closePath(),this._doFill&&g.fill(),this._doStroke&&g.stroke(),this}},g}({},amdclean.core,amdclean.canvas,amdclean.constants),amdclean.shapeattributes=function(a,b,c){"use strict";var d=b,c=c;return d.prototype._rectMode=c.CORNER,d.prototype._ellipseMode=c.CENTER,d.prototype.ellipseMode=function(a){return(a===c.CORNER||a===c.CORNERS||a===c.RADIUS||a===c.CENTER)&&(this._ellipseMode=a),this},d.prototype.noSmooth=function(){return this.drawingContext.mozImageSmoothingEnabled=!1,this.drawingContext.webkitImageSmoothingEnabled=!1,this},d.prototype.rectMode=function(a){return(a===c.CORNER||a===c.CORNERS||a===c.RADIUS||a===c.CENTER)&&(this._rectMode=a),this},d.prototype.smooth=function(){return this.drawingContext.mozImageSmoothingEnabled=!0,this.drawingContext.webkitImageSmoothingEnabled=!0,this},d.prototype.strokeCap=function(a){return(a===c.ROUND||a===c.SQUARE||a===c.PROJECT)&&(this.drawingContext.lineCap=a),this},d.prototype.strokeJoin=function(a){return(a===c.ROUND||a===c.BEVEL||a===c.MITER)&&(this.drawingContext.lineJoin=a),this},d.prototype.strokeWeight=function(a){return this.drawingContext.lineWidth="undefined"==typeof a||0===a?1e-4:a,this},d}({},amdclean.core,amdclean.constants),amdclean.shapecurves=function(a,b){"use strict";var c=b,d=20,e=20;return c.prototype._curveTightness=0,c.prototype.bezier=function(a,b,c,d,e,f,g,h){return this._doStroke?(this.beginShape(),this.vertex(a,b),this.bezierVertex(c,d,e,f,g,h),this.endShape(),this.stroke(),this):void 0},c.prototype.bezierDetail=function(a){return d=a,this},c.prototype.bezierPoint=function(a,b,c,d,e){var f=1-e;return Math.pow(f,3)*a+3*Math.pow(f,2)*e*b+3*f*Math.pow(e,2)*c+Math.pow(e,3)*d},c.prototype.bezierTangent=function(a,b,c,d,e){var f=1-e;return 3*d*Math.pow(e,2)-3*c*Math.pow(e,2)+6*c*f*e-6*b*f*e+3*b*Math.pow(f,2)-3*a*Math.pow(f,2)},c.prototype.curve=function(a,b,c,d,e,f,g,h){return this._doStroke?(this.beginShape(),this.curveVertex(a,b),this.curveVertex(c,d),this.curveVertex(e,f),this.curveVertex(g,h),this.endShape(),this.stroke(),this):void 0},c.prototype.curveDetail=function(a){return e=a,this},c.prototype.curveTightness=function(a){this._setProperty("_curveTightness",a)},c.prototype.curvePoint=function(a,b,c,d,e){var f=e*e*e,g=e*e,h=-.5*f+g-.5*e,i=1.5*f-2.5*g+1,j=-1.5*f+2*g+.5*e,k=.5*f-.5*g;return a*h+b*i+c*j+d*k},c.prototype.curveTangent=function(a,b,c,d,e){var f=e*e,g=-3*f/2+2*e-.5,h=9*f/2-5*e,i=-9*f/2+4*e+.5,j=3*f/2-e;return a*g+b*h+c*i+d*j},c.prototype.curveTightness=function(){throw"not yet implemented"},c}({},amdclean.core),amdclean.shapevertex=function(a,b,c){"use strict";var d=b,c=c,e=null,f=[],g=[],h=!1,i=!1,j=!1,k=!1;return d.prototype._doFillStrokeClose=function(){this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke(),this.drawingContext.closePath()},d.prototype.beginContour=function(){return g=[],k=!0,this},d.prototype.beginShape=function(a){return e=a===c.POINTS||a===c.LINES||a===c.TRIANGLES||a===c.TRIANGLE_FAN||a===c.TRIANGLE_STRIP||a===c.QUADS||a===c.QUAD_STRIP?a:null,f=[],g=[],this},d.prototype.bezierVertex=function(){if(0===f.length)throw"vertex() must be used once before calling bezierVertex()";h=!0;for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return a.isVert=!1,k?g.push(a):f.push(a),this},d.prototype.curveVertex=function(a,b){return i=!0,this.vertex(a,b),this},d.prototype.endContour=function(){var a=g[0].slice();a.isVert=g[0].isVert,a.moveTo=!1,g.push(a),f.push(f[0]);for(var b=0;b<g.length;b++)f.push(g[b]);return this},d.prototype.endShape=function(a){if(0===f.length)return this;if(!this._doStroke&&!this._doFill)return this;var b,d=a===c.CLOSE;d&&!k&&f.push(f[0]);var g,l,m=f.length;if(!i||e!==c.POLYGON&&null!==e)if(!h||e!==c.POLYGON&&null!==e)if(!j||e!==c.POLYGON&&null!==e)if(e===c.POINTS)for(g=0;m>g;g++)b=f[g],this._doStroke&&this.stroke(b[6]),this.point(b[0],b[1]);else if(e===c.LINES)for(g=0;m>g+1;g+=2)b=f[g],this._doStroke&&this.stroke(f[g+1][6]),this.line(b[0],b[1],f[g+1][0],f[g+1][1]);else if(e===c.TRIANGLES)for(g=0;m>g+2;g+=3)b=f[g],this.drawingContext.beginPath(),this.drawingContext.moveTo(b[0],b[1]),this.drawingContext.lineTo(f[g+1][0],f[g+1][1]),this.drawingContext.lineTo(f[g+2][0],f[g+2][1]),this.drawingContext.lineTo(b[0],b[1]),this._doFill&&(this.fill(f[g+2][5]),this.drawingContext.fill()),this._doStroke&&(this.stroke(f[g+2][6]),this.drawingContext.stroke()),this.drawingContext.closePath();else if(e===c.TRIANGLE_STRIP)for(g=0;m>g+1;g++)b=f[g],this.drawingContext.beginPath(),this.drawingContext.moveTo(f[g+1][0],f[g+1][1]),this.drawingContext.lineTo(b[0],b[1]),this._doStroke&&this.stroke(f[g+1][6]),this._doFill&&this.fill(f[g+1][5]),m>g+2&&(this.drawingContext.lineTo(f[g+2][0],f[g+2][1]),this._doStroke&&this.stroke(f[g+2][6]),this._doFill&&this.fill(f[g+2][5])),this._doFillStrokeClose();else if(e===c.TRIANGLE_FAN){if(m>2)for(this.drawingContext.beginPath(),this.drawingContext.moveTo(f[0][0],f[0][1]),this.drawingContext.lineTo(f[1][0],f[1][1]),this.drawingContext.lineTo(f[2][0],f[2][1]),this._doFill&&this.fill(f[2][5]),this._doStroke&&this.stroke(f[2][6]),this._doFillStrokeClose(),g=3;m>g;g++)b=f[g],this.drawingContext.beginPath(),this.drawingContext.moveTo(f[0][0],f[0][1]),this.drawingContext.lineTo(f[g-1][0],f[g-1][1]),this.drawingContext.lineTo(b[0],b[1]),this._doFill&&this.fill(b[5]),this._doStroke&&this.stroke(b[6]),this._doFillStrokeClose()}else if(e===c.QUADS)for(g=0;m>g+3;g+=4){for(b=f[g],this.drawingContext.beginPath(),this.drawingContext.moveTo(b[0],b[1]),l=1;4>l;l++)this.drawingContext.lineTo(f[g+l][0],f[g+l][1]);this.drawingContext.lineTo(b[0],b[1]),this._doFill&&this.fill(f[g+3][5]),this._doStroke&&this.stroke(f[g+3][6]),this._doFillStrokeClose()}else if(e===c.QUAD_STRIP){if(m>3)for(g=0;m>g+1;g+=2)b=f[g],this.drawingContext.beginPath(),m>g+3?(this.drawingContext.moveTo(f[g+2][0],f[g+2][1]),this.drawingContext.lineTo(b[0],b[1]),this.drawingContext.lineTo(f[g+1][0],f[g+1][1]),this.drawingContext.lineTo(f[g+3][0],f[g+3][1]),this._doFill&&this.fill(f[g+3][5]),this._doStroke&&this.stroke(f[g+3][6])):(this.drawingContext.moveTo(b[0],b[1]),this.drawingContext.lineTo(f[g+1][0],f[g+1][1])),this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(f[0][0],f[0][1]),g=1;m>g;g++)b=f[g],b.isVert&&(b.moveTo?this.drawingContext.moveTo(b[0],b[1]):this.drawingContext.lineTo(b[0],b[1]));this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),g=0;m>g;g++)f[g].isVert?f[g].moveTo?this.drawingContext.moveTo([0],f[g][1]):this.drawingContext.lineTo(f[g][0],f[g][1]):this.drawingContext.quadraticCurveTo(f[g][0],f[g][1],f[g][2],f[g][3]);this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),g=0;m>g;g++)f[g].isVert?f[g].moveTo?this.drawingContext.moveTo(f[g][0],f[g][1]):this.drawingContext.lineTo(f[g][0],f[g][1]):this.drawingContext.bezierCurveTo(f[g][0],f[g][1],f[g][2],f[g][3],f[g][4],f[g][5]);this._doFillStrokeClose()}else if(m>3){var n=[],o=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(f[1][0],f[1][1]),g=1;m>g+2;g++)b=f[g],n[0]=[b[0],b[1]],n[1]=[b[0]+(o*f[g+1][0]-o*f[g-1][0])/6,b[1]+(o*f[g+1][1]-o*f[g-1][1])/6],n[2]=[f[g+1][0]+(o*f[g][0]-o*f[g+2][0])/6,f[g+1][1]+(o*f[g][1]-o*f[g+2][1])/6],n[3]=[f[g+1][0],f[g+1][1]],this.drawingContext.bezierCurveTo(n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]);d&&this.drawingContext.lineTo(f[g+1][0],f[g+1][1]),this._doFillStrokeClose()}return i=!1,h=!1,j=!1,k=!1,d&&f.pop(),this},d.prototype.quadraticVertex=function(a,b,d,e){if(this._contourInited){var h={};return h.x=a,h.y=b,h.x3=d,h.y3=e,h.type=c.QUADRATIC,this._contourVertices.push(h),this}if(!(f.length>0))throw"vertex() must be used once before calling quadraticVertex()";j=!0;for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];return i.isVert=!1,k?g.push(i):f.push(i),this},d.prototype.vertex=function(a,b,c){var d=[];return d.isVert=!0,d[0]=a,d[1]=b,d[2]=0,d[3]=0,d[4]=0,d[5]=this.drawingContext.fillStyle,d[6]=this.drawingContext.strokeStyle,c&&(d.moveTo=c),k?(0===g.length&&(d.moveTo=!0),g.push(d)):f.push(d),this},d}({},amdclean.core,amdclean.constants),amdclean.structure=function(a,b){"use strict";var c=b;return c.prototype.exit=function(){throw"exit() not implemented, see remove()"},c.prototype.noLoop=function(){this._loop=!1,this._drawInterval&&clearInterval(this._drawInterval)},c.prototype.loop=function(){this._loop=!0,this._draw()},c.prototype.push=function(){this.drawingContext.save(),this._styles.push({doStroke:this._doStroke,doFill:this._doFill,tint:this._tint,imageMode:this._imageMode,rectMode:this._rectMode,ellipseMode:this._ellipseMode,colorMode:this._colorMode,textFont:this.textFont,textLeading:this.textLeading,textSize:this.textSize,textStyle:this.textStyle})},c.prototype.pop=function(){this.drawingContext.restore();var a=this._styles.pop();this._doStroke=a.doStroke,this._doFill=a.doFill,this._tint=a.tint,this._imageMode=a.imageMode,this._rectMode=a.rectMode,this._ellipseMode=a.ellipseMode,this._colorMode=a.colorMode,this.textFont=a.textFont,this.textLeading=a.textLeading,this.textSize=a.textSize,this.textStyle=a.textStyle},c.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},c.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},c.prototype.redraw=function(){var a=this.setup||window.setup,b=this.draw||window.draw;"function"==typeof b&&(this.push(),"undefined"==typeof a&&this.scale(this._pixelDensity,this._pixelDensity),this._registeredMethods.pre.forEach(function(a){a.call(this)}),b(),this._registeredMethods.post.forEach(function(a){a.call(this)}),this.pop())},c.prototype.size=function(){throw"size() not implemented, see createCanvas()"},c}({},amdclean.core),amdclean.transform=function(a,b,c){"use strict";var d=b,c=c;return d.prototype.applyMatrix=function(a,b,c,d,e,f){return this.drawingContext.transform(a,b,c,d,e,f),this},d.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},d.prototype.printMatrix=function(){throw new Error("printMatrix() not implemented")},d.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},d.prototype.resetMatrix=function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this},d.prototype.rotate=function(a){return this._angleMode===c.DEGREES&&(a=this.radians(a)),this.drawingContext.rotate(a),this},d.prototype.rotateX=function(){throw"not yet implemented"},d.prototype.rotateY=function(){throw"not yet implemented"},d.prototype.scale=function(){var a=1,b=1;return 1===arguments.length?a=b=arguments[0]:(a=arguments[0],b=arguments[1]),this.drawingContext.scale(a,b),this},d.prototype.shearX=function(a){return this._angleMode===c.DEGREES&&(a=this.radians(a)),this.drawingContext.transform(1,0,this.tan(a),1,0,0),this},d.prototype.shearY=function(a){return this._angleMode===c.DEGREES&&(a=this.radians(a)),this.drawingContext.transform(1,this.tan(a),0,1,0,0),this},d.prototype.translate=function(a,b){return this.drawingContext.translate(a,b),this},d}({},amdclean.core,amdclean.constants,amdclean.outputtext_area),amdclean.typographyattributes=function(a,b,c){"use strict";var d=b,c=c;return d.prototype._textLeading=15,d.prototype._textFont="sans-serif",d.prototype._textSize=12,d.prototype._textStyle=c.NORMAL,d.prototype._textAscent=null,d.prototype._textDescent=null,d.prototype.textAlign=function(a,b){(a===c.LEFT||a===c.RIGHT||a===c.CENTER)&&(this.drawingContext.textAlign=a),(b===c.TOP||b===c.BOTTOM||b===c.CENTER||b===c.BASELINE)&&(this.drawingContext.textBaseline=b)},d.prototype.textLeading=function(a){this._setProperty("_textLeading",a)},d.prototype.textSize=function(a){this._setProperty("_textSize",a),this._setProperty("_textLeading",1.25*a),this._applyTextProperties()},d.prototype.textStyle=function(a){(a===c.NORMAL||a===c.ITALIC||a===c.BOLD)&&(this._setProperty("_textStyle",a),this._applyTextProperties())},d.prototype.textWidth=function(a){return this.drawingContext.measureText(a).width},d.prototype.textAscent=function(){return null==this._textAscent&&this._updateTextMetrics(),this._textAscent},d.prototype.textDescent=function(){return null==this._textDescent&&this._updateTextMetrics(),this._textDescent},d.prototype._applyTextProperties=function(){this._setProperty("_textAscent",null),this._setProperty("_textDescent",null);var a=this._textStyle+" "+this._textSize+"px "+this._textFont;this.drawingContext.font=a},d.prototype._updateTextMetrics=function(){var a=document.createElement("span");a.style.fontFamily=this._textFont,a.style.fontSize=this._textSize+"px",a.innerHTML="ABCjgq|";var b=document.createElement("div");b.style.display="inline-block",b.style.width="1px",b.style.height="0px";var c=document.createElement("div");c.appendChild(a),c.appendChild(b),c.style.height="0px",c.style.overflow="hidden",document.body.appendChild(c),b.style.verticalAlign="baseline";var d=this._calculateOffset(b),e=this._calculateOffset(a),f=d[1]-e[1];b.style.verticalAlign="bottom",d=this._calculateOffset(b),e=this._calculateOffset(a);var g=d[1]-e[1],h=g-f;document.body.removeChild(c),this._setProperty("_textAscent",f),this._setProperty("_textDescent",h)},d.prototype._calculateOffset=function(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}else b+=a.offsetLeft,c+=a.offsetTop;return[b,c]},d}({},amdclean.core,amdclean.constants),amdclean.typographyloading_displaying=function(a,b){"use strict";var c=b;return c.prototype.text=function(a,b,c,d,e){"string"!=typeof a&&(a=a.toString()),"undefined"!=typeof d&&(c+=this._textLeading,e+=c),a=a.replace(/(\t)/g,"  ");for(var f=a.split("\n"),g=0;g<f.length;g++){for(var h="",i=f[g].split(" "),j=0;j<i.length;j++)if(c+this._textLeading<=e||"undefined"==typeof e){var k=h+i[j]+" ",l=this.drawingContext.measureText(k),m=l.width;"undefined"!=typeof d&&m>d?(this._doFill&&this.drawingContext.fillText(h,b,c),this._doStroke&&this.drawingContext.strokeText(h,b,c),h=i[j]+" ",c+=this._textLeading):h=k}this._doFill&&this.drawingContext.fillText(h,b,c),this._doStroke&&this.drawingContext.strokeText(h,b,c),c+=this._textLeading}},c.prototype.textFont=function(a){this._setProperty("_textFont",a),this._applyTextProperties()},c}({},amdclean.core),amdclean.src_app=function(a,b){"use strict";var c=b,d=function(){window.PHANTOMJS||window.mocha||(window.setup&&"function"==typeof window.setup||window.draw&&"function"==typeof window.draw)&&new c};return"complete"===document.readyState?d():window.addEventListener("load",d,!1),c}({},amdclean.core,amdclean.p5Color,amdclean.p5Element,amdclean.p5Graphics,amdclean.p5Image,amdclean.p5File,amdclean.p5Vector,amdclean.p5TableRow,amdclean.p5Table,amdclean.colorcreating_reading,amdclean.colorsetting,amdclean.constants,amdclean.dataconversion,amdclean.dataarray_functions,amdclean.datastring_functions,amdclean.environment,amdclean.imageimage,amdclean.imageloading_displaying,amdclean.imagepixels,amdclean.inputfiles,amdclean.inputkeyboard,amdclean.inputmouse,amdclean.inputtime_date,amdclean.inputtouch,amdclean.mathmath,amdclean.mathcalculation,amdclean.mathrandom,amdclean.mathnoise,amdclean.mathtrigonometry,amdclean.outputfiles,amdclean.outputimage,amdclean.outputtext_area,amdclean.renderingrendering,amdclean.shape2d_primitives,amdclean.shapeattributes,amdclean.shapecurves,amdclean.shapevertex,amdclean.structure,amdclean.transform,amdclean.typographyattributes,amdclean.typographyloading_displaying),amdclean.src_app}),function(a,b){"function"==typeof define&&define.amd?define("p5.sound",["p5"],function(a){b(a)}):b("object"==typeof exports?require("../p5"):a.p5)}(this,function(a){var b;b=function(){"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext;var b=new window.AudioContext;a.prototype.getAudioContext=function(){return b},"function"!=typeof b.createGain&&(window.audioContext.createGain=window.audioContext.createGainNode),"function"!=typeof b.createDelay&&(window.audioContext.createDelay=window.audioContext.createDelayNode),"function"!=typeof window.AudioBufferSourceNode.prototype.start&&(window.AudioBufferSourceNode.prototype.start=window.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof window.AudioBufferSourceNode.prototype.stop&&(window.AudioBufferSourceNode.prototype.stop=window.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof window.OscillatorNode.prototype.start&&(window.OscillatorNode.prototype.start=window.OscillatorNode.prototype.noteOn),"function"!=typeof window.OscillatorNode.prototype.stop&&(window.OscillatorNode.prototype.stop=window.OscillatorNode.prototype.noteOff),window.AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createJavaScriptNode),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var c=document.createElement("audio");a.prototype.isSupported=function(){return!!c.canPlayType};var d=function(){return!!c.canPlayType&&c.canPlayType('audio/ogg; codecs="vorbis"')},e=function(){return!!c.canPlayType&&c.canPlayType("audio/mpeg;")},f=function(){return!!c.canPlayType&&c.canPlayType('audio/wav; codecs="1"')},g=function(){return!!c.canPlayType&&(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/aac;"))},h=function(){return!!c.canPlayType&&c.canPlayType("audio/x-aiff;")};a.prototype.isFileSupported=function(a){switch(a.toLowerCase()){case"mp3":return e();case"wav":return f();case"ogg":return d();case"mp4":return g();case"aiff":return h();default:return!1}};var i=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;i&&window.addEventListener("touchstart",function(){var a=b.createBuffer(1,1,22050),c=b.createBufferSource();c.buffer=a,c.connect(b.destination),c.start(0)},!1)}();var c;c=function(){"use strict";var b=function(){var b=a.prototype.getAudioContext();this.input=b.createGain(),this.output=b.createGain(),this.limiter=b.createDynamicsCompressor(),this.limiter.threshold.value=0,this.limiter.ratio.value=100,this.audiocontext=b,this.output.disconnect(this.audiocontext.destination),this.inputSources=[],this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=b.createGain(),this.output.connect(this.meter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},c=new b;return a.soundOut=c,a.soundOut._silentNode=c.audiocontext.createGain(),a.soundOut._silentNode.gain.value=0,a.soundOut._silentNode.connect(c.audiocontext.destination),c}(b);var d;d=function(){"use strict";var b=c;a.prototype.masterVolume=function(a){b.output.gain.value=a},a.prototype.sampleRate=function(){return b.audiocontext.sampleRate},a.prototype.getMasterVolume=function(){return b.output.gain.value},a.prototype.freqToMidi=function(a){var b=Math.log(a/440)/Math.log(2),c=Math.round(12*b)+57;

return c},a.prototype.midiToFreq=function(a){return 440*Math.pow(2,(a-69)/12)},a.prototype.soundFormats=function(){b.extensions=[];for(var a=0;a<arguments.length;a++){if(arguments[a]=arguments[a].toLowerCase(),!(["mp3","wav","ogg","m4a","aac"].indexOf(arguments[a])>-1))throw arguments[a]+" is not a valid sound format!";b.extensions.push(arguments[a])}},a.prototype.disposeSound=function(){for(var a=0;a<b.soundArray.length;a++)b.soundArray[a].dispose()},a.prototype.registerMethod("remove",a.prototype.disposeSound),a.prototype._checkFileFormats=function(c){var d;if("string"==typeof c){d=c;var e=d.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(e)>-1){var f=a.prototype.isFileSupported(e);if(f)d=d;else for(var g=d.split("."),h=g[g.length-1],i=0;i<b.extensions.length;i++){var j=b.extensions[i],f=a.prototype.isFileSupported(j);if(f){h="",2===g.length&&(h+=g[0]);for(var i=1;i<=g.length-2;i++){var k=g[i];h+="."+k}d=h+=".",d=d+=j;break}}}else for(var i=0;i<b.extensions.length;i++){var j=b.extensions[i],f=a.prototype.isFileSupported(j);if(f){d=d+"."+j;break}}}else if("object"==typeof c)for(var i=0;i<c.length;i++){var j=c[i].split(".").pop(),f=a.prototype.isFileSupported(j);if(f){d=c[i];break}}return d},a.prototype._mathChain=function(a,b,c,d,e){for(var f in a.mathOps)a.mathOps[f]instanceof e&&(a.mathOps[f].dispose(),c=f,c<a.mathOps.length-1&&(d=a.mathOps[f+1]));return a.mathOps[c-1].disconnect(),a.mathOps[c-1].connect(b),b.connect(d),a.mathOps[c]=b,a}}(c);var e;e=function(){"use strict";var b=c,d=b.audiocontext;a.Panner=function(a,b,c){this.input=d.createGain(),a.connect(this.input),this.left=d.createGain(),this.right=d.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",c>1?(this.splitter=d.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=d.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(b)},a.Panner.prototype.pan=function(a,b){var c=b||0,e=d.currentTime+c,f=(a+1)/2,g=Math.cos(f*Math.PI/2),h=Math.sin(f*Math.PI/2);this.left.gain.linearRampToValueAtTime(g,e),this.right.gain.linearRampToValueAtTime(h,e)},a.Panner.prototype.inputChannels=function(a){1===a?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2===a&&(this.splitter=d.createChannelSplitter(2),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))},a.Panner.prototype.connect=function(a){this.output.connect(a)},a.Panner.prototype.disconnect=function(){this.output.disconnect()},a.Panner3D=function(a,b){var c=d.createPanner();return c.panningModel="HRTF",c.distanceModel="linear",c.setPosition(0,0,0),a.connect(c),c.connect(b),c.pan=function(a,b,d){c.setPosition(a,b,d)},c}}(c);var f;f=function(){"use strict";var b=c;a.SoundFile=function(c,d,e){var f=a.prototype._checkFileFormats(c);this.url=f,this.sources=[],this.source=null,this.buffer=null,this.playbackRate=1,this.gain=1,this.input=b.audiocontext.createGain(),this.output=b.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.playing=!1,this.paused=null,this.mode="sustain",this.startMillis=null,this.amplitude=new a.Amplitude,this.output.connect(this.amplitude.input),this.panPosition=0,this.panner=new a.Panner(this.output,b.input,2),this.url&&this.load(d),b.soundArray.push(this),this.whileLoading="function"==typeof e?e:function(){}},a.prototype.registerPreloadMethod("loadSound"),a.prototype.loadSound=function(b,c,d){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var e=new a.SoundFile(b,c,d);return e},a.SoundFile.prototype.load=function(b){var c=this,d=new XMLHttpRequest;d.addEventListener("progress",function(a){c._updateProgress(a)},!1),d.open("GET",this.url,!0),d.responseType="arraybuffer";var e=this;d.onload=function(){var c=a.prototype.getAudioContext();c.decodeAudioData(d.response,function(a){e.buffer=a,e.panner.inputChannels(a.numberOfChannels),b&&b(e)})},d.send()},a.SoundFile.prototype._updateProgress=function(a){if(a.lengthComputable){var b=Math.log(a.loaded/a.total*9.9);this.whileLoading(b)}else console.log("size unknown")},a.SoundFile.prototype.isLoaded=function(){return this.buffer?!0:!1},a.SoundFile.prototype.play=function(a,c,d,e,f){var g=b.audiocontext.currentTime,a=a||0;if(0>a&&(a=0),!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if("restart"===this.mode&&this.buffer&&this.source){var g=b.audiocontext.currentTime;this.source.stop(a)}if(e){if(!(e>=0&&e<this.buffer.duration))throw"start time out of range";this.startTime=e}if(f){if(!(f>=0&&f<=this.buffer.duration))throw"end time out of range";this.endTime=f}else this.endTime=this.buffer.duration;if(this.source=b.audiocontext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=this.looping,this.source.loop===!0&&(this.source.loopStart=this.startTime,this.source.loopEnd=this.endTime),this.source.onended=function(){},this.source.gain)this.source.gain.value=d||1,this.source.connect(this.output);else{this.source.gain=b.audiocontext.createGain(),this.source.connect(this.source.gain);var h=d||1;this.source.gain.gain.setValueAtTime(h,b.audiocontext.currentTime),this.source.gain.connect(this.output)}this.source.playbackRate.cancelScheduledValues(g),c=c||Math.abs(this.playbackRate),this.source.playbackRate.setValueAtTime(c,g),this.paused&&(this.wasUnpaused=!0),this.paused&&this.wasUnpaused?this.source.start(a,this.pauseTime,this.endTime):(this.wasUnpaused=!1,this.pauseTime=0,this.source.start(a,this.startTime,this.endTime)),this.startSeconds=a+g,this.playing=!0,this.paused=!1,this.sources.push(this.source)},a.SoundFile.prototype.playMode=function(a){var c=a.toLowerCase();if("restart"===c&&this.buffer&&this.source)for(var d=0;d<this.sources.length-1;d++){var e=b.audiocontext.currentTime;this.sources[d].stop(e)}if("restart"!==c&&"sustain"!==c)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=c},a.SoundFile.prototype.pause=function(a){{var c=b.audiocontext.currentTime,a=a||0,d=a+c;this.looping}this.isPlaying()&&this.buffer&&this.source&&(this.pauseTime=this.currentTime(),this.source.stop(d),this.paused=!0,this.wasUnpaused=!1,this.playing=!1)},a.SoundFile.prototype.loop=function(a,b,c,d){this.looping=!0,this.play(a,b,c,d)},a.SoundFile.prototype.setLoop=function(a){if(a===!0)this.looping=!0;else{if(a!==!1)throw"Error: setLoop accepts either true or false";this.looping=!1}this.source&&(this.source.loop=this.looping)},a.SoundFile.prototype.isLooping=function(){return this.source&&this.looping===!0&&this.isPlaying()===!0?!0:!1},a.SoundFile.prototype.isPlaying=function(){return null!==this.playing?this.playing:!1},a.SoundFile.prototype.isPaused=function(){return this.paused?this.paused:!1},a.SoundFile.prototype.stop=function(a){if("sustain"==this.mode)this.stopAll(),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1;else if(this.buffer&&this.source){var c=b.audiocontext.currentTime,d=a||0;this.source.stop(c+d),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1}},a.SoundFile.prototype.stopAll=function(){if(this.buffer&&this.source)for(var a=0;a<this.sources.length;a++)if(null!==this.sources[a]){var c=b.audiocontext.currentTime;this.sources[a].stop(c)}},a.SoundFile.prototype.setVolume=function(a,c,d){if("number"==typeof a){var c=c||0,d=d||0,e=b.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e+d),this.output.gain.linearRampToValueAtTime(f,e+d),this.output.gain.linearRampToValueAtTime(a,e+d+c)}else{if(!a)return this.output.gain;a.connect(this.output.gain)}},a.SoundFile.prototype.amp=a.SoundFile.prototype.setVolume,a.SoundFile.prototype.fade=a.SoundFile.prototype.setVolume,a.SoundFile.prototype.getVolume=function(){return this.output.gain.value},a.SoundFile.prototype.pan=function(a,b){this.panPosition=a,this.panner.pan(a,b)},a.SoundFile.prototype.getPan=function(){return this.panPosition},a.SoundFile.prototype.rate=function(a){if(this.playbackRate!==a||!this.source||this.source.playbackRate.value!==a){this.playbackRate=a;var c=a;if(0===this.playbackRate&&this.playing&&this.pause(),this.playbackRate<0&&!this.reversed){{var d=this.currentTime();this.source.playbackRate.value}this.reverseBuffer(),c=Math.abs(a);var e=(d-this.duration())/c;this.pauseTime=e}else this.playbackRate>0&&this.reversed&&this.reverseBuffer();if(this.source){var f=b.audiocontext.currentTime;this.source.playbackRate.cancelScheduledValues(f),this.source.playbackRate.linearRampToValueAtTime(Math.abs(c),f)}}},a.SoundFile.prototype.getPlaybackRate=function(){return this.playbackRate},a.SoundFile.prototype.duration=function(){return this.buffer?this.buffer.duration:0},a.SoundFile.prototype.currentTime=function(){var a;if(this.isPlaying()){var c=b.audiocontext.currentTime-this.startSeconds+this.startTime+this.pauseTime;return a=c*this.playbackRate%(this.duration()*this.playbackRate),console.log("1"),a}return this.paused?this.pauseTime:this.startTime},a.SoundFile.prototype.jump=function(a,c){if(0>a||a>this.buffer.duration)throw"jump time out of range";if(a>c||c>this.buffer.duration)throw"end time out of range";if(this.startTime=a||0,this.endTime=c?c:this.buffer.duration,this.isPlaying()){var d=b.audiocontext.currentTime;this.stop(d),this.play(a,this.endTime)}},a.SoundFile.prototype.channels=function(){return this.buffer.numberOfChannels},a.SoundFile.prototype.sampleRate=function(){return this.buffer.sampleRate},a.SoundFile.prototype.frames=function(){return this.buffer.length},a.SoundFile.prototype.getPeaks=function(a){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(a||(a=5*window.width),this.buffer){for(var b=this.buffer,c=b.length/a,d=~~(c/10)||1,e=b.numberOfChannels,f=new Float32Array(Math.round(a)),g=0;e>g;g++)for(var h=b.getChannelData(g),i=0;a>i;i++){for(var j=~~(i*c),k=~~(j+c),l=0,m=j;k>m;m+=d){var n=h[m];n>l?l=n:-n>l&&(l=n)}(0===g||l>f[i])&&(f[i]=l)}return f}},a.SoundFile.prototype.reverseBuffer=function(){var a=this.getVolume();if(this.setVolume(0,.01,0),this.pause(),!this.buffer)throw"SoundFile is not done loading";Array.prototype.reverse.call(this.buffer.getChannelData(0)),Array.prototype.reverse.call(this.buffer.getChannelData(1)),this.reversed=!this.reversed,this.setVolume(a,.01,.0101),this.play()},a.SoundFile.prototype._onEnded=function(a){a.onended=function(a){var c=b.audiocontext.currentTime;a.stop(c)}},a.SoundFile.prototype.add=function(){},a.SoundFile.prototype.dispose=function(){if(this.buffer&&this.source)for(var a=0;a<this.sources.length-1;a++)if(null!==this.sources[a]){var c=b.audiocontext.currentTime;this.sources[a].stop(c),this.sources[a]=null}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)},a.SoundFile.prototype.connect=function(a){this.panner.connect(a?a.hasOwnProperty("input")?a.input:a:b.input)},a.SoundFile.prototype.disconnect=function(a){this.panner.disconnect(a)},a.SoundFile.prototype.getLevel=function(a){return a&&(this.amplitude.smoothing=a),this.amplitude.getLevel()},a.SoundFile.prototype.setPath=function(b,c){var d=a.prototype._checkFileFormats(b);this.url=d,this.load(c)},a.SoundFile.prototype.setBuffer=function(a){for(var c=b.audiocontext,d=c.createBuffer(2,a[0].length,c.sampleRate),e=0,f=0;f<a.length;f++){var g=d.getChannelData(f);g.set(a[f]),e++}this.buffer=d,this.panner.inputChannels(e)}}(b,c);var g;g=function(){"use strict";var b=c;a.Amplitude=function(a){this.bufferSize=2048,this.audiocontext=b.audiocontext,this.processor=this.audiocontext.createScriptProcessor(this.bufferSize),this.input=this.processor,this.output=this.audiocontext.createGain(),this.smoothing=a||0,this.volume=0,this.average=0,this.volMax=.001,this.normalize=!1,this.processor.onaudioprocess=this.volumeAudioProcess.bind(this),this.processor.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),b.meter.connect(this.processor)},a.Amplitude.prototype.setInput=function(c,d){b.meter.disconnect(this.processor),d&&(this.smoothing=d),null==c?(console.log("Amplitude input source is not ready! Connecting to master output instead"),b.meter.connect(this.processor)):c instanceof a.Signal?c.output.connect(this.processor):c?(c.connect(this.processor),this.processor.disconnect(),this.processor.connect(this.output)):b.meter.connect(this.processor)},a.Amplitude.prototype.connect=function(a){this.output.connect(a?a.hasOwnProperty("input")?a.input:a:this.panner.connect(b.input))},a.Amplitude.prototype.disconnect=function(){this.output.disconnect()},a.Amplitude.prototype.volumeAudioProcess=function(a){for(var b,c=a.inputBuffer.getChannelData(0),d=c.length,e=0,f=0,g=0;d>g;g++)b=c[g],this.normalize?(e+=Math.max(Math.min(b/this.volMax,1),-1),f+=Math.max(Math.min(b/this.volMax,1),-1)*Math.max(Math.min(b/this.volMax,1),-1)):(e+=b,f+=b*b);var h=Math.sqrt(f/d);this.volume=Math.max(h,this.volume*this.smoothing),this.volMax=Math.max(this.volume,this.volMax),this.volNorm=Math.max(Math.min(this.volume/this.volMax,1),0)},a.Amplitude.prototype.getLevel=function(){return this.normalize?this.volNorm:this.volume},a.Amplitude.prototype.toggleNormalize=function(a){this.normalize="boolean"==typeof a?a:!this.normalize},a.Amplitude.prototype.smooth=function(a){a>=0&&1>a?this.smoothing=a:console.log("Error: smoothing must be between 0 and 1")}}(c);var h;h=function(){"use strict";var b=c;a.FFT=function(a,c){var d=a||.8;0===a&&(d=a);var e=2*c||2048;this.analyser=b.audiocontext.createAnalyser(),b.output.connect(this.analyser),this.analyser.smoothingTimeConstant=d,this.analyser.fftSize=e,this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3]},a.FFT.prototype.setInput=function(a,b){b&&(this.analyser.fftSize=2*b),a.output?a.output.connect(this.analyser):a.connect(this.analyser)},a.FFT.prototype.waveform=function(a){a&&(this.analyser.fftSize=2*a),this.analyser.getByteTimeDomainData(this.timeDomain);var b=Array.apply([],this.timeDomain);return b.length===this.analyser.fftSize,b.constructor===Array,b},a.FFT.prototype.analyze=function(a){a&&(this.analyser.fftSize=2*a),this.analyser.getByteFrequencyData(this.freqDomain);var b=Array.apply([],this.freqDomain);return b.length===this.analyser.fftSize,b.constructor===Array,b},a.FFT.prototype.getEnergy=function(a,c){var d=b.audiocontext.sampleRate/2;if("bass"===a?(a=this.bass[0],c=this.bass[1]):"lowMid"===a?(a=this.lowMid[0],c=this.lowMid[1]):"mid"===a?(a=this.mid[0],c=this.mid[1]):"highMid"===a?(a=this.highMid[0],c=this.highMid[1]):"treble"===a&&(a=this.treble[0],c=this.treble[1]),"number"!=typeof a)throw"invalid input for getEnergy()";if(c){if(a&&c){if(a>c){var e=c;c=a,a=e}for(var f=Math.round(a/d*this.freqDomain.length),g=Math.round(c/d*this.freqDomain.length),h=0,i=0,j=f;g>=j;j++)h+=this.freqDomain[j],i+=1;var k=h/i;return k}throw"invalid input for getEnergy()"}var l=Math.round(a/d*this.freqDomain.length);return this.freqDomain[l]},a.FFT.prototype.getFreq=function(a,b){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var c=this.getEnergy(a,b);return c},a.FFT.prototype.smooth=function(a){this.analyser.smoothingTimeConstant=a}}(c);var i;i=function(){"use strict";function a(a){return void 0===a}var b;if(a(window.AudioContext)&&(window.AudioContext=window.webkitAudioContext),a(window.OfflineAudioContext)&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),a(AudioContext))throw new Error("Web Audio is not supported in this browser");b=new AudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),"function"!=typeof AudioBufferSourceNode.prototype.start&&(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof AudioBufferSourceNode.prototype.stop&&(AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.start&&(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn),"function"!=typeof OscillatorNode.prototype.stop&&(OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.setPeriodicWave&&(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioNode.prototype._nativeConnect=AudioNode.prototype.connect,AudioNode.prototype.connect=function(b,c,d){if(b.input)Array.isArray(b.input)?(a(d)&&(d=0),this.connect(b.input[d])):this.connect(b.input,c,d);else try{b instanceof AudioNode?this._nativeConnect(b,c,d):this._nativeConnect(b,c)}catch(e){throw new Error("error connecting to node: "+b)}};var c=function(b,c){a(b)||1===b?this.input=this.context.createGain():b>1&&(this.input=new Array(b)),a(c)||1===c?this.output=this.context.createGain():c>1&&(this.output=new Array(b))};c.context=b,c.prototype.context=c.context,c.prototype.bufferSize=2048,c.prototype.bufferTime=c.prototype.bufferSize/c.context.sampleRate,c.prototype.connect=function(a,b,c){Array.isArray(this.output)?(b=this.defaultArg(b,0),this.output[b].connect(a,0,c)):this.output.connect(a,b,c)},c.prototype.disconnect=function(a){Array.isArray(this.output)?(a=this.defaultArg(a,0),this.output[a].disconnect()):this.output.disconnect()},c.prototype.connectSeries=function(){if(arguments.length>1)for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}},c.prototype.connectParallel=function(){var a=arguments[0];if(arguments.length>1)for(var b=1;b<arguments.length;b++){var c=arguments[b];a.connect(c)}},c.prototype.chain=function(){if(arguments.length>0)for(var a=this,b=0;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}},c.prototype.fan=function(){if(arguments.length>0)for(var a=1;a<arguments.length;a++)this.connect(arguments[a])},AudioNode.prototype.chain=c.prototype.chain,AudioNode.prototype.fan=c.prototype.fan,c.prototype.defaultArg=function(b,c){if("object"==typeof b&&"object"==typeof c){var d={};for(var e in b)d[e]=this.defaultArg(b[e],b[e]);for(var f in c)d[f]=this.defaultArg(b[f],c[f]);return d}return a(b)?c:b},c.prototype.optionsObject=function(a,b,c){var d={};if(1===a.length&&"object"==typeof a[0])d=a[0];else for(var e=0;e<b.length;e++)d[b[e]]=a[e];return this.isUndef(c)?d:this.defaultArg(d,c)},c.prototype.isUndef=a,c.prototype.equalPowerScale=function(a){var b=.5*Math.PI;return Math.sin(a*b)},c.prototype.logScale=function(a){return Math.max(this.normalize(this.gainToDb(a),-100,0),0)},c.prototype.expScale=function(a){return this.dbToGain(this.interpolate(a,-100,0))},c.prototype.dbToGain=function(a){return Math.pow(2,a/6)},c.prototype.gainToDb=function(a){return 20*(Math.log(a)/Math.LN10)},c.prototype.interpolate=function(a,b,c){return a*(c-b)+b},c.prototype.normalize=function(a,b,c){if(b>c){var d=c;c=b,b=d}else if(b==c)return 0;return(a-b)/(c-b)},c.prototype.dispose=function(){this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null)};var d=null;c.prototype.noGC=function(){this.output.connect(d)},AudioNode.prototype.noGC=function(){this.connect(d)},c.prototype.now=function(){return this.context.currentTime},c.prototype.samplesToSeconds=function(a){return a/this.context.sampleRate},c.prototype.toSamples=function(a){var b=this.toSeconds(a);return Math.round(b*this.context.sampleRate)},c.prototype.toSeconds=function(a,b){if(b=this.defaultArg(b,this.now()),"number"==typeof a)return a;if("string"==typeof a){var c=0;return"+"===a.charAt(0)&&(a=a.slice(1),c=b),parseFloat(a)+c}return b},c.prototype.frequencyToSeconds=function(a){return 1/parseFloat(a)},c.prototype.secondsToFrequency=function(a){return 1/a};var e=[];return c._initAudioContext=function(a){a(c.context),e.push(a)},c.setContext=function(a){c.prototype.context=a,c.context=a;for(var b=0;b<e.length;b++)e[b](a)},c.extend=function(b,d){function e(){}a(d)&&(d=c),e.prototype=d.prototype,b.prototype=new e,b.prototype.constructor=b},c.startMobile=function(){var a=c.context.createOscillator(),b=c.context.createGain();b.gain.value=0,a.connect(b),b.connect(c.context.destination);var d=c.context.currentTime;a.start(d),a.stop(d+1)},c._initAudioContext(function(a){c.prototype.bufferTime=c.prototype.bufferSize/a.sampleRate,d=a.createGain(),d.gain.value=0,d.connect(a.destination)}),c}();var j;j=function(a){"use strict";return a.SignalBase=function(){},a.extend(a.SignalBase),a.SignalBase.prototype.connect=function(b,c,d){b instanceof a.Signal?b.setValue(0):b instanceof AudioParam&&(b.value=0),a.prototype.connect.call(this,b,c,d)},a.SignalBase.prototype.dispose=function(){a.prototype.dispose.call(this)},a.SignalBase}(i);var k;k=function(a){"use strict";return a.WaveShaper=function(a,b){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(a)?this.setCurve(a):isFinite(a)||this.isUndef(a)?this._curve=new Float32Array(this.defaultArg(a,1024)):"function"==typeof a&&(this._curve=new Float32Array(this.defaultArg(b,1024)),this.setMap(a))},a.extend(a.WaveShaper,a.SignalBase),a.WaveShaper.prototype.setMap=function(a){for(var b=0,c=this._curve.length;c>b;b++){var d=b/c*2-1,e=b/(c-1)*2-1;this._curve[b]=a(d,b,e)}this._shaper.curve=this._curve},a.WaveShaper.prototype.setCurve=function(a){if(this._isSafari()){var b=a[0];a.unshift(b)}this._curve=new Float32Array(a),this._shaper.curve=this._curve},a.WaveShaper.prototype.setOversample=function(a){this._shaper.oversample=a},a.WaveShaper.prototype._isSafari=function(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")},a.WaveShaper.prototype.dispose=function(){a.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null},a.WaveShaper}(i);var l;l=function(a){"use strict";return a.Signal=function(b){this._scalar=this.context.createGain(),this.input=this.output=this.context.createGain(),this._syncRatio=1,this.value=this.defaultArg(b,0),a.Signal._constant.chain(this._scalar,this.output)},a.extend(a.Signal,a.SignalBase),a.Signal.prototype.getValue=function(){return this._scalar.gain.value},a.Signal.prototype.setValue=function(a){0===this._syncRatio?a=0:a*=this._syncRatio,this._scalar.gain.value=a},a.Signal.prototype.setValueAtTime=function(a,b){a*=this._syncRatio,this._scalar.gain.setValueAtTime(a,this.toSeconds(b))},a.Signal.prototype.setCurrentValueNow=function(a){a=this.defaultArg(a,this.now());var b=this.getValue();return this.cancelScheduledValues(a),this._scalar.gain.setValueAtTime(b,a),b},a.Signal.prototype.linearRampToValueAtTime=function(a,b){a*=this._syncRatio,this._scalar.gain.linearRampToValueAtTime(a,this.toSeconds(b))},a.Signal.prototype.exponentialRampToValueAtTime=function(a,b){a*=this._syncRatio;try{this._scalar.gain.exponentialRampToValueAtTime(a,this.toSeconds(b))}catch(c){this._scalar.gain.linearRampToValueAtTime(a,this.toSeconds(b))}},a.Signal.prototype.exponentialRampToValueNow=function(a,b){var c=this.now();this.setCurrentValueNow(c),"+"===b.toString().charAt(0)&&(b=b.substr(1)),this.exponentialRampToValueAtTime(a,c+this.toSeconds(b))},a.Signal.prototype.linearRampToValueNow=function(a,b){var c=this.now();this.setCurrentValueNow(c),a*=this._syncRatio,"+"===b.toString().charAt(0)&&(b=b.substr(1)),this._scalar.gain.linearRampToValueAtTime(a,c+this.toSeconds(b))},a.Signal.prototype.setTargetAtTime=function(a,b,c){a*=this._syncRatio,this._scalar.gain.setTargetAtTime(a,this.toSeconds(b),c)},a.Signal.prototype.setValueCurveAtTime=function(a,b,c){for(var d=0;d<a.length;d++)a[d]*=this._syncRatio;this._scalar.gain.setValueCurveAtTime(a,this.toSeconds(b),this.toSeconds(c))},a.Signal.prototype.cancelScheduledValues=function(a){this._scalar.gain.cancelScheduledValues(this.toSeconds(a))},a.Signal.prototype.sync=function(a,b){this._syncRatio=b?b:0!==a.getValue()?this.getValue()/a.getValue():0,this._scalar.disconnect(),this._scalar=this.context.createGain(),this.connectSeries(a,this._scalar,this.output),this._scalar.gain.value=this._syncRatio},a.Signal.prototype.unsync=function(){var b=this.getValue();this._scalar.disconnect(),this._scalar=this.context.createGain(),this._scalar.gain.value=b/this._syncRatio,this._syncRatio=1,a.Signal._constant.chain(this._scalar,this.output)},a.Signal.prototype.dispose=function(){a.prototype.dispose.call(this),this._scalar.disconnect(),this._scalar=null},Object.defineProperty(a.Signal.prototype,"value",{get:function(){return this.getValue()},set:function(a){this.setValue(a)}}),a.Signal._generator=null,a.Signal._constant=null,a._initAudioContext(function(b){a.Signal._generator=b.createOscillator(),a.Signal._constant=new a.WaveShaper([1,1]),a.Signal._generator.connect(a.Signal._constant),a.Signal._generator.start(0),a.Signal._generator.noGC()}),a.Signal}(i);var m;m=function(a){"use strict";return a.Add=function(b){a.call(this,2,0),this._sum=this.input[0]=this.input[1]=this.output=this.context.createGain(),this._value=null,isFinite(b)&&(this._value=new a.Signal(b),this._value.connect(this._sum))},a.extend(a.Add,a.SignalBase),a.Add.prototype.setValue=function(a){if(null===this._value)throw new Error("cannot switch from signal to number");this._value.setValue(a)},a.Add.prototype.dispose=function(){a.prototype.dispose.call(this),this._sum=null,this._value&&(this._value.dispose(),this._value=null)},a.Add}(i);var n;n=function(a){"use strict";return a.Multiply=function(b){a.call(this,2,0),this._mult=this.input[0]=this.output=this.context.createGain(),this._factor=this.input[1]=this.output.gain,this._factor.value=this.defaultArg(b,0)},a.extend(a.Multiply,a.SignalBase),a.Multiply.prototype.setValue=function(a){this._factor.value=a},a.Multiply.prototype.dispose=function(){a.prototype.dispose.call(this),this._mult=null,this._factor=null},a.Multiply}(i);var o;o=function(a){"use strict";return a.Scale=function(b,c){this._outputMin=this.defaultArg(b,0),this._outputMax=this.defaultArg(c,1),this._scale=this.input=new a.Multiply(1),this._add=this.output=new a.Add(0),this._scale.connect(this._add),this._setRange()},a.extend(a.Scale,a.SignalBase),a.Scale.prototype.setMin=function(a){this._outputMin=a,this._setRange()},a.Scale.prototype.setMax=function(a){this._outputMax=a,this._setRange()},a.Scale.prototype._setRange=function(){this._add.setValue(this._outputMin),this._scale.setValue(this._outputMax-this._outputMin)},a.Scale.prototype.dispose=function(){a.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null},a.Scale}(i,m,n);var p;p=function(){"use strict";var b=l,d=m,e=n,f=o,g=i,h=c;g.setContext(h.audiocontext),a.Signal=function(a){var c=new b(a);return c},b.prototype.fade=b.prototype.linearRampToValueAtTime,e.prototype.fade=b.prototype.fade,d.prototype.fade=b.prototype.fade,f.prototype.fade=b.prototype.fade,b.prototype.setInput=function(a){a.connect(this)},e.prototype.setInput=b.prototype.setInput,d.prototype.setInput=b.prototype.setInput,f.prototype.setInput=b.prototype.setInput,b.prototype.add=function(a){var b=new d(a);return this.connect(b),b},e.prototype.add=b.prototype.add,d.prototype.add=b.prototype.add,f.prototype.add=b.prototype.add,b.prototype.mult=function(a){var b=new e(a);return this.connect(b),b},e.prototype.mult=b.prototype.mult,d.prototype.mult=b.prototype.mult,f.prototype.mult=b.prototype.mult,b.prototype.scale=function(b,c,d,e){var g,h;4===arguments.length?(g=a.prototype.map(d,b,c,0,1)-.5,h=a.prototype.map(e,b,c,0,1)-.5):(g=arguments[0],h=arguments[1]);var i=new f(g,h);return this.connect(i),i},e.prototype.scale=b.prototype.scale,d.prototype.scale=b.prototype.scale,f.prototype.scale=b.prototype.scale}(l,m,n,o,i,c);var q;q=function(){"use strict";var b=c,d=m,e=n,f=o;a.Oscillator=function(c,d){if("string"==typeof c){var e=d;d=c,c=e}if("number"==typeof d){var e=d;d=c,c=e}this.started=!1,this.oscillator=b.audiocontext.createOscillator(),this.f=c||440,this.oscillator.frequency.setValueAtTime(this.f,b.audiocontext.currentTime),this.oscillator.type=d||"sine";this.oscillator;this.input=b.audiocontext.createGain(),this.output=b.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,b.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=b.input,this.panner=new a.Panner(this.output,this.connection,1),this.mathOps=[this.output],b.soundArray.push(this)},a.Oscillator.prototype.start=function(a,c){if(this.started){var d=b.audiocontext.currentTime;this.stop(d)}if(!this.started){var e=c||this.f,f=this.oscillator.type;this.oscillator=b.audiocontext.createOscillator(),this.oscillator.frequency.exponentialRampToValueAtTime(Math.abs(e),b.audiocontext.currentTime),this.oscillator.type=f,this.oscillator.connect(this.output),a=a||0,this.oscillator.start(a+b.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(var g in this._freqMods)"undefined"!=typeof this._freqMods[g].connect&&this._freqMods[g].connect(this.oscillator.frequency);this.started=!0}},a.Oscillator.prototype.stop=function(a){if(this.started){var c=a||0,d=b.audiocontext.currentTime;this.oscillator.stop(c+d),this.started=!1}},a.Oscillator.prototype.amp=function(a,c,d){var e=this;if("number"==typeof a){var c=c||0,d=d||0,f=b.audiocontext.currentTime,g=this.output.gain.value;this.output.gain.cancelScheduledValues(f),this.output.gain.linearRampToValueAtTime(g,f+d),this.output.gain.linearRampToValueAtTime(a,f+d+c)}else{if(!a)return this.output.gain;console.log(a),a.connect(e.output.gain)}},a.Oscillator.prototype.fade=a.Oscillator.prototype.amp,a.Oscillator.prototype.getAmp=function(){return this.output.gain.value},a.Oscillator.prototype.freq=function(a,c,d){if("number"!=typeof a||isNaN(a)){if(!a)return this.oscillator.frequency;a.output&&(a=a.output),a.connect(this.oscillator.frequency),this._freqMods.push(a)}else{this.f=a;var e=b.audiocontext.currentTime,c=c||0,d=d||0,f=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(e),this.oscillator.frequency.setValueAtTime(f,e+d),a>0?this.oscillator.frequency.exponentialRampToValueAtTime(a,d+c+e):this.oscillator.frequency.linearRampToValueAtTime(a,d+c+e)}},a.Oscillator.prototype.getFreq=function(){return this.oscillator.frequency.value},a.Oscillator.prototype.setType=function(a){this.oscillator.type=a},a.Oscillator.prototype.getType=function(){return this.oscillator.type},a.Oscillator.prototype.connect=function(a){a?a.hasOwnProperty("input")?(this.panner.connect(a.input),this.connection=a.input):(this.panner.connect(a),this.connection=a):this.panner.connect(b.input)},a.Oscillator.prototype.disconnect=function(){this.output.disconnect(),this.panner.disconnect(),this.output.connect(this.panner),this.oscMods=[]},a.Oscillator.prototype.pan=function(a,b){this.panPosition=a,this.panner.pan(a,b)},a.Oscillator.prototype.getPan=function(){return this.panPosition},a.Oscillator.prototype.dispose=function(){if(this.oscillator){var a=b.audiocontext.currentTime;this.stop(a),this.disconnect(),this.oscillator.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()},a.Oscillator.prototype.phase=function(c){this.dNode||(this.dNode=b.audiocontext.createDelay(),this.output.disconnect(),this.output.connect(this.dNode),this.dNode.connect(this.panner));

var d=b.audiocontext.currentTime;this.dNode.delayTime.linearRampToValueAtTime(a.prototype.map(c,0,1,0,1/this.oscillator.frequency.value),d)};var g=function(a,b,c,d,e){var f=a.oscillator;for(var g in a.mathOps)a.mathOps[g]instanceof e&&(f.disconnect(),a.mathOps[g].dispose(),c=g,c<a.mathOps.length-2&&(d=a.mathOps[g+1]));return c==a.mathOps.length-1&&a.mathOps.push(d),g>0&&(f=a.mathOps[g-1]),f.disconnect(),f.connect(b),b.connect(d),a.mathOps[c]=b,a};a.Oscillator.prototype.add=function(a){var b=new d(a),c=this.mathOps.length-1,e=this.output;return g(this,b,c,e,d)},a.Oscillator.prototype.mult=function(a){var b=new e(a),c=this.mathOps.length-1,d=this.output;return g(this,b,c,d,e)},a.Oscillator.prototype.scale=function(b,c,d,e){var h,i;4===arguments.length?(h=a.prototype.map(d,b,c,0,1)-.5,i=a.prototype.map(e,b,c,0,1)-.5):(h=arguments[0],i=arguments[1]);var j=new f(h,i),k=this.mathOps.length-1,l=this.output;return g(this,j,k,l,f)},a.SinOsc=function(b){a.Oscillator.call(this,b,"sine")},a.SinOsc.prototype=Object.create(a.Oscillator.prototype),a.TriOsc=function(b){a.Oscillator.call(this,b,"triangle")},a.TriOsc.prototype=Object.create(a.Oscillator.prototype),a.SawOsc=function(b){a.Oscillator.call(this,b,"sawtooth")},a.SawOsc.prototype=Object.create(a.Oscillator.prototype),a.SqrOsc=function(b){a.Oscillator.call(this,b,"square")},a.SqrOsc.prototype=Object.create(a.Oscillator.prototype)}(c,l,m,n,o);var r;r=function(){"use strict";var b=c,d=m,e=n,f=o,g=i;g.setContext(b.audiocontext);var h=null;a.Env=function(c,d,e,f,g,h,i,j){this.aTime=c,this.aLevel=d,this.dTime=e||0,this.dLevel=f||0,this.sTime=g||0,this.sLevel=h||0,this.rTime=i||0,this.rLevel=j||0,this.output=b.audiocontext.createGain(),this.control=new a.Signal,this.control.connect(this.output),this.timeoutID=null,this.connection=null,this.mathOps=[this.control],b.soundArray.push(this)},a.Env.prototype.set=function(a,b,c,d,e,f,g,h){this.aTime=a,this.aLevel=b,this.dTime=c||0,this.dLevel=d||0,this.sTime=e||0,this.sLevel=f||0,this.rTime=g||0,this.rLevel=h||0},a.Env.prototype.setInput=function(a){this.connect(a)},a.Env.prototype.ctrl=function(a){this.connect(a)},a.Env.prototype.play=function(a,c){var d=b.audiocontext.currentTime,e=c||0,f=d+e+1e-4;"number"==typeof this.timeoutID&&window.clearTimeout(this.timeoutID),a&&this.connection!==a&&this.connect(a),this.control.cancelScheduledValues(f-1e-4),this.control.linearRampToValueAtTime(0,f-5e-5),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,f+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,f+this.aTime+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,f+this.aTime+this.dTime+this.sTime+this.rTime);f+this.aTime+this.dTime+this.sTime+this.rTime},a.Env.prototype.triggerAttack=function(a,c){var d=b.audiocontext.currentTime,e=c||0,f=d+e+1e-4;this.lastAttack=f,"number"==typeof this.timeoutID&&window.clearTimeout(this.timeoutID);var g=this.control.getValue();this.control.cancelScheduledValues(f-1e-4),this.control.linearRampToValueAtTime(g,f-5e-5),a&&this.connection!==a&&this.connect(a),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,f+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,f+this.aTime+this.dTime+this.sTime)},a.Env.prototype.triggerRelease=function(a,c){var d,e=b.audiocontext.currentTime,f=c||0,g=e+f+1e-5;if(a&&this.connection!==a&&this.connect(a),this.control.cancelScheduledValues(g-1e-5),e-this.lastAttack<this.aTime){var i=this.aTime-(g-this.lastAttack);this.control.linearRampToValueAtTime(this.aLevel,g+i),this.control.linearRampToValueAtTime(this.dLevel,g+i+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,g+i+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,g+i+this.dTime+this.sTime+this.rTime),d=g+this.dTime+this.sTime+this.rTime}else if(e-this.lastAttack<this.aTime+this.dTime){var j=this.aTime+this.dTime-(e-this.lastAttack);this.control.linearRampToValueAtTime(this.dLevel,g+j),this.control.linearRampToValueAtTime(this.sLevel,g+j+.01),this.control.linearRampToValueAtTime(this.rLevel,g+j+.01+this.rTime),d=g+this.sTime+this.rTime}else if(e-this.lastAttack<this.aTime+this.dTime+this.sTime){var k=this.aTime+this.dTime+this.sTime-(e-this.lastAttack);this.control.linearRampToValueAtTime(this.sLevel,g+k),this.control.linearRampToValueAtTime(this.rLevel,g+k+this.rTime),d=g+this.rTime}else this.control.linearRampToValueAtTime(this.sLevel,g),this.control.linearRampToValueAtTime(this.rLevel,g+this.rTime),d=g+this.dTime+this.sTime+this.rTime;var l=g+this.aTime+this.dTime+this.sTime+this.rTime;this.connection&&this.connection.hasOwnProperty("oscillator")?(h=this.connection.oscillator,h.stop(l+.01)):this.connect&&this.connection.hasOwnProperty("source")&&(h=this.connection.source,h.stop(l+.01))},a.Env.prototype.connect=function(c){this.disconnect(),this.connection=c,(c instanceof a.Oscillator||c instanceof a.SoundFile||c instanceof a.AudioIn||c instanceof a.Reverb||c instanceof a.Noise||c instanceof a.Filter||c instanceof a.Delay)&&(c=c.output.gain),c instanceof AudioParam&&c.setValueAtTime(0,b.audiocontext.currentTime),c instanceof a.Signal&&c.setValue(0),this.output.connect(c)},a.Env.prototype.disconnect=function(){this.output.disconnect()},a.Env.prototype.add=function(b){var c=new d(b),e=this.mathOps.length,f=this.output;return a.prototype._mathChain(this,c,e,f,d)},a.Env.prototype.mult=function(b){var c=new e(b),d=this.mathOps.length,f=this.output;return a.prototype._mathChain(this,c,d,f,e)},a.Env.prototype.scale=function(b,c,d,e){var g=new f(b,c,d,e),h=this.mathOps.length,i=this.output;return a.prototype._mathChain(this,g,h,i,f)},a.Env.prototype.dispose=function(){b.audiocontext.currentTime;this.disconnect(),this.control.dispose(),this.control=null;for(var a=1;a<this.mathOps.length;a++)mathOps[a].dispose()}}(c,m,n,o,i);var s;s=function(){"use strict";function b(){for(var a=d.audiocontext,b=a.createBuffer(1,2048,a.sampleRate),c=b.getChannelData(0),e=0;2048>e;e++)c[e]=1;var f=a.createBufferSource();return f.buffer=b,f.loop=!0,f}var d=c;a.Pulse=function(c,e){a.Oscillator.call(this,c,"sawtooth"),this.w=e||0,this.osc2=new a.SawOsc(c),this.dNode=d.audiocontext.createDelay(),this.dcOffset=b(),this.dcGain=d.audiocontext.createGain(),this.dcOffset.connect(this.dcGain),this.dcGain.connect(this.output),this.f=c||440;var f=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=f,this.dcGain.gain.value=1.7*(.5-this.w),this.osc2.disconnect(),this.osc2.output.gain.minValue=-10,this.osc2.output.gain.maxValue=10,this.osc2.panner.disconnect(),this.osc2.amp(-1),this.osc2.output.connect(this.dNode),this.dNode.connect(this.output),this.output.gain.value=1,this.output.connect(this.panner)},a.Pulse.prototype=Object.create(a.Oscillator.prototype),a.Pulse.prototype.width=function(b){if("number"==typeof b){if(1>=b&&b>=0){this.w=b;var c=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=c}this.dcGain.gain.value=1.7*(.5-this.w)}else{b.connect(this.dNode.delayTime);var d=new a.SignalAdd(-.5);d.setInput(b),d=d.mult(-1),d=d.mult(1.7),d.connect(this.dcGain.gain)}},a.Pulse.prototype.start=function(a,c){var e=d.audiocontext.currentTime,f=c||0;if(!this.started){var g=a||this.f,h=this.oscillator.type;this.oscillator=d.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(g,e),this.oscillator.type=h,this.oscillator.connect(this.output),this.oscillator.start(f+e),this.osc2.oscillator=d.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(g,f+e),this.osc2.oscillator.type=h,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(f+e),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=b(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(f+e),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}},a.Pulse.prototype.stop=function(a){if(this.started){var b=a||0,c=d.audiocontext.currentTime;this.oscillator.stop(b+c),this.osc2.oscillator.stop(b+c),this.dcOffset.stop(b+c),this.started=!1,this.osc2.started=!1}},a.Pulse.prototype.freq=function(a,b,c){if("number"==typeof a){this.f=a;var e=d.audiocontext.currentTime,b=b||0,c=c||0,f=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(e),this.oscillator.frequency.setValueAtTime(f,e+c),this.oscillator.frequency.exponentialRampToValueAtTime(a,c+b+e),this.osc2.oscillator.frequency.cancelScheduledValues(e),this.osc2.oscillator.frequency.setValueAtTime(f,e+c),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(a,c+b+e),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else a.output&&(a.output.disconnect(),a.output.connect(this.oscillator.frequency),a.output.connect(this.osc2.oscillator.frequency),this.freqMod=a)}}(c,q);var t;t=function(){"use strict";var b=c;a.Noise=function(){a.Oscillator.call(this),delete this.f,delete this.freq,delete this.oscillator,this.buffer=d},a.Noise.prototype=Object.create(a.Oscillator.prototype);var d=function(){for(var a=2*b.audiocontext.sampleRate,c=b.audiocontext.createBuffer(1,a,b.audiocontext.sampleRate),d=c.getChannelData(0),e=0;a>e;e++)d[e]=2*Math.random()-1;return c.type="white",c}(),e=function(){var a,c,d,e,f,g,h,i=2*b.audiocontext.sampleRate,j=b.audiocontext.createBuffer(1,i,b.audiocontext.sampleRate),k=j.getChannelData(0);a=c=d=e=f=g=h=0;for(var l=0;i>l;l++){var m=2*Math.random()-1;a=.99886*a+.0555179*m,c=.99332*c+.0750759*m,d=.969*d+.153852*m,e=.8665*e+.3104856*m,f=.55*f+.5329522*m,g=-.7616*g-.016898*m,k[l]=a+c+d+e+f+g+h+.5362*m,k[l]*=.11,h=.115926*m}return j.type="pink",j}(),f=function(){for(var a=2*b.audiocontext.sampleRate,c=b.audiocontext.createBuffer(1,a,b.audiocontext.sampleRate),d=c.getChannelData(0),e=0,f=0;a>f;f++){var g=2*Math.random()-1;d[f]=(e+.02*g)/1.02,e=d[f],d[f]*=3.5}return c.type="brown",c}();a.Noise.prototype.setType=function(a){switch(a){case"white":this.buffer=d;break;case"pink":this.buffer=e;break;case"brown":this.buffer=f;break;default:this.buffer=d}if(this.started){var c=b.audiocontext.currentTime;this.stop(c),this.start(c+.01)}},a.Noise.prototype.getType=function(){return this.buffer.type},a.Noise.prototype.start=function(){this.started&&this.stop(),this.noise=b.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var a=b.audiocontext.currentTime;this.noise.start(a),this.started=!0},a.Noise.prototype.stop=function(){var a=b.audiocontext.currentTime;this.noise&&(this.noise.stop(a),this.started=!1)},a.Noise.prototype.dispose=function(){var a=b.audiocontext.currentTime;this.noise&&(this.noise.disconnect(),this.stop(a)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}(c);var u;u=function(){"use strict";var b=c;a.AudioIn=function(){this.input=b.audiocontext.createGain(),this.output=b.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=0,this.enabled=!1,this.amplitude=new a.Amplitude,this.output.connect(this.amplitude.input),"undefined"==typeof window.MediaStreamTrack?window.alert("This browser does not support MediaStreamTrack"):"undefined"!=typeof window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(this._gotSources),b.soundArray.push(this)},a.AudioIn.prototype.start=function(){var a=this;if(b.inputSources[a.currentSource]){var c=b.inputSources[a.currentSource].id,d={audio:{optional:[{sourceId:c}]}};navigator.getUserMedia(d,this._onStream=function(c){a.stream=c,a.enabled=!0,a.mediaStream=b.audiocontext.createMediaStreamSource(c),a.mediaStream.connect(a.output),a.amplitude.setInput(a.output)},this._onStreamError=function(a){console.error(a)})}else window.navigator.getUserMedia({audio:!0},this._onStream=function(c){a.stream=c,a.enabled=!0,a.mediaStream=b.audiocontext.createMediaStreamSource(c),a.mediaStream.connect(a.output),a.amplitude.setInput(a.output)},this._onStreamError=function(a){console.error(a)})},a.AudioIn.prototype.stop=function(){this.stream&&this.stream.stop()},a.AudioIn.prototype.connect=function(a){this.output.connect(a?a.hasOwnProperty("input")?a.input:a.hasOwnProperty("analyser")?a.analyser:a:b.input)},a.AudioIn.prototype.disconnect=function(a){this.output.disconnect(a),this.output.connect(this.amplitude.input)},a.AudioIn.prototype.getLevel=function(a){return a&&(this.amplitude.smoothing=a),this.amplitude.getLevel()},a.AudioIn.prototype._gotSources=function(a){for(var c=0;c!==a.length;c++){var d=a[c];"audio"===d.kind&&b.inputSources.push(d)}},a.AudioIn.prototype.amp=function(a,c){if(c){var d=c||0,e=this.output.gain.value;this.output.gain.cancelScheduledValues(b.audiocontext.currentTime),this.output.gain.setValueAtTime(e,b.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(a,d+b.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(b.audiocontext.currentTime),this.output.gain.setValueAtTime(a,b.audiocontext.currentTime)},a.AudioIn.prototype.listSources=function(){return console.log("input sources: "),console.log(b.inputSources),b.inputSources.length>0?b.inputSources:"This browser does not support MediaStreamTrack.getSources()"},a.AudioIn.prototype.setSource=function(a){var c=this;b.inputSources.length>0&&a<b.inputSources.length?(c.currentSource=a,console.log("set source to "+b.inputSources[c.currentSource].id)):console.log("unable to set input source")},a.AudioIn.prototype.dispose=function(){this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),this.amplitude=null,this.output=null}}(c);var v;v=function(){"use strict";var b=c;a.Filter=function(a){this.ac=b.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.biquad=this.ac.createBiquadFilter(),this.input.connect(this.biquad),this.biquad.connect(this.output),this.connect(),a&&this.setType(a)},a.Filter.prototype.process=function(a,b,c){a.connect(this.input),this.set(b,c)},a.Filter.prototype.set=function(a,b,c){a&&this.freq(a,c),b&&this.res(b,c)},a.Filter.prototype.freq=function(a,b){var c=this,d=b||0;return 0>=a&&(a=1),"number"==typeof a?(c.biquad.frequency.value=a,c.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+d),c.biquad.frequency.exponentialRampToValueAtTime(a,this.ac.currentTime+.02+d)):a&&a.connect(this.biquad.frequency),c.biquad.frequency.value},a.Filter.prototype.res=function(a,b){var c=this,d=b||0;return"number"==typeof a?(c.biquad.Q.value=a,c.biquad.Q.cancelScheduledValues(c.ac.currentTime+.01+d),c.biquad.Q.linearRampToValueAtTime(a,c.ac.currentTime+.02+d)):a&&freq.connect(this.biquad.Q),c.biquad.Q.value},a.Filter.prototype.setType=function(a){this.biquad.type=a},a.Filter.prototype.amp=function(a,c,d){var c=c||0,d=d||0,e=b.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(a,e+d+c+.001)},a.Filter.prototype.connect=function(b){var c=b||a.soundOut.input;this.output.connect(c)},a.Filter.prototype.disconnect=function(){this.output.disconnect()},a.LowPass=function(){a.Filter.call(this,"lowpass")},a.LowPass.prototype=Object.create(a.Filter.prototype),a.HighPass=function(){a.Filter.call(this,"highpass")},a.HighPass.prototype=Object.create(a.Filter.prototype),a.BandPass=function(){a.Filter.call(this,"bandpass")},a.BandPass.prototype=Object.create(a.Filter.prototype)}(c);var w;w=function(){"use strict";var b=c;a.Delay=function(){this.ac=b.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._split=this.ac.createChannelSplitter(2),this._merge=this.ac.createChannelMerger(2),this._leftGain=this.ac.createGain(),this._rightGain=this.ac.createGain(),this.leftDelay=this.ac.createDelay(),this.rightDelay=this.ac.createDelay(),this._leftFilter=new a.Filter,this._rightFilter=new a.Filter,this._leftFilter.disconnect(),this._rightFilter.disconnect(),this.lowPass=this._leftFilter,this._leftFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._rightFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._leftFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this._rightFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this.input.connect(this._split),this.leftDelay.connect(this._leftGain),this.rightDelay.connect(this._rightGain),this._leftGain.connect(this._leftFilter.input),this._rightGain.connect(this._rightFilter.input),this._merge.connect(this.output),this.output.connect(a.soundOut.input),this._leftFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),this._rightFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),this.setType(0),this._maxDelay=this.leftDelay.delayTime.maxValue},a.Delay.prototype.process=function(a,b,c,d){var e=c||0,f=b||0;if(e>=1)throw new Error("Feedback value will force a positive feedback loop.");if(f>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");a.connect(this.input),this.leftDelay.delayTime.setValueAtTime(f,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(f,this.ac.currentTime),this._leftGain.gain.setValueAtTime(e,this.ac.currentTime),this._rightGain.gain.setValueAtTime(e,this.ac.currentTime),d&&(this._leftFilter.freq(d),this._rightFilter.freq(d))},a.Delay.prototype.delayTime=function(a){"number"!=typeof a?(a.connect(this.leftDelay.delayTime),a.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(a,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(a,this.ac.currentTime))},a.Delay.prototype.feedback=function(a){if("number"!=typeof a)a.connect(this._leftGain.gain),a.connect(this._rightGain.gain);else{if(a>=1)throw new Error("Feedback value will force a positive feedback loop.");this._leftGain.gain.exponentialRampToValueAtTime(a,this.ac.currentTime),this._rightGain.gain.exponentialRampToValueAtTime(a,this.ac.currentTime)}},a.Delay.prototype.filter=function(a,b){this._leftFilter.set(a,b),this._rightFilter.set(a,b)},a.Delay.prototype.setType=function(a){switch(1===a&&(a="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),a){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._leftFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._leftFilter.output.connect(this.rightDelay)}},a.Delay.prototype.amp=function(a,c,d){var c=c||0,d=d||0,e=b.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(a,e+d+c+.001)},a.Delay.prototype.connect=function(b){var c=b||a.soundOut.input;this.output.connect(c)},a.Delay.prototype.disconnect=function(){this.output.disconnect()}}(c,v);var x;x=function(){"use strict";var b=c;a.Reverb=function(){this.ac=b.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse(),this.connect(),b.soundArray.push(this)},a.Reverb.prototype.process=function(a,b,c,d){a.connect(this.input);var e=!1;b&&(this._seconds=b,e=!0),c&&(this._decay=c),d&&(this._reverse=d),e&&this._buildImpulse()},a.Reverb.prototype.set=function(a,b,c){var d=!1;a&&(this._seconds=a,d=!0),b&&(this._decay=b),c&&(this._reverse=c),d&&this._buildImpulse()},a.Reverb.prototype.amp=function(a,c,d){var c=c||0,d=d||0,e=b.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(a,e+d+c+.001)},a.Reverb.prototype.connect=function(b){var c=b||a.soundOut.input;this.output.connect(c.input?c.input:c)},a.Reverb.prototype.disconnect=function(){this.output.disconnect()},a.Reverb.prototype._buildImpulse=function(){var a,b,c=this.ac.sampleRate,d=c*this._seconds,e=this._decay,f=this.ac.createBuffer(2,d,c),g=f.getChannelData(0),h=f.getChannelData(1);for(b=0;d>b;b++)a=this.reverse?d-b:b,g[b]=(2*Math.random()-1)*Math.pow(1-a/d,e),h[b]=(2*Math.random()-1)*Math.pow(1-a/d,e);this.convolverNode.buffer=f},a.Reverb.prototype.dispose=function(){this.convolverNode.buffer=null,this.convolverNode=null,"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)},a.Convolver=function(a,c){this.ac=b.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),a?(this.impulses=[],this._loadBuffer(a,c)):(this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse()),this.connect(),b.soundArray.push(this)},a.Convolver.prototype=Object.create(a.Reverb.prototype),a.prototype.registerPreloadMethod("createConvolver"),a.prototype.createConvolver=function(b,c){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var d=new a.Convolver(b,c);return d.impulses=[],d},a.Convolver.prototype._loadBuffer=function(b,c){b=a.prototype._checkFileFormats(b);var d=new XMLHttpRequest;d.open("GET",b,!0),d.responseType="arraybuffer";var e=this;d.onload=function(){var f=a.prototype.getAudioContext();f.decodeAudioData(d.response,function(a){var d={},f=b.split("/");d.name=f[f.length-1],d.audioBuffer=a,e.impulses.push(d),e.convolverNode.buffer=d.audioBuffer,c&&c(d)})},d.send()},a.Convolver.prototype.set=null,a.Convolver.prototype.process=function(a){a.connect(this.input)},a.Convolver.prototype.impulses=[],a.Convolver.prototype.addImpulse=function(a,b){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(a,b)},a.Convolver.prototype.resetImpulse=function(a,b){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(a,b)},a.Convolver.prototype.toggleImpulse=function(a){if("number"==typeof a&&a<this.impulses.length&&(this.convolverNode.buffer=this.impulses[a].audioBuffer),"string"==typeof a)for(var b=0;b<this.impulses.length;b++)if(this.impulses[b].name===a){this.convolverNode.buffer=this.impulses[b].audioBuffer;break}},a.Convolver.prototype.dispose=function(){for(var a in this.impulses)this.impulses[a]=null;this.convolverNode.disconnect(),this.concolverNode=null,"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)}}(c,b);var y;y=function(a){"use strict";return a.Clock=function(b,c){this._oscillator=null,this._jsNode=this.context.createScriptProcessor(this.bufferSize,1,1),this._jsNode.onaudioprocess=this._processBuffer.bind(this),this._controlSignal=new a.Signal(1),this._upTick=!1,this.tick=this.defaultArg(c,function(){}),this._jsNode.noGC(),this.setRate(b)},a.extend(a.Clock),a.Clock.prototype.setRate=function(a,b){var c=this.secondsToFrequency(this.toSeconds(a));b?this._controlSignal.exponentialRampToValueNow(c,b):(this._controlSignal.cancelScheduledValues(0),this._controlSignal.setValue(c))},a.Clock.prototype.getRate=function(){return this._controlSignal.getValue()},a.Clock.prototype.start=function(a){this._oscillator=this.context.createOscillator(),this._oscillator.type="square",this._oscillator.connect(this._jsNode),this._controlSignal.connect(this._oscillator.frequency),this._upTick=!1;var b=this.toSeconds(a);this._oscillator.start(b),this._oscillator.onended=function(){}},a.Clock.prototype.stop=function(a,b){var c=this.toSeconds(a);this._oscillator.onended=b,this._oscillator.stop(c)},a.Clock.prototype._processBuffer=function(a){for(var b=this.defaultArg(a.playbackTime,this.now()),c=this._jsNode.bufferSize,d=a.inputBuffer.getChannelData(0),e=this._upTick,f=this,g=0;c>g;g++){var h=d[g];h>0&&!e?(e=!0,setTimeout(function(){var a=b+f.samplesToSeconds(g+2*c);return function(){f.tick(a)}}(),0)):0>h&&e&&(e=!1)}this._upTick=e},a.Clock.prototype.dispose=function(){this._jsNode.disconnect(),this._controlSignal.dispose(),this._oscillator&&(this._oscillator.onended(),this._oscillator.disconnect()),this._jsNode.onaudioprocess=function(){},this._jsNode=null,this._controlSignal=null,this._oscillator=null},a.Clock}(i);var z;z=function(){"use strict";var b=c,d=y,e=b.audiocontext;a.Metro=function(){this.clock=new d(e.sampleRate,this.ontick.bind(this)),this.syncedParts=[],this.bpm=120,this._init(),this.tickCallback=function(){}};var f=0,g=0;a.Metro.prototype.ontick=function(a){var c=a-f,d=a-b.audiocontext.currentTime;if(!(-.02>=c-g)){f=a;for(var e in this.syncedParts){var h=this.syncedParts[e];h.incrementStep(d);for(var i in h.phrases){var j=h.phrases[i],k=j.sequence,l=this.metroTicks%k.length;0!==k[l]&&(this.metroTicks<k.length||!j.looping)&&j.callback(k[l],d)}}this.metroTicks+=1,this.tickCallback(d)}},a.Metro.prototype.setBPM=function(a,c){var d=60/(a*this.tatums);g=d;this.clock.setRate(d,c+b.audiocontext.currentTime),this.bpm=a},a.Metro.prototype.getBPM=function(){return this.clock.getRate()/this.tatums*60},a.Metro.prototype._init=function(){this.metroTicks=0},a.Metro.prototype.resetSync=function(a){this.syncedParts=[a]},a.Metro.prototype.pushSync=function(a){this.syncedParts.push(a)},a.Metro.prototype.start=function(a){var b=a||0;this.clock.start(b),this.setBPM(this.bpm)},a.Metro.prototype.stop=function(a){var b=a||0;this.clock._oscillator&&this.clock.stop(b)},a.Metro.prototype.beatLength=function(a){this.tatums=1/a/4}}(c,y);var A;A=function(){"use strict";function b(a){a.currentPart++,a.currentPart>=a.parts.length?(a.scoreStep=0,a.onended()):(a.scoreStep=0,a.parts[a.currentPart-1].stop(),a.parts[a.currentPart].start())}var d=c,e=120;a.prototype.setBPM=function(a,b){e=a;for(var c in d.parts)d.parts[c].setBPM(e,b)},a.Phrase=function(a,b,c){this.phraseStep=0,this.name=a,this.callback=b,this.sequence=c},a.Part=function(b,c){this.length=b||0,this.partStep=0,this.phrases=[],this.looping=!1,this.isPlaying=!1,this.onended=function(){this.stop()},this.tatums=c||.0625,this.metro=new a.Metro,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(e),d.parts.push(this),this.callback=function(){}},a.Part.prototype.setBPM=function(a,b){this.metro.setBPM(a,b)},a.Part.prototype.getBPM=function(){return this.metro.getBPM()},a.Part.prototype.start=function(a){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var b=a||0;this.metro.start(b)}},a.Part.prototype.loop=function(a){this.looping=!0,this.onended=function(){this.partStep=0};var b=a||0;this.start(b)},a.Part.prototype.noLoop=function(){this.looping=!1,this.onended=function(){this.stop()}},a.Part.prototype.stop=function(a){this.partStep=0,this.pause(a)},a.Part.prototype.pause=function(a){this.isPlaying=!1;var b=a||0;this.metro.stop(b)},a.Part.prototype.addPhrase=function(b,c,d){var e;if(3===arguments.length)e=new a.Phrase(b,c,d);else{if(!(arguments[0]instanceof a.Phrase))throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";e=arguments[0]}this.phrases.push(e),e.sequence.length>this.length&&(this.length=e.sequence.length)},a.Part.prototype.removePhrase=function(a){for(var b in this.phrases)this.phrases[b].name===a&&this.phrases.split(b,1)},a.Part.prototype.getPhrase=function(a){for(var b in this.phrases)if(this.phrases[b].name===a)return this.phrases[b]},a.Part.prototype.replaceSequence=function(a,b){for(var c in this.phrases)this.phrases[c].name===a&&(this.phrases[c].sequence=b)},a.Part.prototype.incrementStep=function(a){this.partStep<this.length-1?(this.callback(a),this.partStep+=1):(this.looping&&this.callback(a),this.onended(),this.partStep=0)},a.Part.prototype.onStep=function(a){this.callback=a},a.Score=function(){this.parts=[],this.currentPart=0;var a=this;for(var c in arguments)this.parts[c]=arguments[c],this.parts[c].nextPart=this.parts[c+1],this.parts[c].onended=function(){a.resetPart(c),b(a)};this.looping=!1},a.Score.prototype.onended=function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0},a.Score.prototype.start=function(){this.parts[this.currentPart].start(),this.scoreStep=0},a.Score.prototype.stop=function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0},a.Score.prototype.pause=function(){this.parts[this.currentPart].stop()},a.Score.prototype.loop=function(){this.looping=!0,this.start()},a.Score.prototype.noLoop=function(){this.looping=!1},a.Score.prototype.resetParts=function(){for(var a in this.parts)this.resetPart(a)},a.Score.prototype.resetPart=function(a){this.parts[a].stop(),this.parts[a].partStep=0;for(var b in this.parts[a].phrases)this.parts[a].phrases[b].phraseStep=0},a.Score.prototype.setBPM=function(a,b){for(var c in this.parts)this.parts[c].setBPM(a,b)}}(c);var B;B=function(){"use strict";function b(a,b){for(var c=a.length+b.length,d=new Float32Array(c),e=0,f=0;c>f;)d[f++]=a[e],d[f++]=b[e],e++;return d}function d(a,b,c){for(var d=c.length,e=0;d>e;e++)a.setUint8(b+e,c.charCodeAt(e))}var e=c,f=e.audiocontext;a.SoundRecorder=function(){this.input=f.createGain(),this.output=f.createGain(),this.recording=!1,this.bufferSize=1024,this._channels=2,this._clear(),this._jsNode=f.createScriptProcessor(this.bufferSize,this._channels,2),this._jsNode.onaudioprocess=this._audioprocess.bind(this),this._callback=function(){},this._jsNode.connect(a.soundOut._silentNode),this.setInput(),e.soundArray.push(this)},a.SoundRecorder.prototype.setInput=function(b){this.input.disconnect(),this.input=null,this.input=f.createGain(),this.input.connect(this._jsNode),this.input.connect(this.output),b?b.connect(this.input):a.soundOut.output.connect(this.input)},a.SoundRecorder.prototype.record=function(a,b,c){this.recording=!0,b&&(this.sampleLimit=Math.round(b*f.sampleRate)),a&&c?this._callback=function(){this.buffer=this._getBuffer(),a.setBuffer(this.buffer),c()}:a&&(this._callback=function(){this.buffer=this._getBuffer(),a.setBuffer(this.buffer)})},a.SoundRecorder.prototype.stop=function(){this.recording=!1,this._callback(),this._clear()},a.SoundRecorder.prototype._clear=function(){this._leftBuffers=[],this._rightBuffers=[],this.recordedSamples=0,this.sampleLimit=null},a.SoundRecorder.prototype._audioprocess=function(a){if(this.recording!==!1&&this.recording===!0)if(this.sampleLimit&&this.recordedSamples>=this.sampleLimit)this.stop();else{var b=a.inputBuffer.getChannelData(0),c=a.inputBuffer.getChannelData(1);this._leftBuffers.push(new Float32Array(b)),this._rightBuffers.push(new Float32Array(c)),this.recordedSamples+=this.bufferSize}},a.SoundRecorder.prototype._getBuffer=function(){var a=[];return a.push(this._mergeBuffers(this._leftBuffers)),a.push(this._mergeBuffers(this._rightBuffers)),a},a.SoundRecorder.prototype._mergeBuffers=function(a){for(var b=new Float32Array(this.recordedSamples),c=0,d=a.length,e=0;d>e;e++){var f=a[e];

b.set(f,c),c+=f.length}return b},a.SoundRecorder.prototype.dispose=function(){this._clear(),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._jsNode=null},a.prototype.saveSound=function(c,e){var f=c.buffer.getChannelData(0),g=c.buffer.getChannelData(1),h=b(f,g),i=new ArrayBuffer(44+2*h.length),j=new DataView(i);d(j,0,"RIFF"),j.setUint32(4,44+2*h.length,!0),d(j,8,"WAVE"),d(j,12,"fmt "),j.setUint32(16,16,!0),j.setUint16(20,1,!0),j.setUint16(22,2,!0),j.setUint32(24,44100,!0),j.setUint32(28,176400,!0),j.setUint16(32,4,!0),j.setUint16(34,16,!0),d(j,36,"data"),j.setUint32(40,2*h.length,!0);for(var k=h.length,l=44,m=1,n=0;k>n;n++)j.setInt16(l,32767*h[n]*m,!0),l+=2;a.prototype.writeFile([j],e,"wav")}}(b,c);var C;C=function(){"use strict";var a=b;return a}(b,c,d,e,f,g,h,p,q,r,s,t,u,v,w,x,z,A,B)}),function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){p5.prototype.Gibber=a("gibber.core.lib"),p5.prototype.Gibber.Audio=a("gibber.audio.lib")(p5.prototype.Gibber),p5.prototype.Gibber["export"](p5.prototype),p5.prototype.Gibber.init({globalize:!1,target:p5.prototype})},{"gibber.audio.lib":5,"gibber.core.lib":23}],2:[function(require,module,exports){(function(global){!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.Gibberish=b()}(this,function(){function createInput(){console.log("connecting audio input..."),navigator.getUserMedia({audio:!0},function(a){console.log("audio input connected"),Gibberish.mediaStreamSource=Gibberish.context.createMediaStreamSource(a),Gibberish.mediaStreamSource.connect(Gibberish.node),_hasInput=!0},function(){console.log("error opening audio input")})}var Gibberish={memo:{},codeblock:[],analysisCodeblock:[],analysisUgens:[],dirtied:[],id:0,isDirty:!1,out:null,debug:!1,callback:"",audioFiles:{},sequencers:[],callbackArgs:["input"],callbackObjects:[],analysisCallbackArgs:[],analysisCallbackObjects:[],createCallback:function(){this.memo={},this.codeblock.length=0,this.callbackArgs.length=0,this.callbackObjects.length=0,this.analysisCallbackArgs.length=0,this.dirtied.length=0,this.codestring="",this.args=["input"],this.memo={},this.out.codegen();var a=this.codeblock.slice(0);if(this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var b=0;b<this.analysisUgens.length;b++)this.analysisCallbackArgs.push(this.analysisUgens[b].analysisSymbol)}if(this.args=this.args.concat(this.callbackArgs),this.args=this.args.concat(this.analysisCallbackArgs),this.codestring+=a.join("	"),this.codestring+="\n	",this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var b=0;b<this.analysisUgens.length;b++)this.codeblock.length=0,this.analysisUgens[b].analysisCodegen();this.codestring+=this.analysisCodeblock.join("\n	"),this.codestring+="\n	"}return this.codestring+="return "+this.out.variable+";\n",this.callbackString=this.codestring,this.debug&&console.log(this.callbackString),[this.args,this.codestring]},audioProcess:function(a){var b,c,d=a.outputBuffer.getChannelData(0),e=a.outputBuffer.getChannelData(1),f=a.inputBuffer.getChannelData(0),g=Gibberish,h=g.callback,i=g.sequencers,j=(Gibberish.out.callback,g.callbackObjects.slice(0));j.unshift(0);for(var k=0,l=a.outputBuffer.length;l>k;k++){for(var m=0;m<i.length;m++)i[m].tick();if(g.isDirty){b=g.createCallback();try{h=g.callback=new Function(b[0],b[1])}catch(a){console.error("ERROR WITH CALLBACK : \n\n",b)}g.isDirty=!1,j=g.callbackObjects.slice(0),j.unshift(0)}j[0]=f[k],c=h.apply(null,j),d[k]=c[0],e[k]=c[1]}},audioProcessFirefox:function(a){var b,c=Gibberish,d=c.callback,e=c.sequencers,f=c.callbackObjects.slice(0);f.unshift(0);for(var g=0,h=a.length;h>g;g+=2){for(var i=0;i<e.length;i++)e[i].tick();if(c.isDirty){b=c.createCallback();try{d=c.callback=new Function(b[0],b[1])}catch(j){console.error("ERROR WITH CALLBACK : \n\n",d)}c.isDirty=!1,f=c.callbackObjects.slice(0),f.unshift(0)}var k=d.apply(null,f);a[g]=k[0],a[g+1]=k[1]}},clear:function(){this.out.inputs.length=0,this.analysisUgens.length=0,this.sequencers.length=0,this.callbackArgs.length=2,this.callbackObjects.length=1,Gibberish.dirty(this.out)},dirty:function(a){if("undefined"!=typeof a){for(var b=!1,c=0;c<this.dirtied.length;c++)this.dirtied[c].variable===a.variable&&(b=!0);b||(this.isDirty=!0,this.dirtied.push(a))}else this.isDirty=!0},generateSymbol:function(a){return a+"_"+this.id++},AudioDataDestination:function(a,b){var c=new Audio;c.mozSetup(2,a);var d,e=0,f=a/2,g=null;setInterval(function(){var a;if(g){if(a=c.mozWriteAudio(g.subarray(d)),e+=a,d+=a,d<g.length)return;g=null}var h=c.mozCurrentSampleOffset(),i=h+f-e;if(i>0){var j=new Float32Array(i);b(j),a=c.mozWriteAudio(j),h=c.mozCurrentSampleOffset(),a<j.length&&(g=j,d=a),e+=a}},100)},init:function(){var a,b,c="undefined"==typeof arguments[0]?1024:arguments[0];return"undefined"!=typeof webkitAudioContext?a=webkitAudioContext:"undefined"!=typeof AudioContext&&(a=AudioContext),b=function(){if("undefined"!=typeof a){if(document&&document.documentElement&&"ontouchstart"in document.documentElement&&(window.removeEventListener("touchstart",b),"ontouchstart"in document.documentElement)){var c=Gibberish.context.createBufferSource();c.connect(Gibberish.context.destination),c.noteOn(0)}}else alert("Your browser does not support javascript audio synthesis. Please download a modern web browser that is not Internet Explorer.");Gibberish.onstart&&Gibberish.onstart()},Gibberish.context=new a,Gibberish.node=Gibberish.context.createScriptProcessor(c,2,2,Gibberish.context.sampleRate),Gibberish.node.onaudioprocess=Gibberish.audioProcess,Gibberish.node.connect(Gibberish.context.destination),Gibberish.out=new Gibberish.Bus2,Gibberish.out.codegen(),Gibberish.dirty(Gibberish.out),document&&document.documentElement&&"ontouchstart"in document.documentElement?window.addEventListener("touchstart",b):b(),this},makePanner:function(){for(var a=[],b=[],c=Math.sqrt(2)/2,d=0;1024>d;d++){var e=-1+d/1024*2;a[d]=c*(Math.cos(e)-Math.sin(e)),b[d]=c*(Math.cos(e)+Math.sin(e))}return function(c,d,e){var f,g,h,i,j,k,l="object"==typeof c,m=l?c[0]:c,n=l?c[1]:c;return f=1023*(d+1)/2,g=0|f,h=f-g,g=1023&g,i=1023===g?0:g+1,j=a[g],k=a[i],e[0]=(j+h*(k-j))*m,j=b[g],k=b[i],e[1]=(j+h*(k-j))*n,e}},defineUgenProperty:function(a,b,c){var d=c.properties[a]={value:b,binops:[],parent:c,name:a};Object.defineProperty(c,a,{configurable:!0,get:function(){return d.value},set:function(a){d.value=a,Gibberish.dirty(c)}})},polyInit:function(a){a.mod=a.polyMod,a.removeMod=a.removePolyMod,a.voicesClear=function(){if(a.children.length>0){for(var b=0;b<a.children.length;b++)a.children[b].disconnect();a.children.length=0,a.voiceCount=0}};for(var b in a.polyProperties)!function(b){var c=a.polyProperties[b];Object.defineProperty(a,b,{configurable:!0,get:function(){return c},set:function(d){c=d;for(var e=0;e<a.children.length;e++)a.children[e][b]=c}})}(b);var c=a.maxVoices;Object.defineProperty(a,"maxVoices",{get:function(){return c},set:function(a){c=a,this.voicesClear(),this.initVoices()}})},interpolate:function(a,b){var c=0|b,d=c+1>a.length-1?0:c+1;return frac=b-c,a[c]+frac*(a[d]-a[c])},pushUnique:function(a,b){for(var c=a,d=!0,e=0;e<b.length;e++)if(c===b[e]){d=!1;break}d&&b.push(c)},"export":function(a,b){for(var c in Gibberish[a])b[c]=Gibberish[a][c]},ugen:function(){Gibberish.extend(this,{processProperties:function(){if("object"!=typeof arguments[0][0]||"undefined"!=typeof arguments[0][0].type||Array.isArray(arguments[0][0])||"op"===arguments[0][0].name){var a=0;for(var b in this.properties)"object"==typeof this.properties[b]&&"undefined"!=typeof this.properties[b].binops?"undefined"!=typeof arguments[0][a]&&(this.properties[b].value=arguments[0][a++]):"undefined"!=typeof arguments[0][a]&&(this.properties[b]=arguments[0][a++])}else{var c=arguments[0][0];for(var b in c)"undefined"!=typeof c[b]&&("object"==typeof this.properties[b]&&"undefined"!=typeof this.properties[b].binops?this.properties[b].value=c[b]:this[b]=c[b])}return this},valueOf:function(){return this.codegen(),this.variable},codegen:function(){var a="",b=null;if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];b=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=b,this.variable=b,a+="var "+b+" = "+this.symbol+"(";for(var c in this.properties){var d=this.properties[c],e="";if(Array.isArray(d.value)){0===d.value.length&&(e=0);for(var f=0;f<d.value.length;f++){var g=d.value[f];e+="object"==typeof g?null!==g?g.valueOf():"null":"function"==typeof d.value?d.value():d.value,e+=f<d.value.length-1?", ":""}}else"object"==typeof d.value?null!==d.value&&(e=d.value.codegen?d.value.valueOf():d.value):"undefined"!==d.name&&(e="function"==typeof d.value?d.value():d.value);if(0!=d.binops.length){for(var h=0;h<d.binops.length;h++)a+="(";for(var i=0;i<d.binops.length;i++){var j,k=d.binops[i];j="number"==typeof k.ugen?k.ugen:null!==k.ugen?k.ugen.valueOf():"null","="===k.binop?(a=a.replace(e,""),a+=j):"++"===k.binop?a+=" + Math.abs("+j+")":(0===i&&(a+=e),a+=" "+k.binop+" "+j+")")}}else a+=e;a+=", "}return" "===a.charAt(a.length-1)&&(a=a.slice(0,-2)),a+=");\n",this.codeblock=a,-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),-1===Gibberish.callbackArgs.indexOf(this.symbol)&&"op"!==this.name&&Gibberish.callbackArgs.push(this.symbol),-1===Gibberish.callbackObjects.indexOf(this.callback)&&"op"!==this.name&&Gibberish.callbackObjects.push(this.callback),this.dirty=!1,b},init:function(){if(this.initalized||(this.symbol=Gibberish.generateSymbol(this.name),this.codeblock=null,this.variable=null),"undefined"==typeof this.properties&&(this.properties={}),!this.initialized){this.destinations=[];for(var a in this.properties)Gibberish.defineUgenProperty(a,this.properties[a],this)}if(arguments.length>0&&"object"==typeof arguments[0][0]&&"undefined"===arguments[0][0].type){var b=arguments[0][0];for(var a in b)this[a]=b[a]}return this.initialized=!0,this},mod:function(a,b,c){var d=this.properties[a],e={ugen:b,binop:c};d.binops.push(e),Gibberish.dirty(this)},removeMod:function(a,b){if("undefined"==typeof b)this.properties[a].binops.length=0;else if("number"==typeof b)this.properties[a].binops.splice(b,1);else if("object"==typeof b)for(var c=0,d=this.properties[a].binops.length;d>c;c++)this.properties[a].binops[c].ugen===b&&this.properties[a].binops.splice(c,1);Gibberish.dirty(this)},polyMod:function(a,b,c){for(var d=0;d<this.children.length;d++)this.children[d].mod(a,b,c);Gibberish.dirty(this)},removePolyMod:function(){var a=Array.prototype.slice.call(arguments,0);if("amp"!==arguments[0]&&"pan"!==arguments[0])for(var b=0;b<this.children.length;b++)this.children[b].removeMod.apply(this.children[b],a);else this.removeMod.apply(this,a);Gibberish.dirty(this)},smooth:function(a){var b=new Gibberish.OnePole;this.mod(a,b,"=")},connect:function(a,b){return"undefined"==typeof a&&(a=Gibberish.out),-1===this.destinations.indexOf(a)&&(a.addConnection(this,1,b),this.destinations.push(a)),this},send:function(a,b){return-1===this.destinations.indexOf(a)?(a.addConnection(this,b),this.destinations.push(a)):a.adjustSendAmount(this,b),this},disconnect:function(a,b){var c;if(a)c=this.destinations.indexOf(a),c>-1&&this.destinations.splice(c,1),a.removeConnection(this);else{for(var d=0;d<this.destinations.length;d++)this.destinations[d].removeConnection(this);this.destinations=[]}return Gibberish.dirty(this),this}})}};Array2=function(){this.length=0},Array2.prototype=[],Array2.prototype.remove=function(a,b){if(b="undefined"==typeof b?!0:b,"undefined"==typeof a){for(var c=0;c<this.length;c++)delete this[c];this.length=0}else if("number"==typeof a)this.splice(a,1);else if("string"==typeof a){for(var d=[],c=0;c<this.length;c++){var e=this[c];if(e.type===a||e.name===a){if(!b)return void this.splice(c,1);d.push(c)}}for(var c=0;c<d.length;c++)this.splice(d[c],1)}else if("object"==typeof a)for(var f=this.indexOf(a);f>-1;)this.splice(f,1),f=this.indexOf(a);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.get=function(a){if("number"==typeof a)return this[a];if("string"==typeof a)for(var b=0;b<this.length;b++){var c=this[b];if(c.name===a)return c}else if("object"==typeof a){var d=this.indexOf(a);if(d>-1)return this[d]}return null},Array2.prototype.replace=function(a,b){if(b.parent=this,b.input=a.input,"number"!=typeof a){var c=this.indexOf(a);c>-1&&this.splice(c,1,b)}else this.splice(a,1,b);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.insert=function(a,b){if(a.parent=this,this.input=this.parent,Array.isArray(a))for(var c=0;c<a.length;c++)this.splice(b+c,0,a[c]);else this.splice(b,0,a);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.add=function(){for(var a=0;a<arguments.length;a++)arguments[a].parent=this,arguments[a].input=this.parent,this.push(arguments[a]);this.parent&&(console.log("DIRTYING"),Gibberish.dirty(this.parent))};var rnd=Math.random;Gibberish.rndf=function(a,b,c,d){if(d="undefined"==typeof d?!0:d,"undefined"==typeof c&&"object"!=typeof a){1==arguments.length?(b=arguments[0],a=0):2==arguments.length?(a=arguments[0],b=arguments[1]):(a=0,b=1);var e=b-a,f=Math.random(),g=e*f;return a+g}var h=[],i=[];"undefined"==typeof c&&(c=b||a.length);for(var j=0;c>j;j++){var k;if("object"==typeof arguments[0])k=arguments[0][rndi(0,arguments[0].length-1)];else if(d)k=Gibberish.rndf(a,b);else{for(k=Gibberish.rndf(a,b);i.indexOf(k)>-1;)k=Gibberish.rndf(a,b);i.push(k)}h.push(k)}return h},Gibberish.Rndf=function(){{var a,b,c,d;Math.random}return 0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):3===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]),function(){var e,f,g;return f="function"==typeof a?a():a,g="function"==typeof b?b():b,e="undefined"==typeof c?Gibberish.rndf(f,g):Gibberish.rndf(f,g,c,d)}},Gibberish.rndi=function(a,b,c,d){var e;if(0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]),e=b-a,c>e&&(d=!0),"undefined"==typeof c)return e=b-a,Math.round(a+Math.random()*e);for(var f=[],g=[],h=0;c>h;h++){var i;if(d)i=Gibberish.rndi(a,b);else{for(i=Gibberish.rndi(a,b);g.indexOf(i)>-1;)i=Gibberish.rndi(a,b);g.push(i)}f.push(i)}return f},Gibberish.Rndi=function(){{var a,b,c,d,e;Math.random,Math.round}return 0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):3===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]),e=b-a,"number"==typeof c&&c>e&&(d=!0),function(){var e,f,g;return f="function"==typeof a?a():a,g="function"==typeof b?b():b,e="undefined"==typeof c?Gibberish.rndi(f,g):Gibberish.rndi(f,g,c,d)}},Gibberish.extend=function(a,b){for(var c in b){{c.split(".")}b[c]instanceof Array&&b[c].length<100?(a[c]=b[c].slice(0),"fx"===c&&(a[c].parent=b[c].parent)):"object"!=typeof b[c]||null===b[c]||b[c]instanceof Float32Array?a[c]=b[c]:(a[c]=a[c]||{},arguments.callee(a[c],b[c]))}return a},Function.prototype.clone=function(){return eval("["+this.toString()+"]")[0]},String.prototype.format=function(a,b,c){function d(){var d=this,e=arguments.length+1;for(a=0;e>a;c=arguments[a++])b=c,d=d.replace(RegExp("\\{"+(a-1)+"\\}","g"),b);return d}return d["native"]=String.prototype.format,d}(),Gibberish.future=function(a,b){var c=new Gibberish.Sequencer({values:[function(){},function(){a(),c.stop(),c.disconnect()}],durations:[b]}).start();return c.cancel=function(){c.stop(),c.disconnect()},c},Gibberish.Proxy=function(){var a=0;Gibberish.extend(this,{name:"proxy",type:"effect",properties:{},callback:function(){return a}}).init(),this.input=arguments[0],a=this.input.parent[this.input.name],delete this.input.parent[this.input.name],this.input.parent.properties[this.input.name].value=this,Object.defineProperty(this.input.parent,this.input.name,{get:function(){return a},set:function(b){a=b}}),Gibberish.dirty(this.input.parent)},Gibberish.Proxy.prototype=new Gibberish.ugen,Gibberish.Proxy2=function(){var a=arguments[0],b=arguments[1];Gibberish.extend(this,{name:"proxy2",type:"effect",properties:{},callback:function(){var c=a[b];return Array.isArray(c)?(c[0]+c[1]+c[2])/3:c}}).init(),this.getInput=function(){return a},this.setInput=function(b){a=b},this.getName=function(){return b},this.setName=function(a){b=a}},Gibberish.Proxy2.prototype=new Gibberish.ugen,Gibberish.Proxy3=function(){var a=arguments[0],b=arguments[1];Gibberish.extend(this,{name:"proxy3",type:"effect",properties:{},callback:function(){var c=a[b];return c||0}}),this.init(),this.codegen=function(){console.log(" CALLED "),this.variable||(this.variable=Gibberish.generateSymbol("v")),Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"("+a.properties[b].codegen()+");\n"}},Gibberish.Proxy3.prototype=new Gibberish.ugen,Gibberish.oscillator=function(){this.type="oscillator",this.oscillatorInit=function(){return this.fx=new Array2,this.fx.parent=this,this}},Gibberish.oscillator.prototype=new Gibberish.ugen,Gibberish._oscillator=new Gibberish.oscillator,Gibberish.Wavetable=function(){var a=0,b=null,c=Gibberish.context.sampleRate/1024,d=0;this.properties={frequency:440,amp:.25,sync:0},this.getTable=function(){return b},this.setTable=function(a){b=a,c=Gibberish.context.sampleRate/b.length},this.getTableFreq=function(){return c},this.setTableFreq=function(a){c=a},this.getPhase=function(){return a},this.setPhase=function(b){a=b},this.callback=function(e,f){var g,h,i,j,k,l;for(a+=e/c;a>=1024;)a-=1024;return g=0|a,h=a-g,g=1023&g,i=1023===g?0:g+1,j=b[g],k=b[i],0!==l&&(d=l),(j+h*(k-j))*f}},Gibberish.Wavetable.prototype=Gibberish._oscillator,Gibberish.Table=function(a){this.__proto__=new Gibberish.Wavetable,this.name="table";var b=2*Math.PI;if("undefined"==typeof a){a=new Float32Array(1024);for(var c=1024;c--;)a[c]=Math.sin(c/1024*b)}this.setTable(a),this.init(),this.oscillatorInit()},Gibberish.asmSine=function(a,b,c){"use asm";function d(){for(var a=1024,b=1024;a=a-1|0;)b-=1,i[a>>2]=+g(+(b/1024)*6.2848);k=44100/1024}function e(a,b,c){a=+a,b=+b,c=+c;var d=0,e=0,f=0,g=0,l=0,m=0;return h=+(h+a/k),h>=1024&&(h=+(h-1024)),d=+j(h),g=h-d,e=~~d,f=(e|0)==1024?0:e+1|0,l=+i[e>>2],m=+i[f>>2],+((l+g*(m-l))*b)}function f(a){return a|=0,+i[a>>2]}var g=a.Math.sin,h=0,i=new a.Float32Array(c),j=a.Math.floor,k=0;return{init:d,gen:e,get:f}},Gibberish.asmSine2=function(){this.properties={frequency:440,amp:.5,sr:Gibberish.context.sampleRate},this.name="sine";var a=new ArrayBuffer(4096),b=Gibberish.asmSine(window,null,a);return b.init(),this.getTable=function(){return a},this.get=b.get,this.callback=b.gen,this.init(),this.oscillatorInit(),this.processProperties(arguments),this},Gibberish.asmSine2.prototype=Gibberish._oscillator,Gibberish.Sine=function(){this.__proto__=new Gibberish.Wavetable,this.name="sine";for(var a=2*Math.PI,b=new Float32Array(1024),c=1024;c--;)b[c]=Math.sin(c/1024*a);this.setTable(b),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Sine2=function(){this.__proto__=new Gibberish.Sine,this.name="sine2";var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return c=b(g,f,c)},this.init(),this.oscillatorInit(),Gibberish.defineUgenProperty("pan",0,this),this.processProperties(arguments)},Gibberish.Square=function(){this.__proto__=new Gibberish.Wavetable,this.name="square";for(var a=(2*Math.PI,new Float32Array(1024)),b=1024;b--;)a[b]=b/1024>.5?1:-1;this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw=function(){this.__proto__=new Gibberish.Wavetable,this.name="saw";for(var a=new Float32Array(1024),b=1024;b--;)a[b]=4*((b/1024/2+.25)%.5-.25);this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw2=function(){this.__proto__=new Gibberish.Saw,this.name="saw2";var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return c=b(g,f,c)},this.init(),Gibberish.defineUgenProperty("pan",0,this)},Gibberish.Triangle=function(){this.__proto__=new Gibberish.Wavetable,this.name="triangle";for(var a=new Float32Array(1024),b=Math.abs,c=1024;c--;)a[c]=1-4*b((c/1024+.25)%1-.5);this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Triangle2=function(){this.__proto__=new Gibberish.Triangle,this.name="triangle2";var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return b(g,f,c)},this.init(),this.oscillatorInit(),Gibberish.defineUgenProperty("pan",0,this),this.processProperties(arguments)},Gibberish.Saw3=function(){var a=0,b=0,c=2.5,d=-1.5,e=0,f=Math.sin,g=11;pi_2=2*Math.PI,flip=0,signHistory=0,ignore=!1,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"saw",properties:{frequency:440,amp:.15,sync:0,sr:Gibberish.context.sampleRate},callback:function(h){var i=h/sr,j=.5-i,k=g*j*j*j*j,l=.376-.752*i,m=1-2*i,n=0;return b+=i,b-=b>1?2:0,a=.5*(a+f(pi_2*(b+a*k))),n=c*a+d*e,e=a,n+=l,n*=m}}),Object.defineProperty(this,"scale",{get:function(){return g},set:function(a){g=a}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3.prototype=Gibberish._oscillator,Gibberish.PWM=function(){var a=0,b=0,c=0,d=0,e=0,f=2.5,g=-1.5,h=Math.sin,i=11;pi_2=2*Math.PI,test=0,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"pwm",properties:{frequency:440,amp:.15,pulsewidth:.05,sr:Gibberish.context.sampleRate},callback:function(j,k,l){var m=j/sr,n=.5-m,o=i*n*n*n*n,p=1-2*m,q=0;return e+=m,e-=e>1?2:0,a=.5*(a+h(pi_2*(e+a*o))),b=.5*(b+h(pi_2*(e+b*o+l))),q=b-a,q=f*q+g*(c-d),c=a,d=b,q*p*k}}),Object.defineProperty(this,"scale",{get:function(){return i},set:function(a){i=a}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.PWM.prototype=Gibberish._oscillator,Gibberish.Noise=function(){var a=Math.random;Gibberish.extend(this,{name:"noise",properties:{amp:1},callback:function(b){return(2*a()-1)*b}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Noise.prototype=Gibberish._oscillator,Gibberish.KarplusStrong=function(){var a=[0],b=0,c=Math.random,d=Gibberish.makePanner(),e=Gibberish.context.sampleRate,f=[0,0];Gibberish.extend(this,{name:"karplus_strong",frequency:0,properties:{blend:1,damping:0,amp:1,channels:2,pan:0},note:function(b){var d=Math.floor(e/b);a.length=0;for(var f=0;d>f;f++)a[f]=2*c()-1;this.frequency=b},callback:function(e,g,h,i,j){var k=a.shift(),l=c()>e?-1:1;g=g>0?g:0;var m=l*(k+b)*(.5-g/100);return b=m,a.push(m),m*=h,1===i?m:d(m,j,f)}}).init().oscillatorInit().processProperties(arguments)},Gibberish.KarplusStrong.prototype=Gibberish._oscillator,Gibberish.PolyKarplusStrong=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"poly_karplus_strong",maxVoices:5,voiceCount:0,_frequency:0,polyProperties:{blend:1,damping:0},note:function(a,b){var c=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),c.note(a,b),this._frequency=a},initVoices:function(){for(var a=0;a<this.maxVoices;a++){var b={blend:this.blend,damping:this.damping,channels:2,amp:1},c=new Gibberish.KarplusStrong(b).connect(this);this.children.push(c)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),this.initialized=!1,Gibberish._synth.oscillatorInit.call(this),Gibberish.dirty(this)},Gibberish.bus=function(){this.type="bus",this.inputCodegen=function(){var a,b=this.value.valueOf();return a=b+", "+this.amp,this.codeblock=a,a},this.addConnection=function(){var a=arguments[2],b={value:arguments[0],amp:arguments[1],codegen:this.inputCodegen,valueOf:function(){return this.codegen()}};"undefined"!=typeof a?this.inputs.splice(a,0,b):this.inputs.push(b),Gibberish.dirty(this)},this.removeConnection=function(a){for(var b=0;b<this.inputs.length;b++)if(this.inputs[b].value===a){this.inputs.splice(b,1),Gibberish.dirty(this);break}},this.adjustSendAmount=function(a,b){for(var c=0;c<this.inputs.length;c++)if(this.inputs[c].value===a){this.inputs[c].amp=b,Gibberish.dirty(this);break}},this.callback=function(){var a=arguments[arguments.length-2],b=arguments[arguments.length-1];output[0]=output[1]=0;for(var c=0;c<arguments.length-2;c+=2){var d="object"==typeof arguments[c],e=arguments[c+1];output[0]+=d?arguments[c][0]*e:arguments[c]*e,output[1]+=d?arguments[c][1]*e:arguments[c]*e}return output[0]*=a,output[1]*=a,panner(output,b,output)}},Gibberish.bus.prototype=new Gibberish.ugen,Gibberish._bus=new Gibberish.bus,Gibberish.Bus=function(){return Gibberish.extend(this,{name:"bus",properties:{inputs:[],amp:1},callback:function(){for(var a=0,b=arguments.length-1,c=arguments[b],d=0;b>d;d++)a+=arguments[d];return a*=c}}),this.init(),this.processProperties(arguments),this},Gibberish.Bus.prototype=Gibberish._bus,Gibberish.Bus2=function(){this.name="bus2",this.type="bus",this.properties={inputs:[],amp:1,pan:0};var a=[0,0],b=Gibberish.makePanner();this.callback=function(){var c=arguments,d=c.length,e=c[d-2],f=c[d-1];a[0]=a[1]=0;for(var g=0,h=d-2;h>g;g+=2){var i="object"==typeof c[g],j=c[g+1];a[0]+=i?c[g][0]*j||0:c[g]*j||0,a[1]+=i?c[g][1]*j||0:c[g]*j||0}return a[0]*=e,a[1]*=e,b(a,f,a)},this.show=function(){console.log(a,args)},this.getOutput=function(){return a},this.getArgs=function(){return args},this.init(arguments),this.processProperties(arguments)},Gibberish.Bus2.prototype=Gibberish._bus,Gibberish.envelope=function(){this.type="envelope"},Gibberish.envelope.prototype=new Gibberish.ugen,Gibberish._envelope=new Gibberish.envelope,Gibberish.ExponentialDecay=function(){var a=Math.pow,b=0,c=0;Gibberish.extend(this,{name:"ExponentialDecay",properties:{decay:.5,length:11050},callback:function(d,e){return b=a(d,c),c+=1/e,b},trigger:function(){c="number"==typeof arguments[0]?arguments[0]:0}}).init()},Gibberish.ExponentialDecay.prototype=Gibberish._envelope,Gibberish.Line=function(a,b,c,d){var e,f={name:"line",properties:{start:a||0,end:isNaN(b)?1:b,time:c||Gibberish.context.sampleRate,loops:d||!1},retrigger:function(a,b){g=0,this.start=e,this.end=a,this.time=b,h=(a-e)/b},getPhase:function(){return g},getIncr:function(){return h},getOut:function(){return e}},g=0,h=(b-a)/c;return this.callback=function(a,b,c,d){return e=c>g?a+g++*h:b,g=e>=b&&d?0:g,e},Gibberish.extend(this,f),this.init(),this},Gibberish.Line.prototype=Gibberish._envelope,Gibberish.AD=function(a,b){var c=0,d=0;Gibberish.extend(this,{name:"AD",properties:{attack:a||1e4,decay:b||1e4},run:function(){return d=0,c=0,this},callback:function(a,b){if(a=0>a?22050:a,b=0>b?22050:b,0===d){var e=1/a;c+=e,c>=1&&d++}else if(1===d){var e=1/b;c-=e,0>=c&&(c=0,d++)}return c},getState:function(){return d}}).init().processProperties(arguments)},Gibberish.AD.prototype=Gibberish._envelope,Gibberish.ADSR=function(a,b,c,d,e,f,g){var h={name:"adsr",type:"envelope",requireReleaseTrigger:"undefined"!=typeof g?g:!1,properties:{attack:isNaN(a)?1e4:a,decay:isNaN(b)?1e4:b,sustain:isNaN(c)?22050:c,release:isNaN(d)?1e4:d,attackLevel:e||1,sustainLevel:f||.5,releaseTrigger:0},run:function(){this.setPhase(0),this.setState(0)},stop:function(){this.releaseTrigger=1}};Gibberish.extend(this,h);var i=0,j=0,k=0,l=this;return this.callback=function(a,b,c,d,e,f,g){var h=0;return k=1===k?1:g,0===j?(h=i/a*e,++i/a>=1&&(j++,i=b)):1===j?(h=i/b*(e-f)+f,--i<=0&&(null!==c?(j+=1,i=c):(j+=2,i=d))):2===j?(h=f,l.requireReleaseTrigger&&k?(j++,i=d,l.releaseTrigger=0,k=0):i--<=0&&!l.requireReleaseTrigger&&(j++,i=d)):3===j&&(i--,h=i/d*f,0>=i&&j++),h},this.call=function(){return this.callback(this.attack,this.decay,this.sustain,this.release,this.attackLevel,this.sustainLevel,this.releaseTrigger)},this.getPhase=function(){return i},this.setPhase=function(a){i=a},this.setState=function(a){j=a,i=0},this.getState=function(){return j},this.init(),this},Gibberish.ADSR.prototype=Gibberish._envelope,Gibberish.ADR=function(a,b,c,d,e){var f={name:"adr",type:"envelope",properties:{attack:isNaN(a)?11025:a,decay:isNaN(b)?11025:b,release:isNaN(c)?22050:c,attackLevel:d||1,releaseLevel:e||.2},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,f);var g=0,h=0;return this.callback=function(a,b,c,d,e){var f=0;return 0===h?(f=g/a*d,++g/a===1&&(h++,g=b)):1===h?(f=g/b*(d-e)+e,--g<=0&&(h+=1,g=c)):2===h&&(g--,f=g/c*e,0>=g&&h++),f},this.setPhase=function(a){g=a},this.setState=function(a){h=a,g=0},this.getState=function(){return h},this.init(),this},Gibberish.ADR.prototype=Gibberish._envelope,Gibberish.analysis=function(){this.type="analysis",this.codegen=function(){if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];var a=this.variable?this.variable:Gibberish.generateSymbol("v");return Gibberish.memo[this.symbol]=a,this.variable=a,Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"();\n",-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),this.variable},this.analysisCodegen=function(){var a=0;this.input.codegen?(a=this.input.codegen(),a.indexOf("op")>-1&&console.log("ANALYSIS BUG")):a=this.input.value?"undefined"!=typeof this.input.value.codegen?this.input.value.codegen():this.input.value:"null";var b=this.analysisSymbol+"("+a+",";for(var c in this.properties)"input"!==c&&(b+=this[c]+",");return b=b.slice(0,-1),b+=");",this.analysisCodeblock=b,-1===Gibberish.analysisCodeblock.indexOf(this.analysisCodeblock)&&Gibberish.analysisCodeblock.push(this.analysisCodeblock),-1===Gibberish.callbackObjects.indexOf(this.analysisCallback)&&Gibberish.callbackObjects.push(this.analysisCallback),b},this.remove=function(){Gibberish.analysisUgens.splice(Gibberish.analysisUgens.indexOf(this),1)},this.analysisInit=function(){this.analysisSymbol=Gibberish.generateSymbol(this.name),Gibberish.analysisUgens.push(this),Gibberish.dirty()}},Gibberish.analysis.prototype=new Gibberish.ugen,Gibberish._analysis=new Gibberish.analysis,Gibberish.Follow=function(){this.name="follow",this.properties={input:0,bufferSize:4410,mult:1,useAbsoluteValue:!0};var a=Math.abs,b=[0],c=0,d=0,e=0;this.analysisCallback=function(f,g,h,i){"object"==typeof f&&(f=f[0]+f[1]),c+=i?a(f):f,c-=b[d],b[d]=i?a(f):f,d=(d+1)%g,b[d]=b[d]?b[d]:0,e=c/g*h},this.callback=this.getValue=function(){return e},this.init(),this.analysisInit(),this.processProperties(arguments);var f=(this.__lookupSetter__("bufferSize"),this.bufferSize);Object.defineProperty(this,"bufferSize",{get:function(){return f},set:function(a){f=a,c=0,b=[0],d=0}})},Gibberish.Follow.prototype=Gibberish._analysis,Gibberish.SingleSampleDelay=function(){this.name="single_sample_delay",this.properties={input:arguments[0]||0,amp:arguments[1]||1};var a=0;this.analysisCallback=function(b){a=b},this.callback=function(){return a},this.getValue=function(){return a},this.init(),this.analysisInit(),this.processProperties(arguments)},Gibberish.SingleSampleDelay.prototype=Gibberish._analysis,Gibberish.Record=function(a,b,c){var d=new Float32Array(b),e=0,f=!1,g=this;Gibberish.extend(this,{name:"record",oncomplete:c,properties:{input:0,size:b||0},analysisCallback:function(a,b){
f&&(d[e++]="object"==typeof a?a[0]+a[1]:a,e>=b&&(f=!1,g.remove()))},record:function(){return e=0,f=!0,this},getBuffer:function(){return d},getPhase:function(){return e},remove:function(){"undefined"!=typeof this.oncomplete&&this.oncomplete();for(var a=0;a<Gibberish.analysisUgens.length;a++){var b=Gibberish.analysisUgens[a];if(b===this)return Gibberish.callbackArgs.indexOf(this.analysisSymbol)>-1&&Gibberish.callbackArgs.splice(Gibberish.callbackArgs.indexOf(this.analysisSymbol),1),Gibberish.callbackObjects.indexOf(this.analysisCallback)>-1&&Gibberish.callbackObjects.splice(Gibberish.callbackObjects.indexOf(this.analysisCallback),1),void Gibberish.analysisUgens.splice(a,1)}}}),this.properties.input=a,this.init(),this.analysisInit(),Gibberish.dirty()},Gibberish.Record.prototype=Gibberish._analysis,Gibberish.effect=function(){this.type="effect"},Gibberish.effect.prototype=new Gibberish.ugen,Gibberish._effect=new Gibberish.effect,Gibberish.Distortion=function(){var a=Math.abs,b=Math.log,c=Math.LN2;Gibberish.extend(this,{name:"distortion",properties:{input:0,amount:50},callback:function(d,e){var f;return e=e>2?e:2,"number"==typeof d?(f=d*e,d=f/(1+a(f))/(b(e)/c)):(f=d[0]*e,d[0]=f/(1+a(f))/(b(e)/c),f=d[1]*e,d[1]=f/(1+a(f))/(b(e)/c)),d}}).init().processProperties(arguments)},Gibberish.Distortion.prototype=Gibberish._effect,Gibberish.Gain=function(){Gibberish.extend(this,{name:"gain",properties:{input:0,amount:1},callback:function(a,b){return"number"==typeof a?a*=b:(a[0]*=b,a[1]*=b),a}}).init().processProperties(arguments)},Gibberish.Gain.prototype=Gibberish._effect,Gibberish.Delay=function(){var a=[],b=0;a.push(new Float32Array(2*Gibberish.context.sampleRate)),a.push(new Float32Array(2*Gibberish.context.sampleRate)),Gibberish.extend(this,{name:"delay",properties:{input:0,time:22050,feedback:.5,wet:1,dry:1},callback:function(c,d,e,f,g){var h="number"==typeof c?1:2,i=b++%88200,j=(i+(0|d))%88200;return 1===h?(a[0][j]=(c+a[0][i])*e,c=c*g+a[0][i]*f):(a[0][j]=(c[0]+a[0][i])*e,c[0]=c[0]*g+a[0][i]*f,a[1][j]=(c[1]+a[1][i])*e,c[1]=c[1]*g+a[1][i]*f),c}});var c=Math.round(this.properties.time);Object.defineProperty(this,"time",{configurable:!0,get:function(){return c},set:function(a){c=Math.round(a),Gibberish.dirty(this)}}),this.init(),this.processProperties(arguments)},Gibberish.Delay.prototype=Gibberish._effect,Gibberish.Decimator=function(){var a=0,b=[],c=Math.pow,d=Math.floor;Gibberish.extend(this,{name:"decimator",properties:{input:0,bitDepth:16,sampleRate:1},callback:function(e,f,g){a+=g;var h="number"==typeof e?1:2;if(1===h){if(a>=1){var i=c(f,2);b[0]=d(e*i)/i,a-=1}e=b[0]}else{if(a>=1){var i=c(f,2);b[0]=d(e[0]*i)/i,b[1]=d(e[1]*i)/i,a-=1}e=b}return e}}).init().processProperties(arguments)},Gibberish.Decimator.prototype=Gibberish._effect,Gibberish.RingModulation=function(){var a=(new Gibberish.Sine).callback,b=[0,0];Gibberish.extend(this,{name:"ringmod",properties:{input:0,frequency:440,amp:.5,mix:.5},callback:function(c,d,e,f){var g="number"==typeof c?1:2,h=1===g?c:c[0],i=a(d,e);if(h=h*(1-f)+h*i*f,2===g){var j=c[1];return j=j*(1-f)+j*i*f,b[0]=h,b[1]=j,b}return h}}).init().processProperties(arguments)},Gibberish.RingModulation.prototype=Gibberish._effect,Gibberish.DCBlock=function(){var a=0,b=0;Gibberish.extend(this,{name:"dcblock",type:"effect",properties:{input:0},reset:function(){a=0,b=0},callback:function(c){var d=c-a+.9997*b;return a=c,b=d,d}}).init().processProperties(arguments)},Gibberish.DCBlock.prototype=Gibberish._effect,Gibberish.Tremolo=function(){var a=(new Gibberish.Sine).callback;Gibberish.extend(this,{name:"tremolo",type:"effect",properties:{input:0,frequency:2.5,amp:.5},callback:function(b,c,d){var e="number"==typeof b?1:2,f=a(c,d);return 1===e?b*=f:(b[0]*=f,b[1]*=f),b}}).init().processProperties(arguments)},Gibberish.Tremolo.prototype=Gibberish._effect,Gibberish.OnePole=function(){var a=0;Gibberish.extend(this,{name:"onepole",type:"effect",properties:{input:0,a0:.15,b1:.85},callback:function(b,c,d){var e=b*c+a*d;return a=e,e},smooth:function(b,c){this.input=c[b],a=this.input,c[b]=this,this.obj=c,this.property=b,this.oldSetter=c.__lookupSetter__(b),this.oldGetter=c.__lookupGetter__(b);var d=this;Object.defineProperty(c,b,{get:function(){return d.input},set:function(a){d.input=a}})},remove:function(){Object.defineProperty(this.obj,this.property,{get:this.oldGetter,set:this.oldSetter}),this.obj[this.property]=this.input}}).init().processProperties(arguments)},Gibberish.OnePole.prototype=Gibberish._effect,Gibberish.Filter24=function(){var a=[0,0,0,0],b=[0,0,0,0],c=[0,0],d=isNaN(arguments[0])?.1:arguments[0],e=isNaN(arguments[1])?3:arguments[1];_isLowPass="undefined"!=typeof arguments[2]?arguments[2]:!0,Gibberish.extend(this,{name:"filter24",properties:{input:0,cutoff:d,resonance:e,isLowPass:_isLowPass},callback:function(d,e,f,g){var h="number"==typeof d?1:2,i=1===h?d:d[0],j=a[3]*f;if(j=j>1?1:j,e=0>e?0:e,e=e>1?1:e,i-=j,a[0]=a[0]+(-a[0]+i)*e,a[1]=a[1]+(-a[1]+a[0])*e,a[2]=a[2]+(-a[2]+a[1])*e,a[3]=a[3]+(-a[3]+a[2])*e,i=g?a[3]:i-a[3],2===h){var k=d[1];return j=b[3]*f,j=j>1?1:j,k-=j,b[0]=b[0]+(-b[0]+k)*e,b[1]=b[1]+(-b[1]+b[0])*e,b[2]=b[2]+(-b[2]+b[1])*e,b[3]=b[3]+(-b[3]+b[2])*e,k=g?b[3]:k-b[3],c[0]=i,c[1]=k,c}return i}}).init().processProperties(arguments)},Gibberish.Filter24.prototype=Gibberish._effect,Gibberish.SVF=function(){var a=[0,0],b=[0,0],c=Math.PI,d=[0,0];Gibberish.extend(this,{name:"SVF",properties:{input:0,cutoff:440,Q:2,mode:0,sr:Gibberish.context.sampleRate},callback:function(e,f,g,h,i){var j="number"==typeof e?1:2,k=1===j?e:e[0],l=2*c*f/i;g=1/g;var m=b[0]+l*a[0],n=k-m-g*a[0],o=l*n+a[0],p=n+m;if(a[0]=o,b[0]=m,k=0===h?m:1===h?n:2===h?o:p,2===j){var q=e[1],m=b[1]+l*a[1],n=q-m-g*a[1],o=l*n+a[1],p=n+m;a[1]=o,b[1]=m,q=0===h?m:1===h?n:2===h?o:p,d[0]=k,d[1]=q}else d=k;return d}}).init().processProperties(arguments)},Gibberish.SVF.prototype=Gibberish._effect,Gibberish.Biquad=function(){var a=x2=y1=y2=0,b=[0,0],c=.001639,d=.003278,e=.001639,f=-1.955777,g=.960601,h="LP",i=2e3,j=.5,k=Gibberish.context.sampleRate;Gibberish.extend(this,{name:"biquad",properties:{input:null},calculateCoefficients:function(){switch(h){case"LP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),m=b/(2*j);c=(1-l)/2,d=1-l,e=c,a0=1+m,f=-2*l,g=1-m;break;case"HP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),m=b/(2*j);c=(1+l)/2,d=-(1+l),e=c,a0=1+m,f=-2*l,g=1-m;break;case"BP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),n=Math.log(2)/2*j*a/b,m=b*(Math.exp(n)-Math.exp(-n))/2;c=m,d=0,e=-m,a0=1+m,f=-2*l,g=1-m;break;default:return}c/=a0,d/=a0,e/=a0,f/=a0,g/=a0},callback:function(h){var i="number"==typeof h?1:2,j=0,k=0,l=1===i?h:h[0];return j=c*l+d*a+e*x2-f*y1-g*y2,x2=a,a=h,y2=y1,y1=j,2===i&&(inR=h[1],k=c*inR+d*a[1]+e*x2[1]-f*y1[1]-g*y2[1],x2[1]=a[1],a[1]=h[1],y2[1]=y1[1],y1[1]=k,b[0]=j,b[1]=k),1===i?j:b}}).init(),Object.defineProperties(this,{mode:{get:function(){return h},set:function(a){h=a,this.calculateCoefficients()}},cutoff:{get:function(){return i},set:function(a){i=a,this.calculateCoefficients()}},Q:{get:function(){return j},set:function(a){j=a,this.calculateCoefficients()}}}),this.processProperties(arguments),this.calculateCoefficients()},Gibberish.Biquad.prototype=Gibberish._effect,Gibberish.Flanger=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=(new Gibberish.Sine).callback,d=Gibberish.interpolate,e=-100,f=0;Gibberish.extend(this,{name:"flanger",properties:{input:0,rate:.25,feedback:0,amount:125,offset:125},callback:function(g,h,i,j){var k="number"==typeof g?1:2,l=e+c(h,.95*j);l>b?l-=b:0>l&&(l+=b);var m=d(a[0],l);return a[0][f]=1===k?g+m*i:g[0]+m*i,2===k?(g[0]+=m,m=d(a[1],l),a[1][f]=g[1]+m*i,g[1]+=m):g+=m,++f>=b&&(f=0),++e>=b&&(e=0),g}}).init().processProperties(arguments),e=-1*this.offset},Gibberish.Flanger.prototype=Gibberish._effect,Gibberish.Vibrato=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=(new Gibberish.Sine).callback,d=Gibberish.interpolate,e=-100,f=0;Gibberish.extend(this,{name:"vibrato",properties:{input:0,rate:5,amount:.5,offset:125},callback:function(g,h,i,j){var k="number"==typeof g?1:2,l=e+c(h,i*j-1);l>b?l-=b:0>l&&(l+=b);var m=d(a[0],l);return a[0][f]=1===k?g:g[0],2===k?(g[0]=m,m=d(a[1],l),a[1][f]=g[1],g[1]=m):g=m,++f>=b&&(f=0),++e>=b&&(e=0),g}}).init().processProperties(arguments),e=-1*this.offset},Gibberish.Vibrato.prototype=Gibberish._effect,Gibberish.BufferShuffler=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=0,d=0,e=0,f=0,g=0,h=Math.random,i=1,j=!1,k=!1,l=!1,m=Gibberish.interpolate,n=!1,o=1,p=!1,q=Gibberish.rndf,r=[0,0];Gibberish.extend(this,{name:"buffer_shuffler",properties:{input:0,chance:.25,rate:11025,length:22050,reverseChange:.5,pitchChance:.5,pitchMin:.25,pitchMax:2,wet:1,dry:0},callback:function(s,t,u,v,w,x,y,z,A,B){var C="number"==typeof s?1:2;g?++f%(v-400)===0&&(j=!1,k=!0,i=1,f=0):(a[0][d]=1===C?s:s[0],a[1][d]=1===C?s:s[1],d++,d%=b,p=0===d?1:p,e++,e%u==0&&h()<t&&(l=h()<w,g=!0,l||(c=d-v,0>c&&(c=b+c)),n=h()<x,n&&(o=q(y,z)),i=1,j=!0,k=!1)),c+=l?-1*o:o,0>c?c+=b:c>=b&&(c-=b);var D,E,F,G,H=m(a[0],c);return j?(i-=.0025,F=H*(1-i),D=1===C?F+s*i:F+s[0]*i,2===C&&(G=m(a[1],c),F=G*(1-i),E=1===C?D:F+s[1]*i),.0025>=i&&(j=!1)):k?(i-=.0025,F=H*i,D=1===C?F+s*i:F+s[0]*(1-i),2===C&&(G=m(a[1],c),F=G*i,E=F+s[1]*(1-i)),.0025>=i&&(k=!1,g=!1,l=!1,o=1,n=0)):1===C?D=g&&p?H*A+s*B:s:(G=m(a[1],c),D=g&&p?H*A+s[0]*B:s[0],E=g&&p?G*A+s[1]*B:s[1]),r=[D,E],1===C?D:r}}).init().processProperties(arguments)},Gibberish.BufferShuffler.prototype=Gibberish._effect,Gibberish.AllPass=function(a){var b=-1,c=new Float32Array(a||500),d=c.length;Gibberish.extend(this,{name:"allpass",properties:{input:0},callback:function(a){b=++b%d;var e=c[b],f=-1*a+e;return c[b]=a+.5*e,f}})},Gibberish.Comb=function(a){var b=new Float32Array(a||1200),c=b.length,d=0,e=0;Gibberish.extend(this,{name:"comb",properties:{input:0,feedback:.84,damping:.2},callback:function(a,f,g){var h=++d%c,i=b[h];return e=i*(1-g)+e*g,b[h]=a+e*f,i}})},Gibberish.Reverb=function(){var a={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.4,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},b=.84,c=[],d=[],e=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,properties:{input:0,wet:.5,dry:.55,roomSize:.84,damping:.5},callback:function(a,b,f,g,h){for(var i="object"==typeof a?2:1,j=1===i?a:a[0]+a[1],k=.015*j,l=k,m=0;8>m;m++){var n=c[m](k,.98*g,.4*h);l+=n}for(var m=0;4>m;m++)l=d[m](l);return e[0]=e[1]=j*f+l*b,e}}).init().processProperties(arguments),this.setFeedback=function(a){b=a};for(var f=0;8>f;f++)c.push(new Gibberish.Comb(a.combTuning[f]).callback);for(var f=0;4>f;f++)d.push(new Gibberish.AllPass(a.allPassTuning[f],a.allPassFeedback).callback)},Gibberish.Reverb.prototype=Gibberish._effect,Gibberish.StereoReverb=function(){var a={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.4,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},b=.84,c=[],d=[],e=[],f=[],g=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,properties:{input:0,wet:.5,dry:.55,roomSize:.84,damping:.5},callback:function(a,b,h,i,j){for(var k="object"==typeof a?2:1,l=a[0],m=1===k?l:a[1],n=outL=.015*l,o=outR=.015*m,p=0;8>p;p++)outL+=c[p](n,.98*i,.4*j),outR+=d[p](o,.98*i,.4*j);for(var p=0;4>p;p++)outL=e[p](outL),outR=f[p](outR);return g[0]=l*h+outL*b,g[1]=m*h+outR*b,g}}).init().processProperties(arguments),this.setFeedback=function(a){b=a};for(var h=0;8>h;h++)c.push(new Gibberish.Comb(a.combTuning[h]).callback),d.push(new Gibberish.Comb(a.combTuning[h]).callback);for(var h=0;4>h;h++)e.push(new Gibberish.AllPass(a.allPassTuning[h],a.allPassFeedback).callback),f.push(new Gibberish.AllPass(a.allPassTuning[h],a.allPassFeedback).callback)},Gibberish.StereoReverb.prototype=Gibberish._effect,Gibberish.Granulator=function(a){var b=[];buffer=null,interpolate=Gibberish.interpolate,panner=Gibberish.makePanner(),bufferLength=0,debug=0,write=0,self=this,out=[0,0],_out=[0,0],rndf=Gibberish.rndf,numberOfGrains=a.numberOfGrains||20,Gibberish.extend(this,{name:"granulator",bufferLength:88200,reverse:!0,spread:.5,properties:{speed:1,speedMin:-0,speedMax:0,grainSize:1e3,position:.5,positionMin:0,positionMax:0,amp:.2,fade:.1,pan:0,shouldWrite:!1},setBuffer:function(a){buffer=a,bufferLength=a.length},callback:function(a,c,d,e,f,g,h,i,j,k){for(var l=0;l<numberOfGrains;l++){var m=b[l];if(m._speed>0){m.pos>m.end&&(m.pos=(h+rndf(f,g))*buffer.length,m.start=m.pos,m.end=m.start+e,m._speed=a+rndf(c,d),m._speed=m._speed<.1?.1:m._speed,m._speed=m._speed<.1&&m._speed>0?.1:m._speed,m._speed=m._speed>-.1&&m._speed<0?-.1:m._speed,m.fadeAmount=m._speed*j*e,m.pan=rndf(-1*self.spread,self.spread));for(var n=m.pos;n>buffer.length;)n-=buffer.length;for(;0>n;)n+=buffer.length;var o=interpolate(buffer,n);o*=m.pos<m.fadeAmount+m.start?(m.pos-m.start)/m.fadeAmount:1,o*=m.pos>m.end-m.fadeAmount?(m.end-m.pos)/m.fadeAmount:1}else{m.pos<m.end&&(m.pos=(h+rndf(f,g))*buffer.length,m.start=m.pos,m.end=m.start-e,m._speed=a+rndf(c,d),m._speed=m._speed<.1&&m._speed>0?.1:m._speed,m._speed=m._speed>-.1&&m._speed<0?-.1:m._speed,m.fadeAmount=m._speed*j*e);for(var n=m.pos;n>buffer.length;)n-=buffer.length;for(;0>n;)n+=buffer.length;var o=interpolate(buffer,n);o*=m.pos>m.start-m.fadeAmount?(m.start-m.pos)/m.fadeAmount:1,o*=m.pos<m.end+m.fadeAmount?(m.end-m.pos)/m.fadeAmount:1}_out=panner(o*i,m.pan,_out),out[0]+=_out[0],out[1]+=_out[1],m.pos+=m._speed}return panner(out,k,out)}}).init().processProperties(arguments);for(var c=0;c<numberOfGrains;c++)b[c]={pos:self.position+Gibberish.rndf(self.positionMin,self.positionMax),_speed:self.speed+Gibberish.rndf(self.speedMin,self.speedMax)},b[c].start=b[c].pos,b[c].end=b[c].pos+self.grainSize,b[c].fadeAmount=b[c]._speed*self.fade*self.grainSize,b[c].pan=Gibberish.rndf(-1*self.spread,self.spread);"undefined"!=typeof a.buffer&&(buffer=a.buffer,bufferLength=buffer.length)},Gibberish.Granulator.prototype=Gibberish._effect,Gibberish.synth=function(){this.type="oscillator",this.oscillatorInit=function(){this.fx=new Array2,this.fx.parent=this}},Gibberish.synth.prototype=new Gibberish.ugen,Gibberish._synth=new Gibberish.synth,Gibberish.Synth=function(a){this.name="synth",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,glide:.15,amp:.25,channels:2,pan:0,sr:Gibberish.context.sampleRate},this.note=function(d,e){if(0!==e){if("object"!=typeof this.frequency){if(b&&d===k&&a.requireReleaseTrigger)return this.releaseTrigger=1,void(k=null);this.frequency=k=d,this.releaseTrigger=0,"object"==typeof d&&Gibberish.dirty(this)}else this.frequency[0]=k=d,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof e&&(this.amp=e),c.run()}else this.releaseTrigger=1},a=a||{};var b="undefined"==typeof a.useADSR?!1:a.useADSR,c=b?new Gibberish.ADSR:new Gibberish.AD,d=c.getState,e=c.callback,f=new Gibberish.PWM,g=f.callback,h=(new Gibberish.OnePole).callback,i=Gibberish.makePanner(),j=this,k=0,l=[0,0];c.requireReleaseTrigger=a.requireReleaseTrigger||!1,this.callback=function(a,c,f,k,m,n,o,p,q,r,s,t,u,v){r=r>=1?.99999:r,a=h(a,1-r,r);var w,x;return b?(w=e(f,k,m,n,o,p,q),q&&(j.releaseTrigger=0),d()<4?(x=g(a,1,c,v)*w*s,1===t?x:i(x,u,l)):(x=l[0]=l[1]=0,1===t?x:l)):d()<2?(w=e(f,k),x=g(a,1,c,v)*w*s,1===t?x:i(x,u,l)):(x=l[0]=l[1]=0,1===t?x:l)},this.getEnv=function(){return c},this.getOsc=function(){return f},this.setOsc=function(a){f=a,g=f.callback};var m="PWM";Object.defineProperty(this,"waveform",{get:function(){return m},set:function(a){this.setOsc(new Gibberish[a])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth.prototype=Gibberish._synth,Gibberish.PolySynth=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth",maxVoices:5,voiceCount:0,frequencies:[],_frequency:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,pulsewidth:.5,waveform:"PWM"},note:function(a,b){var c=this.frequencies.indexOf(a),d=c>-1?c:this.voiceCount++,e=this.children[d];e.note(a,b),-1===c?(this.frequencies[d]=a,this._frequency=a,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[d]},initVoices:function(){for(var a=0;a<this.maxVoices;a++){var b={waveform:this.waveform,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,pulsewidth:this.pulsewidth,channels:2,amp:1,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1},c=new Gibberish.Synth(b).connect(this);this.children.push(c)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Synth2=function(a){this.name="synth2",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,cutoff:.25,resonance:3.5,useLowPassFilter:!0,glide:.15,amp:.25,channels:1,pan:0,sr:Gibberish.context.sampleRate},this.note=function(d,e){if(0!==e){if("object"!=typeof this.frequency){if(b&&d===l&&a.requireReleaseTrigger)return this.releaseTrigger=1,void(l=null);this.frequency=l=d,this.releaseTrigger=0,"object"==typeof d&&Gibberish.dirty(this)}else this.frequency[0]=l=d,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof e&&(this.amp=e),c.run()}else this.releaseTrigger=1},a=a||{};var b="undefined"==typeof a.useADSR?!1:a.useADSR,c=b?new Gibberish.ADSR:new Gibberish.AD,d=c.getState,e=c.callback,f=new Gibberish.PWM,g=f.callback,h=new Gibberish.Filter24,i=h.callback,j=(new Gibberish.OnePole).callback,k=Gibberish.makePanner(),l=0,m=this,n=[0,0];c.requireReleaseTrigger=a.requireReleaseTrigger||!1,this.callback=function(a,c,f,h,l,o,p,q,r,s,t,u,v,w,x,y,z){v=v>=1?.99999:v,a=j(a,1-v,v);var A,B;return b?(A=e(f,h,l,o,p,q,r),r&&(m.releaseTrigger=0),d()<4?(B=i(g(a,.15,c,z),s*A,t,u)*A*w,1===x?B:k(B,y,n)):(B=n[0]=n[1]=0,1===x?B:n)):d()<2?(A=e(f,h),B=i(g(a,.15,c,z),s*A,t,u)*A*w,1===x?B:k(B,y,n)):(B=n[0]=n[1]=0,1===x?B:n)},this.getUseADSR=function(){return b},this.getEnv=function(){return c},this.getOsc=function(){return f},this.setOsc=function(a){f=a,g=f.callback};var o="PWM";Object.defineProperty(this,"waveform",{get:function(){return o},set:function(a){this.setOsc(new Gibberish[a])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth2.prototype=Gibberish._synth,Gibberish.PolySynth2=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth2",maxVoices:5,voiceCount:0,frequencies:[],_frequency:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,pulsewidth:.5,resonance:3.5,cutoff:.25,useLowPassFilter:!0,waveform:"PWM"},note:function(a,b){var c=this.frequencies.indexOf(a),d=c>-1?c:this.voiceCount++,e=this.children[d];e.note(a,b),-1===c?(this.frequencies[d]=a,this._frequency=a,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[d]},initVoices:function(){this.dirty=!0;for(var a=0;a<this.maxVoices;a++){var b={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,pulsewidth:this.pulsewidth,channels:2,amp:1,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1},c=new Gibberish.Synth2(b).connect(this);this.children.push(c)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.FMSynth=function(a){this.name="fmSynth",this.properties={frequency:0,cmRatio:2,index:5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,glide:.15,amp:.25,channels:2,pan:0},this.note=function(d,e){if(0!==e){if("object"!=typeof this.frequency){if(b&&d===l&&a.requireReleaseTrigger)return this.releaseTrigger=1,void(l=null);this.frequency=l=d,this.releaseTrigger=0,"object"==typeof d&&Gibberish.dirty(this)}else this.frequency[0]=l=d,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof e&&(this.amp=e),c.run()}else this.releaseTrigger=1},a=a||{};var b="undefined"==typeof a.useADSR?!1:a.useADSR,c=b?new Gibberish.ADSR:new Gibberish.AD,d=c.getState,e=c.callback,f=(new Gibberish.Sine).callback,g=(new Gibberish.Sine).callback,h=(new Gibberish.OnePole).callback,i=Gibberish.makePanner(),j=[0,0],k=this,l=0;c.requireReleaseTrigger=a.requireReleaseTrigger||!1,this.callback=function(a,c,l,m,n,o,p,q,r,s,t,u,v,w){var x,y,z;return t>=1&&(t=.9999),a=h(a,1-t,t),b?(x=e(m,n,o,p,q,r,s),s&&(k.releaseTrigger=0),d()<4?(z=g(a*c,a*l)*x,y=f(a+z,1)*x*u,1===v?y:i(y,w,j)):(y=j[0]=j[1]=0,1===v?y:j)):d()<2?(x=e(m,n),z=g(a*c,a*l)*x,y=f(a+z,1)*x*u,1===v?y:i(y,w,j)):(y=j[0]=j[1]=0,1===v?y:j)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.FMSynth.prototype=Gibberish._synth,Gibberish.PolyFM=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polyfm",maxVoices:5,voiceCount:0,children:[],frequencies:[],_frequency:0,polyProperties:{glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,index:5,cmRatio:2},note:function(a,b){var c=this.frequencies.indexOf(a),d=c>-1?c:this.voiceCount++,e=this.children[d];e.note(a,b),-1===c?(this.frequencies[d]=a,this._frequency=a,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[d]},initVoices:function(){for(var a=0;a<this.maxVoices;a++){var b={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,cmRatio:this.cmRatio,index:this.index,channels:2,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1,amp:1},c=new Gibberish.FMSynth(b);c.connect(this),this.children.push(c)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Sampler=function(){function a(a){Gibberish.context.decodeAudioData(a,function(a){f=a.getChannelData(0),h.length=b=h.end=g=f.length,h.isPlaying=!0,h.buffers[h.file]=f,console.log("sample loaded | ",h.file," | length | ",g),Gibberish.audioFiles[h.file]=f,h.onload&&h.onload(),0!==h.playOnLoad&&h.note(h.playOnLoad),h.isLoaded=!0},function(a){console.log("Error decoding file",a)})}var b=1,c=Gibberish.interpolate,d=Gibberish.makePanner(),e=[0,0],f=null,g=1,h=this;if(Gibberish.extend(this,{name:"sampler",file:null,isLoaded:!1,playOnLoad:0,buffers:{},properties:{pitch:1,amp:1,isRecording:!1,isPlaying:!0,input:0,length:0,start:0,end:1,loops:0,pan:0},_onload:function(a){f=a.channels[0],g=a.length,h.end=g,h.length=b=g,h.isPlaying=!0,Gibberish.audioFiles[h.file]=f,h.buffers[h.file]=f,h.onload&&h.onload(),0!==h.playOnLoad&&h.note(h.playOnLoad),h.isLoaded=!0},switchBuffer:function(a){if("string"==typeof a)"undefined"!=typeof h.buffers[a]&&(f=h.buffers[a],g=h.end=h.length=f.length);else if("number"==typeof a){var b=Object.keys(h.buffers);if(0===b.length)return;f=h.buffers[b[a]],g=h.end=h.length=f.length}},floatTo16BitPCM:function(a,b,c){for(var d=0;d<c.length-1;d++,b+=2){var e=Math.max(-1,Math.min(1,c[d]));a.setInt16(b,0>e?32768*e:32767*e,!0)}},encodeWAV:function(){function a(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))}var b=this.getBuffer(),c=new ArrayBuffer(44+2*b.length),d=new DataView(c),e=Gibberish.context.sampleRate;return a(d,0,"RIFF"),d.setUint32(4,32+2*b.length,!0),a(d,8,"WAVE"),a(d,12,"fmt "),d.setUint32(16,16,!0),d.setUint16(20,1,!0),d.setUint16(22,1,!0),d.setUint32(24,e,!0),d.setUint32(28,4*e,!0),d.setUint16(32,2,!0),d.setUint16(34,16,!0),a(d,36,"data"),d.setUint32(40,2*b.length,!0),this.floatTo16BitPCM(d,44,b),d},download:function(){var a=this.encodeWAV(),b=new Blob([a]),c=window.webkitURL.createObjectURL(b),d=window.document.createElement("a");d.href=c,d.download="output.wav";var e=document.createEvent("Event");e.initEvent("click",!0,!0),d.dispatchEvent(e)},note:function(a,c){switch(typeof a){case"number":this.pitch=a;break;case"function":this.pitch=a();break;case"object":this.pitch=Array.isArray(a)?a[0]:a}if("number"==typeof c&&(this.amp=c),null!==this["function"]){this.isPlaying=!0;var d;switch(typeof this.pitch){case"number":d=this.pitch;break;case"function":d=this.pitch.getValue?this.pitch.getValue():this.pitch();break;case"object":d=Array.isArray(this.pitch)?this.pitch[0]:this.pitch.getValue?this.pitch.getValue():this.pitch.input.getValue(),"function"==typeof d&&(d=d())}b=d>0?this.start:this.end,Gibberish.dirty(this)}},getBuffer:function(){return f},setBuffer:function(a){f=a},getPhase:function(){return b},setPhase:function(a){b=a},getNumberOfBuffers:function(){return Object.keys(h.buffers).length-1},callback:function(a,g,h,i,j,k,l,m,n,o){var p=0;return b+=a,m>b&&b>0?(a>0?p=null!==f&&i?c(f,b):0:b>l?p=null!==f&&i?c(f,b):0:b=n?m:b,d(p*g,o,e)):(b=n&&a>0?l:b,b=n&&0>a?m:b,e[0]=e[1]=p,e)}}).init().oscillatorInit().processProperties(arguments),"undefined"!=typeof arguments[0]&&("string"==typeof arguments[0]?(this.file=arguments[0],this.pitch=0):"object"==typeof arguments[0]&&arguments[0].file&&(this.file=arguments[0].file)),"undefined"!=typeof Gibberish.audioFiles[this.file])f=Gibberish.audioFiles[this.file],this.end=this.bufferLength=f.length,this.buffers[this.file]=f,b=this.bufferLength,Gibberish.dirty(this),this.onload&&this.onload();else if(null!==this.file){var a,i=new XMLHttpRequest;i.open("GET",this.file,!0),i.responseType="arraybuffer",i.onload=function(){a(this.response)},i.send(),console.log("now loading sample",h.file),i.onerror=function(a){console.error("Sampler file loading error",a)}}else"undefined"!=typeof this.buffer&&(this.isLoaded=!0,f=this.buffer,this.end=this.bufferLength=f.length||88200,b=this.bufferLength,arguments[0]&&arguments[0].loops&&(this.loops=1),Gibberish.dirty(this),this.onload&&this.onload())},Gibberish.Sampler.prototype=Gibberish._oscillator,Gibberish.Sampler.prototype.record=function(a,b){this.isRecording=!0;var c=this;return this.recorder=new Gibberish.Record(a,b,function(){c.setBuffer(this.getBuffer()),c.end=bufferLength=c.getBuffer().length,c.setPhase(c.end),c.isRecording=!1}).record(),this},Gibberish.MonoSynth=function(){Gibberish.extend(this,{name:"monosynth",properties:{attack:1e4,decay:1e4,cutoff:.2,resonance:2.5,amp1:1,amp2:1,amp3:1,filterMult:.3,isLowPass:!0,pulsewidth:.5,amp:.6,detune2:.01,detune3:-.01,octave2:1,octave3:-1,glide:0,pan:0,frequency:0,channels:2},waveform:"Saw3",note:function(a,d){"undefined"!=typeof d&&0!==d&&(this.amp=d),0!==d&&("object"!=typeof this.frequency?this.frequency=a:(this.frequency[0]=a,Gibberish.dirty(this)),c()>0&&b.run())},_note:function(a,c){if("object"!=typeof this.frequency){if(useADSR&&a===lastFrequency&&0===c)return this.releaseTrigger=1,void(lastFrequency=null);0!==c&&(this.frequency=lastFrequency=a),this.releaseTrigger=0}else 0!==c&&(this.frequency[0]=lastFrequency=a),this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof c&&0!==c&&(this.amp=c),0!==c&&b.run()}});var a=this.waveform;Object.defineProperty(this,"waveform",{get:function(){return a},set:function(b){a!==b&&(a=b,f=(new Gibberish[b]).callback,g=(new Gibberish[b]).callback,h=(new Gibberish[b]).callback)}});var b=new Gibberish.AD(this.attack,this.decay),c=b.getState,d=b.callback,e=(new Gibberish.Filter24).callback,f=new Gibberish[this.waveform](this.frequency,this.amp1).callback,g=new Gibberish[this.waveform](this.frequency2,this.amp2).callback,h=new Gibberish[this.waveform](this.frequency3,this.amp3).callback,i=(new Gibberish.OnePole).callback,j=Gibberish.makePanner(),k=[0,0];this.envelope=b,this.callback=function(a,b,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){if(c()<2){y>=1&&(y=.9999),A=i(A,1-y,y);var C=A;if(w>0)for(var D=0;w>D;D++)C*=2;else if(0>w)for(var D=0;D>w;D--)C/=2;var E=A;if(x>0)for(var D=0;x>D;D++)E*=2;else if(0>x)for(var D=0;D>x;D--)E/=2;C+=u>0?(2*A-A)*u:(A-A/2)*u,E+=v>0?(2*A-A)*v:(A-A/2)*v;var F=f(A,n,s)+g(C,o,s)+h(E,p,s),G=d(a,b),H=e(F,l+q*G,m,r,1)*G;return H*=t,k[0]=k[1]=H,1===B?k:j(H,z,k)}return k[0]=k[1]=0,k},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.MonoSynth.prototype=Gibberish._synth,Gibberish.Binops={"export":function(a){Gibberish["export"]("Binops",a||window)},operator:function(){var a=new Gibberish.ugen,b=arguments[0],c=Array.prototype.slice.call(arguments,1);a.name="op",a.properties={};for(var d=0;d<c.length;d++)a.properties[d]=c[d];return a.init.apply(a,c),a.codegen=function(){var a,c="( ";if("undefined"!=typeof Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];a=Object.keys(this.properties);for(var d=!1,e=0;e<a.length;e++)if(d)d=!1;else{var f="object"==typeof this[e];c+=f?this[e].codegen():this[e],"*"!==b&&"/"!==b||1!==this[e+1]?e<a.length-1&&(c+=" "+b+" "):d=!0}return c+=" )",this.codeblock=c,c},a.valueOf=function(){return a.codegen()},a},Add:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("+"),Gibberish.Binops.operator.apply(null,a)},Sub:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("-"),Gibberish.Binops.operator.apply(null,a)},Mul:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("*"),Gibberish.Binops.operator.apply(null,a)},Div:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("/"),Gibberish.Binops.operator.apply(null,a)},Mod:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("%"),Gibberish.Binops.operator.apply(null,a)},Abs:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"abs",properties:{},callback:Math.abs.bind(b)};return b.__proto__=new Gibberish.ugen,b.properties[0]=a[0],b.init(),b},Sqrt:function(){var a=(Array.prototype.slice.call(arguments,0),{name:"sqrt",properties:{},callback:Math.sqrt.bind(a)});return a.__proto__=new Gibberish.ugen,a.properties[i]=arguments[0],a.init(),a},Pow:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"pow",properties:{},callback:Math.pow.bind(b)};b.__proto__=new Gibberish.ugen;for(var c=0;c<a.length;c++)b.properties[c]=a[c];return b.init(),console.log(b.callback),b},Clamp:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"clamp",properties:{input:0,min:0,max:1},callback:function(a,b,c){return b>a?a=b:a>c&&(a=c),a}};return b.__proto__=new Gibberish.ugen,b.init(),b.processProperties(a),b},Merge:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"merge",properties:{},callback:function(a){return a[0]+a[1]}};b.__proto__=new Gibberish.ugen;for(var c=0;c<a.length;c++)b.properties[c]=a[c];return b.init(),b},Map:function(a,b,c,d,e,f,g){var h=Math.pow,i=0,j=0,k={name:"map",properties:{input:a,outputMin:b,outputMax:c,inputMin:d,inputMax:e,curve:f||i,wrap:g||!1},callback:function(a,b,c,d,e,f,g){var i,k=c-b,l=e-d,m=(a-d)/l;

return m>1?m=g?m%1:1:0>m&&(m=g?1+m%1:0),i=0===f?b+m*k:b+h(m,1.5)*k,j=i,i},getValue:function(){return j},invert:function(){var a=k.outputMin;k.outputMin=k.outputMax,k.outputMax=a}};return k.__proto__=new Gibberish.ugen,k.init(),k}},Gibberish.Time={bpm:120,"export":function(a){Gibberish["export"]("Time",a||window)},ms:function(a){return a*Gibberish.context.sampleRate/1e3},seconds:function(a){return a*Gibberish.context.sampleRate},beats:function(a){return function(){var b=Gibberish.context.sampleRate/(Gibberish.Time.bpm/60);return b*a}}},Gibberish.Sequencer2=function(){var a=this,b=0;Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},properties:{rate:1,isRunning:!1,nextTime:0},offset:0,name:"seq",callback:function(c,d,e){if(d){if(b>=e){if(null!==a.values){if(a.target){var f=a.values[a.valuesIndex++];"function"==typeof f&&(f=f()),"function"==typeof a.target[a.key]?a.target[a.key](f):a.target[a.key]=f}else"function"==typeof a.values[a.valuesIndex]&&a.values[a.valuesIndex++]();a.valuesIndex>=a.values.length&&(a.valuesIndex=0)}else if(null!==a.keysAndValues)for(var g in a.keysAndValues){var h=a.counts[g]++,f=a.keysAndValues[g][h];"function"==typeof f&&(f=f()),"function"==typeof a.target[g]?a.target[g](f):a.target[g]=f,a.counts[g]>=a.keysAndValues[g].length&&(a.counts[g]=0),a.chose&&a.chose(g,h)}else"function"==typeof a.target[a.key]&&a.target[a.key]();if(b-=e,Array.isArray(a.durations)){var i=a.durations[a.durationsIndex++];a.nextTime="function"==typeof i?i():i,a.chose&&a.chose("durations",a.durationsIndex-1),a.durationsIndex>=a.durations.length&&(a.durationsIndex=0)}else{var i=a.durations;a.nextTime="function"==typeof i?i():i}return a.repeatTarget&&(a.repeatCount++,a.repeatCount===a.repeatTarget&&(a.isRunning=!1,a.repeatCount=0)),0}b+=c}return 0},start:function(a){return a||(b=0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(a){return this.repeatTarget=a,this},shuffle:function(){for(c in this.keysAndValues)this.shuffleArray(this.keysAndValues[c])},shuffleArray:function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);}}),this.init(arguments),this.processProperties(arguments);for(var c in this.keysAndValues)this.counts[c]=0;this.oscillatorInit(),b+=this.offset,this.connect()},Gibberish.Sequencer2.prototype=Gibberish._oscillator,Gibberish.Sequencer=function(){Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,phase:0,isRunning:!1,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},offset:0,name:"seq",tick:function(){if(this.isRunning){if(this.phase>=this.nextTime){if(null!==this.values){if(this.target){var a=this.values[this.valuesIndex++];if("function"==typeof a)try{a=a()}catch(b){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+a.toString()),this.values.splice(this.valuesIndex-1,1),this.valuesIndex--}"function"==typeof this.target[this.key]?this.target[this.key](a):this.target[this.key]=a}else if("function"==typeof this.values[this.valuesIndex])try{this.values[this.valuesIndex++]()}catch(b){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+this.values[this.valuesIndex-1].toString()),this.values.splice(this.valuesIndex-1,1),this.valuesIndex--}this.valuesIndex>=this.values.length&&(this.valuesIndex=0)}else if(null!==this.keysAndValues)for(var c in this.keysAndValues){var d="function"==typeof this.keysAndValues[c].pick?this.keysAndValues[c].pick():this.counts[c]++,a=this.keysAndValues[c][d];if("function"==typeof a)try{a=a()}catch(b){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+a.toString()),this.keysAndValues[c].splice(d,1),"function"!=typeof this.keysAndValues[c].pick&&this.counts[c]--}"function"==typeof this.target[c]?this.target[c](a):this.target[c]=a,this.counts[c]>=this.keysAndValues[c].length&&(this.counts[c]=0)}else"function"==typeof this.target[this.key]&&this.target[this.key]();if(this.phase-=this.nextTime,Array.isArray(this.durations)){var e="function"==typeof this.durations.pick?this.durations[this.durations.pick()]:this.durations[this.durationsIndex++];this.nextTime="function"==typeof e?e():e,this.durationsIndex>=this.durations.length&&(this.durationsIndex=0)}else{var e=this.durations;this.nextTime="function"==typeof e?e():e}return void(this.repeatTarget&&(this.repeatCount++,this.repeatCount===this.repeatTarget&&(this.isRunning=!1,this.repeatCount=0)))}this.phase++}},start:function(a){return a||(this.phase=this.offset),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(a){return this.repeatTarget=a,this},shuffle:function(){for(a in this.keysAndValues)this.shuffleArray(this.keysAndValues[a])},shuffleArray:function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);},disconnect:function(){var a=Gibberish.sequencers.indexOf(this);Gibberish.sequencers.splice(a,1),this.isConnected=!1},connect:function(){return-1===Gibberish.sequencers.indexOf(this)&&Gibberish.sequencers.push(this),this.isConnected=!0,this}});for(var a in arguments[0])this[a]=arguments[0][a];for(var a in this.keysAndValues)this.counts[a]=0;this.connect(),this.phase+=this.offset},Gibberish.Sequencer.prototype=Gibberish._oscillator,Gibberish.PolySeq=function(){var a=this,b=0,c=function(a,b){return b>a?-1:a>b?1:0};Gibberish.extend(this,{seqs:[],timeline:{},playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!1,properties:{rate:1,isRunning:!1,nextTime:0},offset:0,autofire:[],name:"polyseq",getPhase:function(){return b},timeModifier:null,add:function(c){c.valuesIndex=c.durationsIndex=0,null===c.durations?(c.autofire=!0,a.autofire.push(c)):(a.seqs.push(c),"undefined"!=typeof a.timeline[b]?c.priority?a.timeline[b].unshift(c):a.timeline[b].push(c):a.timeline[b]=[c],a.nextTime=b),!a.scale||"frequency"!==c.key&&"note"!==c.key||a.applyScale&&a.applyScale(),c.shouldStop=!1},callback:function(d,e,f){var g;if(e){if(b>=f){var h=a.timeline[f],i=b-f;if("undefined"==typeof h)return;for(var j=0;j<h.length;j++){var k=h[j];if(!k.shouldStop){var l=k.values.pick?k.values.pick():k.valuesIndex++%k.values.length,m="function"==typeof k.values?k.values():k.values[l];if("function"==typeof m&&(m=m()),k.target&&("function"==typeof k.target[k.key]?k.target[k.key](m):k.target[k.key]=m),a.chose&&a.chose(k.key,l),Array.isArray(k.durations)){var l=k.durations.pick?k.durations.pick():k.durationsIndex++,n="function"==typeof k.durations?k.durations():k.durations[l];g="function"==typeof n?n():n,"function"!=typeof k.durations&&k.durationsIndex>=k.durations.length&&(k.durationsIndex=0),a.chose&&a.chose("durations",l)}else{var n="function"==typeof k.durations?k.durations():k.durations;g="function"==typeof n?n():n}var o;o=null!==a.timeModifier?a.timeModifier(g)+b:g+b,o-=i,g-=i,"undefined"==typeof a.timeline[o]?a.timeline[o]=[k]:k.priority?a.timeline[o].unshift(k):a.timeline[o].push(k)}}for(var j=0,p=a.autofire.length;p>j;j++){var k=a.autofire[j];if(!k.shouldStop){var l=k.values.pick?k.values.pick():k.valuesIndex++%k.values.length,m=k.values[l];"function"==typeof m&&(m=m()),k.target&&("function"==typeof k.target[k.key]?k.target[k.key](m):k.target[k.key]=m),a.chose&&a.chose(k.key,l)}}delete a.timeline[f];var q=Object.keys(a.timeline),r=q.length;if(r>1){for(var s=0;r>s;s++)q[s]=parseFloat(q[s]);q=q.sort(c),a.nextTime=q[0]}else a.nextTime=parseFloat(q[0])}b+=d}return 0},start:function(a,c){if(a&&this.offset){b=0,this.nextTime=this.offset;var d=""+this.offset;this.timeline={},this.timeline[d]=[];for(var e=0;e<this.seqs.length;e++){var f=this.seqs[e];f.valuesIndex=f.durationsIndex=f.shouldStop=0,this.timeline[d].push(f)}}else{b=0,this.nextTime=0,this.timeline={0:[]};for(var e=0;e<this.seqs.length;e++){var f=this.seqs[e];f.valuesIndex=f.durationsIndex=f.shouldStop=0,this.timeline[0].push(f)}}return this.isConnected||(this.connect(Gibberish.Master,c),this.isConnected=!0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this.isConnected&&(this.disconnect(),this.isConnected=!1),this},repeat:function(a){return this.repeatTarget=a,this},shuffle:function(a){if("undefined"!=typeof a)for(var b=0;b<this.seqs.length;b++)this.seqs[b].key===a&&this.shuffleArray(this.seqs[b].values);else for(var b=0;b<this.seqs.length;b++)this.shuffleArray(this.seqs[b].values)},shuffleArray:function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);}}),this.init(arguments),this.processProperties(arguments),this.oscillatorInit()},Gibberish.PolySeq.prototype=Gibberish._oscillator;var _hasInput=!1;return"object"==typeof navigator&&(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),Gibberish.Input=function(){var a=[];_hasInput||createInput(),this.type=this.name="input",this.fx=new Array2,this.fx.parent=this,this.properties={input:"input",amp:.5,channels:1},this.callback=function(b,c,d){return 1===d?a=b*c:(a[0]=b[0]*c,a[1]=b[1]*c),a},this.init(arguments),this.processProperties(arguments)},Gibberish.Input.prototype=new Gibberish.ugen,Gibberish.Kick=function(){var a=!1,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=.2,e=.8;Gibberish.extend(this,{name:"kick",properties:{pitch:50,__decay:20,__tone:1e3,amp:2,sr:Gibberish.context.sampleRate},callback:function(d,e,f,g,h){var i=a?60:0;return i=b(i,d,e,2,h),i=c(i,f,.5,0,h),i*=g,a=!1,i},note:function(b,c,d,e){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.decay=c),"number"==typeof d&&(this.tone=d),"number"==typeof e&&(this.amp=e),a=!0}}).init().oscillatorInit(),Object.defineProperties(this,{decay:{get:function(){return d},set:function(a){d=a>1?1:a,this.__decay=100*d}},tone:{get:function(){return e},set:function(a){e=a>1?1:a,this.__tone=220+1400*a}}}),this.processProperties(arguments)},Gibberish.Kick.prototype=Gibberish._oscillator,Gibberish.Conga=function(){var a=!1,b=(new Gibberish.SVF).callback;Gibberish.extend(this,{name:"conga",properties:{pitch:190,amp:2,sr:Gibberish.context.sampleRate},callback:function(c,d,e){var f=a?60:0;return f=b(f,c,50,2,e),f*=d,a=!1,f},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),a=!0}}).init().oscillatorInit(),this.processProperties(arguments)},Gibberish.Conga.prototype=Gibberish._oscillator,Gibberish.Clave=function(){var a=!1,b=new Gibberish.SVF,c=b.callback;Gibberish.extend(this,{name:"clave",properties:{pitch:2500,amp:1,sr:Gibberish.context.sampleRate},callback:function(b,d,e){var f=a?2:0;return f=c(f,b,5,2,e),f*=d,a=!1,f},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),a=!0}}).init().oscillatorInit(),this.bpf=b,this.processProperties(arguments)},Gibberish.Clave.prototype=Gibberish._oscillator,Gibberish.Tom=function(){var a=!1,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=new Gibberish.ExponentialDecay,e=d.callback,f=Math.random;Gibberish.extend(this,{name:"tom",properties:{pitch:80,amp:.5,sr:Gibberish.context.sampleRate},callback:function(d,g,h){var i,j=a?60:0;return j=b(j,d,30,2,h),i=16*f()-8,i=i>0?i:0,i*=e(.05,11025),i=c(i,120,.5,0,h),j+=i,j*=g,a=!1,j},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),d.trigger(),a=!0}}).init().oscillatorInit(),d.trigger(1),this.processProperties(arguments)},Gibberish.Tom.prototype=Gibberish._oscillator,Gibberish.Cowbell=function(){var a=new Gibberish.Square,b=new Gibberish.Square,c=a.callback,d=b.callback,e=new Gibberish.SVF({mode:2}),f=e.callback,g=new Gibberish.ExponentialDecay(.0025,10500),h=g.callback;Gibberish.extend(this,{name:"cowbell",properties:{amp:1,pitch:560,bpfFreq:1e3,bpfRez:3,decay:22050,decayCoeff:1e-4,sr:Gibberish.context.sampleRate},callback:function(a,b,e,g,i,j,k){var l;return l=c(b,1,1,0),l+=d(845,1,1,0),l=f(l,e,g,2,k),l*=h(j,i),l*=a},note:function(a){g.trigger(),a&&(this.decay=a)}}).init().oscillatorInit().processProperties(arguments),this.bpf=e,this.eg=g,g.trigger(1)},Gibberish.Cowbell.prototype=Gibberish._oscillator,Gibberish.Snare=function(){var a=(new Gibberish.SVF).callback,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=new Gibberish.ExponentialDecay(.0025,11025),e=d.callback,f=Math.random,g=0;Gibberish.extend(this,{name:"snare",properties:{cutoff:1e3,decay:11025,tune:0,snappy:.5,amp:1,sr:Gibberish.context.sampleRate},callback:function(d,h,i,j,k,l){var m,n,o=0,p=0;return o=e(.0025,h),o>.005&&(p=(2*f()-1)*o,p=c(p,d+1e3*i,.5,1,l),p*=j,p=p>0?p:0,g=o,m=a(g,180*(i+1),15,2,l),n=b(g,330*(i+1),15,2,l),p+=m,p+=.8*n,p*=k),p},note:function(a,b,c,e){"number"==typeof a&&(this.tune=a),"number"==typeof e&&(this.cutoff=e),"number"==typeof c&&(this.snappy=c),"number"==typeof b&&(this.amp=b),d.trigger()}}).init().oscillatorInit().processProperties(arguments),d.trigger(1)},Gibberish.Snare.prototype=Gibberish._oscillator,Gibberish.Hat=function(){{var a=new Gibberish.Square,b=new Gibberish.Square,c=new Gibberish.Square,d=new Gibberish.Square,e=new Gibberish.Square,f=new Gibberish.Square,g=a.callback,h=b.callback,i=c.callback,j=d.callback,k=e.callback,l=f.callback,m=new Gibberish.SVF({mode:2}),n=m.callback,o=new Gibberish.Filter24,p=o.callback,q=new Gibberish.ExponentialDecay(.0025,10500),r=q.callback,s=new Gibberish.ExponentialDecay(.1,7500);s.callback}Gibberish.extend(this,{name:"hat",properties:{amp:1,pitch:325,bpfFreq:7e3,bpfRez:2,hpfFreq:.975,hpfRez:0,decay:3500,decay2:3e3,sr:Gibberish.context.sampleRate},callback:function(a,b,c,d,e,f,m,o,q){var s;return s=g(b,1,.5,0),s+=h(1.4471*b,.75,1,0),s+=i(1.617*b,1,1,0),s+=j(1.9265*b,1,1,0),s+=k(2.5028*b,1,1,0),s+=l(2.6637*b,.75,1,0),s=n(s,c,d,2,q),s*=r(.001,m),s=p(s,e,f,0,1),s*=a},note:function(a,b){q.trigger(),s.trigger(),a&&(this.decay=a),b&&(this.decay2=b)}}).init().oscillatorInit().processProperties(arguments),this.bpf=m,this.hpf=o,q.trigger(1),s.trigger(1)},Gibberish.Hat.prototype=Gibberish._oscillator,function(){var a={Soundfont:{instruments:{}}},b=a.Soundfont;"object"==typeof window?window.MIDI=a:global.MIDI=a;var c=function(a,b){function c(a){var c=document.createElement("script");c.innerHTML=a.srcElement?a.srcElement.responseText:a.target.responseText,document.querySelector("head").appendChild(c),b(c)}var d=new XMLHttpRequest;d.addEventListener("load",c,!1),d.addEventListener("error",function(a){console.log("SF load error",a)},!1),d.open("GET",a,!0),d.send()},d={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(a){var b=a.length/4*3,c=new ArrayBuffer(b);return this.decode(a,c),c},decode:function(a,b){var c=this._keyStr.indexOf(a.charAt(a.length-1)),d=this._keyStr.indexOf(a.charAt(a.length-2)),e=a.length/4*3;64==c&&e--,64==d&&e--;var f,g,h,i,j,k,l,m,n=0,o=0;for(f=new Uint8Array(b?b:e),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),n=0;e>n;n+=3)j=this._keyStr.indexOf(a.charAt(o++)),k=this._keyStr.indexOf(a.charAt(o++)),l=this._keyStr.indexOf(a.charAt(o++)),m=this._keyStr.indexOf(a.charAt(o++)),g=j<<2|k>>4,h=(15&k)<<4|l>>2,i=(3&l)<<6|m,f[n]=g,64!=l&&(f[n+1]=h),64!=m&&(f[n+2]=i);return f}},e=function(a){var c=0,e=b[a.instrumentFileName];"undefined"==typeof b.instruments[a.instrumentFileName]&&(b.instruments[a.instrumentFileName]={}),a.buffers=b.instruments[a.instrumentFileName];for(var f in e)c++,!function(){var g=f,h=e[g].split(",")[1],i=d.decodeArrayBuffer(h);Gibberish.context.decodeAudioData(i,function(d){b.instruments[a.instrumentFileName][g]=d.getChannelData(0),c--,0>=c&&(console.log("Soundfont "+a.instrumentFileName+" is loaded."),a.isLoaded=!0,a.onload&&a.onload())},function(a){console.log("ERROR",a.err,arguments,g)})}()};Gibberish.SoundFont=function(a,d){return Gibberish.extend(this,{instrumentFileName:a,name:"soundfont",properties:{amp:1,pan:0},playing:[],buffers:{},onload:null,out:[0,0],isLoaded:!1,resourcePath:d||"./resources/soundfonts/",callback:function(a,b){for(var c=0,d=this.playing.length-1;d>=0;d--){var e=this.playing[d];c+=this.interpolate(e.buffer,e.phase),e.phase+=e.increment,e.phase>e.length&&this.playing.splice(this.playing.indexOf(e),1)}return this.panner(c*a,b,this.out)}.bind(this),note:function(a,b,c){this.isLoaded&&this.playing.push({buffer:this.buffers[a],phase:0,increment:isNaN(c)?1:1+c,length:this.buffers[a].length,amp:isNaN(b)?1:b})},interpolate:Gibberish.interpolate.bind(this),panner:Gibberish.makePanner()}).init().oscillatorInit(),"object"==typeof arguments[0]&&arguments[0].instrumentFileName&&(this.instrumentFileName=arguments[0].instrumentFileName),b.instruments[this.instrumentFileName]||"object"==typeof d?"object"==typeof d?(b[this.instrumentFileName]=d,e(this)):(this.buffers=b.instruments[this.instrumentFileName],this.isLoaded=!0,setTimeout(function(){this.onload&&this.onload()}.bind(this),0)):c("resources/soundfonts/"+this.instrumentFileName+"-mp3.js",e.bind(null,this)),this},Gibberish.SoundFont.storage=b,Gibberish.SoundFont.prototype=Gibberish._oscillator}(),Gibberish})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(require,module,exports){!function(){var freesound=module.exports={BASE_URI:"http://www.freesound.org/api",apiKey:"",debug:!1,_URI_SOUND:"/sounds/<sound_id>/",_URI_SOUND_ANALYSIS:"/sounds/<sound_id>/analysis/",_URI_SOUND_ANALYSIS_FILTER:"/sounds/<sound_id>/analysis/<filter>",_URI_SIMILAR_SOUNDS:"/sounds/<sound_id>/similar/",_URI_SEARCH:"/sounds/search/",_URI_CONTENT_SEARCH:"/sounds/content_search/",_URI_GEOTAG:"/sounds/geotag",_URI_USER:"/people/<user_name>/",_URI_USER_SOUNDS:"/people/<user_name>/sounds/",_URI_USER_PACKS:"/people/<user_name>/packs/",_URI_USER_BOOKMARKS:"/people/<username>/bookmark_categories",_URI_BOOKMARK_CATEGORY_SOUNDS:"/people/<username>/bookmark_categories/<category_id>/sounds",_URI_PACK:"/packs/<pack_id>/",_URI_PACK_SOUNDS:"/packs/<pack_id>/sounds/",_make_uri:function(a,b){for(var c in b)a=a.replace(/<[\w_]+>/,b[c]);return this.BASE_URI+a},_make_request:function(uri,success,error,params,wrapper){var fs=this;-1==uri.indexOf("?")&&(uri+="?"),uri=uri+"&api_key="+this.apiKey;for(var p in params)uri=uri+"&"+p+"="+params[p];var xhr;try{xhr=new XMLHttpRequest}catch(e){xhr=new ActiveXObject("Microsoft.XMLHTTP")}xhr.onreadystatechange=function(){if(4==xhr.readyState&&200==xhr.status){var data=eval("("+xhr.responseText+")");success(wrapper?wrapper(data):data)}else 4==xhr.readyState&&200!=xhr.status&&error()},freesound.debug&&console.log(uri),xhr.open("GET",uri),xhr.send(null)},_make_sound_object:function(a){return a.get_analysis=function(b,c,d,e){var f=c?freesound._URI_SOUND_ANALYSIS_FILTER:freesound._URI_SOUND_ANALYSIS;freesound._make_request(freesound._make_uri(f,[a.id,c?c:""]),d,e)},a.get_similar_sounds=function(b,c){freesound._make_request(freesound._make_uri(freesound._URI_SIMILAR_SOUNDS,[a.id]),b,c,{},this._make_sound_collection_object)},a},_make_sound_collection_object:function(a){var b=function(a,b,c){freesound._make_request(a,b,c,{},this._make_sound_collection_object)};return a.next_page=function(a,c){b(this.next,a,c)},a.previous_page=function(a,c){b(this.previous,a,c)},a},_make_user_object:function(a){return a.get_sounds=function(b,c){freesound._make_request(freesound._make_uri(freesound._URI_USER_SOUNDS,[a.username]),b,c,{},this._make_sound_collection_object)},a.get_packs=function(b,c){freesound._make_request(freesound._make_uri(freesound._URI_USER_PACKS,[a.username]),b,c,{},this._make_pack_collection_object)},a.get_bookmark_categories=function(b,c){freesound._make_request(freesound._make_uri(freesound._URI_USER_BOOKMARKS,[a.username]),b,c)},a.get_bookmark_category_sounds=function(a,b,c){freesound._make_request(a,b,c)},a},_make_pack_object:function(a){return a.get_sounds=function(b,c){freesound._make_request(freesound._make_uri(freesound._URI_PACK_SOUNDS,[a.id]),b,c,{},this._make_sound_collection_object)},a},_make_pack_collection_object:function(a){var b=function(a,b,c){freesound._make_request(a,b,c,{},this._make_pack_collection_object)};return a.next_page=function(a,c){b(this.next,a,c)},a.previous_page=function(a,c){b(this.previous,a,c)},a},get_from_ref:function(a,b,c){this._make_request(a,b,c,{})},get_sound:function(a,b,c){this._make_request(this._make_uri(this._URI_SOUND,[a]),b,c,{},this._make_sound_object)},get_user:function(a,b,c){this._make_request(this._make_uri(this._URI_USER,[a]),b,c,{},this._make_user_object)},get_pack:function(a,b,c){this._make_request(this._make_uri(this._URI_PACK,[a]),b,c,{},this._make_pack_object)},quick_search:function(a,b,c){this.search(a,0,null,null,b,c)},search:function(a,b,c,d,e,f,g,h,i){var j={q:a?a:" "};b&&(j.p=b),c&&(j.f=c),d&&(j.s=d),e&&(j.num_results=e),g&&(j.sounds_per_page=g),f&&(j.fields=f),this._make_request(this._make_uri(this._URI_SEARCH),h,i,j,this._make_sound_collection_object)},content_based_search:function(a,b,c,d,e,f,g,h){var i={};e&&(i.p=e),b&&(i.f=b),a&&(i.t=a),c&&(i.max_results=c),f&&(i.sounds_per_page=f),d&&(i.fields=d),this._make_request(this._make_uri(this._URI_CONTENT_SEARCH),g,h,i,this._make_sound_collection_object)},geotag:function(a,b,c,d,e,f,g,h,i){var j={};a&&(j.min_lat=a),b&&(j.max_lat=b),c&&(j.min_lon=c),d&&(j.max_lon=d),e&&(j.p=e),g&&(j.sounds_per_page=g),f&&(j.fields=f),this._make_request(this._make_uri(this._URI_GEOTAG),h,i,j,this._make_sound_collection_object)}}}()},{}],4:[function(a,b){!function(){function a(a,b){return a=g[a],b=g[b],a.distance>b.distance?b.distance+12-a.distance:b.distance-a.distance}function c(a,b,c){for(;c>0;c--)a+=b;return a}function d(a,b){if("string"!=typeof a)return null;this.name=a,this.duration=b||4,this.accidental={value:0,sign:""};var c=a.match(/^([abcdefgh])(x|#|bb|b?)(-?\d*)/i);if(c&&a===c[0]&&0!==c[3].length)this.name=c[1].toLowerCase(),this.octave=parseFloat(c[3]),0!==c[2].length&&(this.accidental.sign=c[2].toLowerCase(),this.accidental.value=s[c[2]]);else{a=a.replace(/\u2032/g,"'").replace(/\u0375/g,",");var d=a.match(/^(,*)([abcdefgh])(x|#|bb|b?)([,\']*)$/i);if(!d||5!==d.length||a!==d[0])throw Error("Invalid note format");if(""===d[1]&&""===d[4])this.octave=d[2]===d[2].toLowerCase()?3:2;else if(""!==d[1]&&""===d[4]){if(d[2]===d[2].toLowerCase())throw Error("Invalid note format. Format must respect the Helmholtz notation.");this.octave=2-d[1].length}else{if(""!==d[1]||""===d[4])throw Error("Invalid note format");if(d[4].match(/^'+$/)){if(d[2]===d[2].toUpperCase())throw Error("Invalid note format. Format must respect the Helmholtz notation");this.octave=3+d[4].length}else{if(!d[4].match(/^,+$/))throw Error("Invalid characters after note name.");if(d[2]===d[2].toLowerCase())throw Error("Invalid note format. Format must respect the Helmholtz notation");this.octave=2-d[4].length}}this.name=d[2].toLowerCase(),0!==d[3].length&&(this.accidental.sign=d[3].toLowerCase(),this.accidental.value=s[d[3]])}}function e(a,b){if(!(a instanceof d))return null;b=b||"",this.name=a.name.toUpperCase()+a.accidental.sign+b,this.root=a,this.notes=[a],this.quality="major",this.type="major";var c,e,g,h,i,j=[],k=!1,m="quality",n=!1,o=!1,q=null;for(h=0,i=b.length;i>h;h++){for(c=b[h];" "===c||"("===c||")"===c;)c=b[++h];if(!c)break;if(e=c.charCodeAt(0),g=i>=h+3?b.substr(h,3):"","quality"===m)"M"===c||("maj"===g||916===e?(this.type="major",j.push("M7"),k=!0,(b[h+3]&&"7"===b[h+3]||916===e&&"7"===b[h+1])&&h++):"m"===c||"-"===c||"min"===g?this.quality=this.type="minor":111===e||176===e||"dim"===g?(this.quality="minor",this.type="diminished"):"+"===c||"aug"===g?(this.quality="major",this.type="augmented"):216===e||248===e?(this.quality="minor",this.type="diminished",j.push("m7"),k=!0):"sus"===g?(this.quality="sus",this.type=b[h+3]&&"2"===b[h+3]?"sus2":"sus4"):"5"===c?(this.quality="power",this.type="power"):h-=1),g in l&&(h+=2),m="";else if("#"===c)n=!0;else if("b"===c)o=!0;else if("5"===c)n?(q="A5","major"===this.quality&&(this.type="augmented")):o&&(q="d5","minor"===this.quality&&(this.type="diminished")),o=n=!1;else if("6"===c)j.push("M6"),o=n=!1;else if("7"===c)j.push("diminished"===this.type?"d7":"m7"),k=!0,o=n=!1;else if("9"===c)k||j.push("m7"),j.push(o?"m9":n?"A9":"M9"),o=n=!1;else{if("1"!==c)throw Error("Unexpected character: '"+c+"' in chord name");c=b[++h],"1"===c?j.push(o?"d11":n?"A11":"P11"):"3"===c&&j.push(o?"m13":n?"A13":"M13"),o=n=!1}}for(var r=0,s=p[this.type].length;s>r;r++)this.notes.push("5"===p[this.type][r][1]&&q?f.interval(this.root,q):f.interval(this.root,p[this.type][r]));for(r=0,s=j.length;s>r;r++)this.notes.push(f.interval(this.root,j[r]))}var f={},g={c:{name:"c",distance:0,index:0},d:{name:"d",distance:2,index:1},e:{name:"e",distance:4,index:2},f:{name:"f",distance:5,index:3},g:{name:"g",distance:7,index:4},a:{name:"a",distance:9,index:5},b:{name:"b",distance:11,index:6},h:{name:"h",distance:11,index:6}},h=["c","d","e","f","g","a","b"],i={.25:"longa",.5:"breve",1:"whole",2:"half",4:"quarter",8:"eighth",16:"sixteenth",32:"thirty-second",64:"sixty-fourth",128:"hundred-twenty-eighth"},j=[{name:"unison",quality:"perfect",size:0},{name:"second",quality:"minor",size:1},{name:"third",quality:"minor",size:3},{name:"fourth",quality:"perfect",size:5},{name:"fifth",quality:"perfect",size:7},{name:"sixth",quality:"minor",size:8},{name:"seventh",quality:"minor",size:10},{name:"octave",quality:"perfect",size:12},{name:"ninth",quality:"minor",size:13},{name:"tenth",quality:"minor",size:15},{name:"eleventh",quality:"perfect",size:17},{name:"twelfth",quality:"perfect",size:19},{name:"thirteenth",quality:"minor",size:20},{name:"fourteenth",quality:"minor",size:22},{name:"fifteenth",quality:"perfect",size:24}],k={unison:0,second:1,third:2,fourth:3,fifth:4,sixth:5,seventh:6,octave:7,ninth:8,tenth:9,eleventh:10,twelfth:11,thirteenth:12,fourteenth:13,fifteenth:14},l={P:"perfect",M:"major",m:"minor",A:"augmented",d:"diminished",perf:"perfect",maj:"major",min:"minor",aug:"augmented",dim:"diminished"},m={perfect:"P",major:"M",minor:"m",augmented:"A",diminished:"d"},n={P:"P",M:"m",m:"M",A:"d",d:"A"},o={perfect:["diminished","perfect","augmented"],minor:["diminished","minor","major","augmented"]},p={major:["M3","P5"],minor:["m3","P5"],augmented:["M3","A5"],diminished:["m3","d5"],sus2:["M2","P5"],sus4:["P4","P5"],power:["P5"]},q={major:"M",minor:"m",augmented:"aug",diminished:"dim",power:"5"},r={"-2":"bb","-1":"b",0:"",1:"#",2:"x"},s={bb:-2,b:-1,"#":1,x:2};d.prototype={key:function(a){return a?7*(this.octave-1)+3+Math.ceil(g[this.name].distance/2):12*(this.octave-1)+4+g[this.name].distance+this.accidental.value},fq:function(a){return a=a||440,a*Math.pow(2,(this.key()-49)/12)},scale:function(a,b){return f.scale.list(this,a,b)},interval:function(a,b){return f.interval(this,a,b)},chord:function(a){return a=a||"major",a in q&&(a=q[a]),new e(this,a)},helmholtz:function(){var a,b=3>this.octave?this.name.toUpperCase():this.name.toLowerCase();return 2>=this.octave?(a=c("",",",2-this.octave),a+b+this.accidental.sign):(a=c("","'",this.octave-3),b+this.accidental.sign+a)},scientific:function(){return this.name.toUpperCase()+this.accidental.sign+("number"==typeof this.octave?this.octave:"")},enharmonics:function(){var a=[],b=this.key(),c=this.interval("m2","up"),d=this.interval("m2","down"),e=c.key()-c.accidental.value,f=d.key()-d.accidental.value,g=b-e;return 3>g&&g>-3&&(c.accidental={value:g,sign:r[g]},a.push(c)),g=b-f,3>g&&g>-3&&(d.accidental={value:g,sign:r[g]},a.push(d)),a},valueName:function(){return i[this.duration]},toString:function(a){return a="boolean"==typeof a?a:"number"==typeof this.octave?!1:!0,this.name.toLowerCase()+this.accidental.sign+(a?"":this.octave)}},e.prototype.dominant=function(a){return a=a||"",new e(this.root.interval("P5"),a)},e.prototype.subdominant=function(a){return a=a||"",new e(this.root.interval("P4"),a)},e.prototype.parallel=function(a){if(a=a||"","triad"!==this.chordType()||"diminished"===this.quality||"augmented"===this.quality)throw Error("Only major/minor triads have parallel chords");return"major"===this.quality?new e(this.root.interval("m3","down"),"m"):new e(this.root.interval("m3","up"))},e.prototype.chordType=function(){var a,b,c;if(2===this.notes.length)return"dyad";if(3===this.notes.length){b={unison:!1,third:!1,fifth:!1};for(var d=0,e=this.notes.length;e>d;d++)a=this.root.interval(this.notes[d]),c=j[parseFloat(f.interval.invert(a.simple)[1])-1],a.name in b?b[a.name]=!0:c.name in b&&(b[c.name]=!0);return b.unison&&b.third&&b.fifth?"triad":"trichord"}if(4===this.notes.length){b={unison:!1,third:!1,fifth:!1,seventh:!1};for(var d=0,e=this.notes.length;e>d;d++)a=this.root.interval(this.notes[d]),c=j[parseFloat(f.interval.invert(a.simple)[1])-1],a.name in b?b[a.name]=!0:c.name in b&&(b[c.name]=!0);if(b.unison&&b.third&&b.fifth&&b.seventh)return"tetrad"}return"unknown"},e.prototype.toString=function(){return this.name},f.note=function(a,b){return new d(a,b)},f.note.fromKey=function(a){var b=440*Math.pow(2,(a-49)/12);return f.frequency.note(b).note},f.chord=function(a){var b;if(b=a.match(/^([abcdefgh])(x|#|bb|b?)/i),b&&b[0])return new e(new d(b[0].toLowerCase()),a.substr(b[0].length));throw Error("Invalid Chord. Couldn't find note name")},f.frequency={note:function(a,b){b=b||440;var c,e,f,i,j,k,l;return c=Math.round(49+12*((Math.log(a)-Math.log(b))/Math.log(2))),l=b*Math.pow(2,(c-49)/12),k=1200*(Math.log(a/l)/Math.log(2)),e=Math.floor((c-4)/12),f=c-12*e-4,i=g[h[Math.round(f/2)]],j=i.name,f>i.distance?j+="#":i.distance>f&&(j+="b"),{note:new d(j+(e+1)),cents:k}}},f.interval=function(a,b,c){if("string"==typeof b){"down"===c&&(b=f.interval.invert(b));var e=l[b[0]],g=parseFloat(b.substr(1));if(!e||isNaN(g)||1>g)throw Error("Invalid string-interval format");return f.interval.from(a,{quality:e,interval:j[g-1].name},c)}if(b instanceof d&&a instanceof d)return f.interval.between(a,b);throw Error("Invalid parameters")},f.interval.from=function(b,c,e){c.direction=e||c.direction||"up";var f,i,l,m,n,p;if(n=k[c.interval],p=j[n],n>7&&(n-=7),n=g[b.name].index+n,n>h.length-1&&(n-=h.length),f=h[n],-1===o[p.quality].indexOf(c.quality)||-1===o[p.quality].indexOf(p.quality))throw Error("Invalid interval quality");return i=o[p.quality].indexOf(c.quality)-o[p.quality].indexOf(p.quality),l=p.size+i-a(b.name,f),b.octave&&(m=Math.floor((b.key()-b.accidental.value+a(b.name,f)-4)/12)+1+Math.floor(k[c.interval]/7)),l+=b.accidental.value,l>=11&&(l-=12),l>-3&&3>l&&(f+=r[l]),"down"===e&&m--,new d(f+(m||""))},f.interval.between=function(a,b){var c,d,e,f,h,i,k=a.key(),l=b.key();if(c=l-k,c>24||-25>c)throw Error("Too big interval. Highest interval is a augmented fifteenth (25 semitones)");return 0>c&&(f=a,a=b,b=f),e=g[b.name].index-g[a.name].index+7*(b.octave-a.octave),d=j[e],i=o[d.quality][Math.abs(c)-d.size+1],h=m[i]+(""+Number(e+1)),{name:d.name,quality:i,direction:c>0?"up":"down",simple:h}},f.interval.invert=function(a){if(2!==a.length&&3!==a.length)return!1;var b=n[a[0]],c=parseFloat(2===a.length?a[1]:a.substr(1));return c>8&&(c-=7),8!==c&&1!==c&&(c=9-c),b+(""+c)},f.scale={list:function(a,b,c){var e,g,h=[],i=[];if(!(a instanceof d))return!1;if("string"==typeof b&&(b=f.scale.scales[b],!b))return!1;for(h.push(a),c&&i.push(a.name+(a.accidental.sign||"")),e=0,g=b.length;g>e;e++)h.push(f.interval(a,b[e])),c&&i.push(h[e+1].name+(h[e+1].accidental.sign||""));return c?i:h},scales:{major:["M2","M3","P4","P5","M6","M7"],ionian:["M2","M3","P4","P5","M6","M7"],dorian:["M2","m3","P4","P5","M6","m7"],phrygian:["m2","m3","P4","P5","m6","m7"],lydian:["M2","M3","A4","P5","M6","M7"],mixolydian:["M2","M3","P4","P5","M6","m7"],minor:["M2","m3","P4","P5","m6","m7"],aeolian:["M2","m3","P4","P5","m6","m7"],locrian:["m2","m3","P4","d5","m6","m7"],majorpentatonic:["M2","M3","P5","M6"],minorpentatonic:["m3","P4","P5","m7"],chromatic:["m2","M2","m3","M3","P4","A4","P5","m6","M6","m7","M7"],harmonicchromatic:["m2","M2","m3","M3","P4","A4","P5","m6","M6","m7","M7"]}},b.exports=f}()},{}],5:[function(a,b){b.exports=function(b){"use strict";
{var c,d=b.dollar;a("gibberish-dsp")}return c={"export":function(a){d.extend(a,c.Busses),d.extend(a,c.Oscillators),d.extend(a,c.Synths),d.extend(a,c.Percussion),d.extend(a,c.Envelopes),d.extend(a,c.FX),d.extend(a,c.Seqs),d.extend(a,c.Samplers),d.extend(a,c.PostProcessing),a.Theory=c.Theory,d.extend(a,c.Analysis),a.Clock=c.Clock,a.Seq=c.Seqs.Seq,a.Arp=c.Arp,a.ScaleSeq=c.Seqs.ScaleSeq,a.SoundFont=c.SoundFont,a.Rndi=c.Core.Rndi,a.Rndf=c.Core.Rndf,a.rndi=c.Core.rndi,a.rndf=c.Core.rndf,a.Input=c.Input,a.Freesound=c.Freesound,a.Scale=c.Theory.Scale,a.module=b["import"],c.Core.Time["export"](a),c.Clock["export"](a),c.Core.Binops["export"](a)},init:function(){var a=null;c.onstart&&(a=c.onstart),c.context||(c.context={sampleRate:44100}),c.Core.onstart=function(){c.Clock.start(!0),null!==a&&a()},b.Clock=c.Clock,b.Theory=c.Theory,b.Theory.scale=b.scale=b.Audio.Theory.Scale("c4","Minor"),c.Core._init(),d.extend(b.Binops,c.Binops),c.Master=c.Busses.Bus().connect(c.Core.out),c.Master.type="Bus",c.Master.name="Master",d.extend(!0,c.Master,c.ugenTemplate),c.Master.fx.ugen=c.Master,c.ugenTemplate.connect=c.Core._oscillator.connect=c.Core._synth.connect=c.Core._effect.connect=c.Core._bus.connect=c.connect,c.Core.defineUgenProperty=c.defineUgenProperty,d.extend(b.Presets,c.Synths.Presets),d.extend(b.Presets,c.Percussion.Presets),d.extend(b.Presets,c.FX.Presets)},Time:{ms:function(a){return{mode:"absolute",value:b.Audio.Core.context.sampleRate/1e3*a,valueOf:function(){return this.value}}},seconds:function(a){return{mode:"absolute",value:b.Audio.Core.context.sampleRate*a,valueOf:function(){return this.value}}},minutes:function(a){return{mode:"absolute",value:60*b.Audio.Core.context.sampleRate*a,valueOf:function(){return this.value}}}},defineUgenProperty:function(a,b,d){var e=c.Clock.timeProperties.indexOf(a)>-1,f=d.properties[a]={value:e?c.Clock.time(b):b,binops:[],parent:d,name:a},g=a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(d,a,{configurable:!0,get:function(){return f.value},set:function(a){return d[g]&&d[g].mapping&&d[g].mapping.remove&&d[g].mapping.remove(!0),f.value=e?c.Clock.time(a):a,c.Core.dirty(d),f.value}}),d[a]=f.value},polyInit:function(a){a.mod=a.polyMod,a.removeMod=a.removePolyMod;for(var b in a.polyProperties)!function(b){var d=a.polyProperties[b],e=c.Clock.timeProperties.indexOf(b)>-1;Object.defineProperty(a,b,{get:function(){return d},set:function(d){for(var f=0;f<a.children.length;f++)a.children[f][b]=e?c.Clock.time(d):d}})}(b)},connect:function(a,b){return"undefined"==typeof a&&(a=c.Master),-1===this.destinations.indexOf(a)&&(a.addConnection(this,1,b),0!==b&&this.destinations.push(a)),this},clear:function(){for(var a=Array.prototype.slice.call(arguments,0),b=0;b<c.Master.inputs.length;b++)-1===a.indexOf(c.Master.inputs[b].value)&&c.Master.inputs[b].value.disconnect();c.Master.inputs.length=arguments.length,c.Clock.reset(),c.Master.fx.remove(),c.Master.amp=1,c.Core.clear(),c.Core.out.addConnection(c.Master,1),c.Master.destinations.push(c.Core.out),console.log("Audio stopped.")},ugenTemplate:{sequencers:[],mappings:[],fx:d.extend([],{add:function(){var a=0===this.length?this.ugen:this[this.length-1];a.disconnect();for(var b=0;b<arguments.length;b++){var d=arguments[b];d.input=a,a=d,this.push(d)}return this.ugen!==c.Master?a.connect():a.connect(c.Core.out),this.ugen},remove:function(){if(arguments.length>0)for(var a=0;a<arguments.length;a++){var b=arguments[a];if("string"!=typeof b)if("object"!=typeof b){if("number"==typeof b){var d=this[b];if(d.disconnect(),this.splice(b,1),"undefined"!=typeof this[b]){var e=b-1;this[b].input=-1!==e?this[e]:this.ugen,"undefined"!=typeof this[b+1]?this[b+1].input=0===b?this.ugen:this[b]:this.ugen.connect(this.ugen!==c.Master?c.Master:c.Core.out)}else this.length>0?this[b-1].connect(c.Master):this.ugen.connect(this.ugen!==c.Master?c.Master:c.Core.out)}}else for(var f=0;f<this.length;f++)this[f]===b&&this.remove(f);else for(var f=0;f<this.length;f++)this[f].name===b&&this.remove(f)}else this.length>0?(this[this.length-1].disconnect(),this.ugen.connect(this.ugen!==c.Master?c.Master:c.Core.out),this.ugen.codegen(),this.length=0):console.log(this.ugen.name+" does not have any fx to remove. ")}}),replaceWith:function(a){for(var b=0;b<this.destinations.length;b++)a.connect(this.destinations[b]);for(var b=0;b<this.sequencers.length;b++)this.sequencers[b].target=a,a.sequencers.push(this.sequencers[b]);for(var b=0;b<this.mappingObjects.length;b++){var c=this.mappingObjects[b];if(c.targets.length>0)for(var d=0;d<c.targets.length;d++){var e=c.targets[d];a.mappingProperties[c.name]?e[0].mapping.replace(a,c.name,c.Name):e[0].mapping.remove()}}this.kill()},kill:function(){var a=0!==this.fx.length?this.fx[this.fx.length-1]:this;this.seq.isRunning&&this.seq.disconnect(),a.disconnect();for(var b=0;b<this.fx.length;b++){var c=this.fx[b];c.seq.isRunning&&c.seq.disconnect()}this.disconnect();for(var b=0;b<this.mappings.length;b++)this.mappings[b].remove();this.clearMarks&&this.clearMarks(),console.log(this.name+" has been terminated.")},play:function(a,b){return this.note?this.note.seq(a,b):this.frequency&&this.frequency.seq(a,b),this},fadeIn:function(a,b){isNaN(b)&&(b=1);var d=c.Clock.time(a),e=(new c.Core.ExponentialDecay({decayCoefficient:.05,length:d}),new c.Core.Line(0,b,d));return this.amp=e,future(function(){this.amp=b}.bind(this),d),this},fadeOut:function(a){var b=c.Clock.time(a),d=(new c.Core.ExponentialDecay({decayCoefficient:5e-5,length:b}),new c.Core.Line(this.amp.value,0,c.Clock.time(b)));return this.amp(d),future(function(){this.amp=0}.bind(this),b),this}}},c.Core=a("gibberish-dsp"),c.Core._init=c.Core.init.bind(c.Core),delete c.Core.init,c.Clock=a("./audio/clock")(b),c.Freesoundjs=a("../external/freesound"),c.Freesound=a("./audio/gibber_freesound")(c.Freesoundjs),c.Seqs=a("./audio/seq")(b),c.Theory=a("./audio/theory")(b),c.FX=a("./audio/fx")(b),c.Oscillators=a("./audio/oscillators")(b),c.Synths=a("./audio/synths")(b),c.Busses=a("./audio/bus")(b),c.Analysis=a("./audio/analysis")(b),c.Envelopes=a("./audio/envelopes")(b),c.Percussion=a("./audio/drums")(b),c.Input=a("./audio/audio_input")(b),c.Samplers=a("./audio/sampler")(b),c.PostProcessing=a("./audio/postprocessing")(b),c.Arp=a("./audio/arp")(b),c.SoundFont=a("./audio/soundfont")(b),c}},{"../external/freesound":3,"./audio/analysis":6,"./audio/arp":7,"./audio/audio_input":8,"./audio/bus":9,"./audio/clock":10,"./audio/drums":11,"./audio/envelopes":12,"./audio/fx":13,"./audio/gibber_freesound":14,"./audio/oscillators":15,"./audio/postprocessing":16,"./audio/sampler":17,"./audio/seq":18,"./audio/soundfont":19,"./audio/synths":20,"./audio/theory":21,"gibberish-dsp":2}],6:[function(a,b){b.exports=function(b){"use strict";var c,d={value:{min:0,max:255,output:h,wrap:!1,timescale:"graphics"}},e=a("gibberish-dsp"),f=b.dollar,g=b.outputCurves,h=(g.LINEAR,g.LOGARITHMIC),i={FFT:function(a,g){if("undefined"==typeof c){c=e.context.createAnalyser(),e.node.connect(c),c.fftSize=a||32,c.updateRate=g||40,c.values=new Uint8Array(c.frequencyBinCount),c.children=[];for(var h=0;h<c.frequencyBinCount;h++)!function(){var a=h,e={},g=0;Object.defineProperties(e,{value:{configurable:!0,get:function(){return g},set:function(a){g=a}}}),b.createProxyProperties(e,f.extend({},d),!1),c[a]=e,c.children.push(e),e.type="mapping",e.index=a,e.min=0,e.max=255,e.valueOf=function(){return this.value.value}}();setInterval(function(){c.getByteFrequencyData(c.values);for(var a=0;a<c.values.length;a++)c[a].value=c.values[a]},c.updateRate)}else a&&(c.fftSize=a),g&&(c.updateRate=g);return c},Follow:function(a,c){var d=new e.Follow(a,c),f={value:{min:0,max:1,output:h,timescale:"audio"}};return b.createProxyProperties(d,f),d}};return i}},{"gibberish-dsp":2}],7:[function(a,b){b.exports=function(b){var c,d=a("../../external/teoria.min"),e=b.dollar,f=(b.outputCurves,a("./seq")(b).Seq);return c=function(a,c,g,h,i){var j=f();e.extend(j,{name:"Arp",notes:[],pattern:g||"up",notation:a||"C4m7",mult:h||1,init:!1,speed:isNaN(c)?_4:c,scale:i||null,chord:function(a){var c=[];if(this.notation=a,"undefined"==typeof this.scale||null===this.scale&&"string"==typeof a)for(var e=0;e<this.mult;e++){var f,g,h=[],i=this.notation.slice(0,1);isNaN(this.notation.charAt(1))?(i+=this.notation.charAt(1),f=parseInt(this.notation.slice(2,3)),g=this.notation.slice(3)):(f=parseInt(this.notation.slice(1,2)),g=this.notation.slice(2)),f+=e;for(var a=d.note(i+f).chord(g),j=0;j<a.notes.length;j++){var k=a.notes[j].fq();h[j]=k}c=c.concat(h)}else for(var e=0;e<this.mult;e++){for(var h=[],j=0;j<this.notation.length;j++)h[j]=this.notation[j]+7*e;c=c.concat(h)}this.notes=b.construct(b.Pattern,this.patterns[this.pattern](c)),this.seqs[0]&&(this.seqs[0].values=[this.notes])},set:function(a,b,c,d,e){this.speed=b||this.speed,this.pattern=c||this.pattern,this.mult=d||this.mult,this.chord(a,e)},shuffle:function(){this.notes.shuffle()},reset:function(){this.notes.reset()},patterns:{up:function(a){return a},down:function(a){return a.reverse()},updown:function(a){var b=a.slice(0);return b.reverse(),a.concat(b)},updown2:function(a){var b=a.slice(0);return b.pop(),b.reverse(),b.pop(),a.concat(b)}}}),j.seq=j,b.createProxyMethods(j,["shuffle","reset","chord"]),j.chord(j.notation);var k=null;Object.defineProperty(j,"target",{get:function(){return k},set:function(a){k=a;var d={key:"note",target:k,values:j.notes,durations:b.Clock.time(c)};j.add(d),j.start()}});var l=c;return Object.defineProperty(j,"speed",{get:function(){return l},set:function(a){l=a;for(var c=0;c<j.seqs.length;c++)j.seqs[0].durations=b.Clock.time(l)}}),j}}},{"../../external/teoria.min":4,"./seq":18}],8:[function(a,b){b.exports=function(b){"use strict";var c={},d=a("gibberish-dsp"),e=b.outputCurves,f=e.LINEAR,g=e.LOGARITHMIC,h={amp:{min:0,max:1,hardMax:2,output:g,timescale:"audio",dimensions:1},out:{min:0,max:1,output:f,timescale:"audio",dimensions:1}},i="Input";return c=function(){var a=(new d.Input).connect(b.Master),c=Array.prototype.slice.call(arguments,0);return a.type="Gen",$.extend(!0,a,b.Audio.ugenTemplate),a.fx.ugen=a,Object.defineProperty(a,"_",{get:function(){return a.kill(),a},set:function(){}}),b.createProxyProperties(a,h),b.processArguments2(a,c,i),a.toString=function(){return"> "+i},a}}},{"gibberish-dsp":2}],9:[function(a,b){b.exports=function(b){"use strict";for(var c=b.dollar,d=a("gibberish-dsp"),e=b.outputCurves,f=e.LINEAR,g=(e.LOGARITHMIC,[["Bus2","Bus"]]),h={amp:{min:0,max:1,output:f,timescale:"audio"},pan:{min:-.75,max:.75,output:f,timescale:"audio"},out:{min:0,max:1,output:f,timescale:"audio",dimensions:1}},i=!1,j={mappingProperties:h,Presets:{}},k=0;k<g.length;k++)!function(){var a=Array.isArray(g[k])?g[k][0]:g[k],e=Array.isArray(g[k])?g[k][1]:g[k];j[e]=function(){var f=b.processArguments(arguments,e);return Array.isArray(f)?(f.unshift(0),f=b.construct(d[a],f)):f=new d[a](f),i?f.connect(Master):i=!0,f.type="Gen",Object.defineProperty(f,"_",{get:function(){return f.kill(),f},set:function(){}}),c.extend(!0,f,b.Audio.ugenTemplate),f.fx.ugen=f,b.createProxyProperties(f,h),f}}();return j.Group=function(){var a=b.processArguments(arguments,"Bus2");a=new d.Bus2,i?a.connect(Master):i=!0,a.type="FX",c.extend(!0,a,b.Audio.ugenTemplate),a.fx.ugen=a,b.createProxyProperties(a,h),c.extend(a,{add:function(){for(var b=0;b<arguments.length;b++)arguments[b].disconnect(),arguments[b].connect(a)},remove:function(){for(var b=0;b<arguments.length;b++)arguments[b].disconnect(a)},free:function(){for(var b=0;b<arguments.length;b++)arguments[b].disconnect(a),arguments[b].connect()}});for(var e=0;e<arguments.length;e++)a.add(arguments[e]);return a},j}},{"gibberish-dsp":2}],10:[function(require,module,exports){!function(){var times=[],$=null,curves=null,LINEAR=null,LOGARITHMIC=null,Gibberish=require("gibberish-dsp"),Gibber,Clock={seq:null,bpm:null,maxMeasures:44,baseBPM:120,metronome:null,currentBeat:0,beatsPerMeasure:4,codeToExecute:[],signature:{lower:4,upper:4},sequencers:[],timeProperties:["attack","decay","sustain","release","offset","time"],phase:0,"export":function(a){a.beats=Clock.beats,a.Beats=Clock.Beats,a.measures=Clock.measures,a.Measures=Clock.Measures},processBeat:function(){if(Clock.currentBeat=Clock.currentBeat>=Clock.signature.upper?1:Clock.currentBeat+1,1===Clock.currentBeat&&Clock.codeToExecute.length>0){for(var i=0;i<Clock.codeToExecute.length;i++)try{"function"==typeof Clock.codeToExecute[i]["function"]?Clock.codeToExecute[i]["function"]():Gibber.Environment?Gibber.Environment.modes[Clock.codeToExecute[i].cm.doc.mode.name].run(Clock.codeToExecute[i].cm.column,Clock.codeToExecute[i].code,Clock.codeToExecute[i].pos,Clock.codeToExecute[i].cm,!1):eval(Clock.codeToExecute[i].code)}catch(e){console.error("FAILED TO EXECUTE CODE:",Clock.codeToExecute[i].code,e)}Clock.codeToExecute.length=0}null!==Clock.metronome&&Clock.metronome.draw(Clock.currentBeat,Clock.signature.upper),Clock.phase+=Clock.beats(1)},getTimeSinceStart:function(){return Clock.phase+Clock.seq.phase},reset:function(){this.phase=0,this.currentBeat=0,this.rate=1,this.start()},tap:function(){var a=Gibber.Clock.getTimeSinceStart();for(times[2]&&a-times[2]>88200&&(times.length=0),times.unshift(a);times.length>3;)times.pop();if(3===times.length){var b=(times[0]+times[1]-2*times[2])/3,c=44100/b,d=60*c;Gibber.Clock.bpm=d}},start:function(a){if(a){$.extend(this,{properties:{rate:1},name:"master_clock",callback:function(a){return a}}),this.__proto__=new Gibberish.ugen,this.__proto__.init.call(this);var b=this.baseBPM;Object.defineProperty(Clock,"bpm",{get:function(){return b},set:function(a){b=a,Clock.rate=b/Clock.baseBPM}}),Object.defineProperty(this,"timeSignature",{get:function(){return Clock.signature.upper+"/"+Clock.signature.lower},set:function(a){var b=a.split("/");2!==b.length||b[0]===Clock.signature.upper&&b[1]===Clock.signature.lower||(Clock.signature.upper=parseInt(b[0]),Clock.signature.lower=parseInt(b[1]),Clock.currentBeat=1!=Clock.currentBeat?0:1)}}),Gibber.createProxyProperties(this,{rate:{min:.1,max:2,output:LINEAR,timescale:"audio"},bpm:{min:20,max:200,output:LINEAR,timescale:"audio"}})}Clock.seq=new Gibberish.PolySeq({seqs:[{target:Clock,values:[Clock.processBeat.bind(Clock)],durations:[.25]}],rate:Clock}),Clock.seq.connect().start(),Clock.seq.timeModifier=Clock.time.bind(Clock)},addMetronome:function(a){this.metronome=a,this.metronome.init()},time:function(a){var b;return b=a<Clock.maxMeasures?Clock.beats(a*Clock.signature.lower):a},Time:function(a){var b;return b=Clock.Beats(a<this.maxMeasures?a*Clock.signature.lower:a)},beats:function(a){var b="undefined"!=typeof Gibberish.context?Gibberish.context.sampleRate:44100,c=b/(Clock.baseBPM/60);return c*a*(4/Clock.signature.lower)},Beats:function(a){return function(){return Gibber.Clock.beats(a)}},measures:function(a){return Clock.beats(a*Clock.signature.upper)},Measures:function(a){return Clock.Beats(a*Clock.signature.upper)}};module.exports=function(a){"use strict";return Gibber=a,$=Gibber.dollar,curves=Gibber.outputCurves,LINEAR=curves.LINEAR,LOGARITHMIC=curves.LOGARITHMIC,Clock}}()},{"gibberish-dsp":2}],11:[function(require,module,exports){module.exports=function(Gibber){"use strict";for(var Percussion={Presets:{}},Gibberish=require("gibberish-dsp"),$=Gibber.dollar,Clock=Gibber.Clock,curves=Gibber.outputCurves,LINEAR=curves.LINEAR,LOGARITHMIC=curves.LOGARITHMIC,types=["Kick","Snare","Hat","Conga","Cowbell","Clave","Tom"],_mappingProperties={Drums:{pitch:{min:.25,max:4,output:LINEAR,timescale:"audio"},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},pan:{min:0,max:1,output:LINEAR,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},XOX:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},pan:{min:0,max:1,output:LINEAR,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Kick:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Snare:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},snappy:{min:.25,max:1.5,output:LOGARITHMIC,timescale:"audio"},tune:{min:0,max:2,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Hat:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Conga:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Cowbell:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}},Clave:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}},Tom:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}}},i=0;i<types.length;i++)!function(){var a=Array.isArray(types[i])?types[i][0]:types[i],b=Array.isArray(types[i])?types[i][1]:types[i];Percussion[b]=function(){var c,d=Array.prototype.slice.call(arguments);return"object"==typeof d[0]&&"undefined"==typeof d[0].maxVoices?d[0].maxVoices=1:"undefined"==typeof d[0]&&(d[0]={maxVoices:1}),c=Gibber.processArguments(d,b),c=Array.isArray(c)?Gibber.construct(Gibberish[a],c).connect(Gibber.Master):new Gibberish[a](c).connect(Gibber.Master),c.type="Gen",$.extend(!0,c,Gibber.Audio.ugenTemplate),c.fx.ugen=c,c._note=c.note.bind(c),c.note=function(){var a=Array.prototype.splice.call(arguments,0);"string"==typeof a[0]&&(a[0]=Gibber.Theory.Teoria.note(a[0]).fq()),this._note.apply(this,a)},Gibber.createProxyProperties(c,_mappingProperties[b]),Gibber.createProxyMethods(c,["note","send"]),c.toString=function(){return"> "+b},Object.defineProperty(c,"_",{get:function(){return c.kill(),c},set:function(){}}),c}}();return Percussion.Drums=function(_sequence,_timeValue,_amp,_freq){var args=Array.prototype.slice.call(arguments),obj={},props=Gibber.processArguments(args,"Drums");$.extend(!0,obj,props),obj=Array.isArray(obj)?Gibber.construct(Gibberish.Bus2,obj).connect(Gibber.Master):new Gibberish.Bus2(obj).connect(Gibber.Master),obj.name="Drums",obj.type="Gen",obj.children=[],$.extend(!0,obj,Gibber.Audio.ugenTemplate),obj.fx.ugen=obj,Object.defineProperty(obj,"_",{get:function(){return obj.kill(),obj},set:function(){}}),obj.kit=Percussion.Drums.kits["default"],"object"==typeof arguments[0]&&arguments[0].kit&&(obj.kit=Percussion.Drums.kits[arguments[0].kit],arguments[0].kit=obj.kit);for(var key in obj.kit){var drum=obj.kit[key];obj[key]={sampler:new Gibberish.Sampler({file:drum.file,pitch:1,amp:drum.amp}),pitch:drum.pitch,amp:drum.amp},obj[key].sampler.pan=drum.pan,obj[key].sampler.connect(obj),obj[key].fx=obj[key].sampler.fx,obj.children.push(obj[key].sampler)}if(obj.mod=obj.polyMod,obj.removeMod=obj.removePolyMod,obj.connect(),Gibber.createProxyProperties(obj,_mappingProperties.Drums),obj.note=function(a){var b=obj.pitch.value;if($.isArray(a))for(var c=0;c<a.length;c++){var d=a[c];if("string"==typeof d){for(var e in obj.kit)if(d===obj.kit[e].symbol){obj[e].sampler.note(b,obj[e].amp);break}}else{var f=obj[Object.keys(obj.kit)[d]];f.sampler.note(b.value,f.sampler.amp)}}else if("string"==typeof a){for(var e in obj.kit)if(a===obj.kit[e].symbol){obj[e].sampler.note(b,obj[e].amp),obj[e].sampler.pitch=b;break}}else{var g=Object.keys(obj.kit),h=Math.abs(a),e=g[h%g.length],f=obj[e];f.sampler.note(b,f.sampler.amp)}},obj.pitch=1,"undefined"!=typeof props)switch($.type(props[0])){case"string":for(var notes=props[0],_seqs=[],_durations=[],__durations=[],seqs=notes.split("|"),timeline={},i=0;i<seqs.length;i++){var seq=seqs[i],duration,hasTime=!1,idx=seq.indexOf(",");if(idx>-1){var _value=seq.substr(0,idx),duration=seq.substr(idx+1);duration=eval(duration),hasTime=!0,seq=_value.trim().split("")}else seq=seq.trim().split(""),duration=1/seq.length;if(seq.indexOf(".rnd(")>-1&&(seq=seq.split(".rnd")[0],seq=seq.split("").rnd()),"undefined"!=typeof props[1]){duration=props[1],Array.isArray(duration)||(duration=[duration]);var durationsPattern=Gibber.construct(Gibber.Pattern,duration);if(duration.randomFlag){durationsPattern.filters.push(function(){return[durationsPattern.values[rndi(0,durationsPattern.values.length-1)],1]});for(var i=0;i<duration.randomArgs.length;i+=2)durationsPattern.repeat(duration.randomArgs[i],duration.randomArgs[i+1])}duration=durationsPattern}obj.seq.add({key:"note",values:Gibber.construct(Gibber.Pattern,seq),durations:Gibber.construct(Gibber.Pattern,[duration]),target:obj});var seqNumber=obj.seq.seqs.length-1;Object.defineProperties(obj.note,{values:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].values},set:function(a){var b=Gibber.construct(Gibber.Pattern,a);Array.isArray(b)||(b=[b]),obj.seq.seqs[seqNumber].values=b}},durations:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].durations},set:function(a){Array.isArray(a)||(a=[a]),obj.seq.seqs[seqNumber].durations=a}}})}break;case"object":"string"==typeof props[0].note&&(props[0].note=props[0].note.split("")),props[0].target=obj,props[0].durations=Gibber.Clock.Time(props[0].durations?props[0].durations:1/props[0].note.length),props[0].offset=props[0].offset?Gibber.Clock.time(props[0].offset):0;break;case"function":case"array":var length=props[0].length||props[0].values.length,durations="undefined"!=typeof arguments[1]?arguments[1]:Gibber.Clock.Time(1/length);"function"!=typeof durations&&(durations=Gibber.Clock.Time(durations)),obj.seq.add({key:"note",values:[props[0]],durations:durations,target:obj}),obj.pattern=obj.seq.seqs[obj.seq.seqs.length-1].values[0]}return"undefined"==typeof props&&(props={}),props.pitch&&(obj.pitch=props.pitch),"undefined"!=typeof props.snare&&($.extend(obj.snare.sampler,props.snare),$.extend(obj.snare,props.snare)),"undefined"!=typeof props.kick&&($.extend(obj.kick.sampler,props.kick),$.extend(obj.kick,props.kick)),"undefined"!=typeof props.hat&&($.extend(obj.hat.sampler,props.hat),$.extend(obj.hat,props.hat)),"undefined"!=typeof props.openHat&&($.extend(obj.openHat.sampler,props.openHat),$.extend(obj.openHat,props.openHat)),obj.amp=isNaN(_amp)?1:_amp,obj.seq&&obj.seq.tick&&Gibberish.future(obj.seq.tick,1),obj.start=function(){obj.seq.start(!0)},obj.stop=function(){obj.seq.stop()},obj.shuffle=function(){obj.seq.shuffle()},obj.reset=function(){obj.seq.reset()},Gibber.createProxyMethods(obj,["play","stop","shuffle","reset","start","send","note"]),obj.seq.start(!0),Object.defineProperties(obj,{offset:{get:function(){return obj.seq.offset},set:function(a){obj.seq.offset=Gibber.Clock.time(a)}}}),obj},Percussion.EDrums=function(_sequence,_timeValue,_amp,_freq){var args=Array.prototype.slice.call(arguments),obj={},props=Gibber.processArguments(args,"Drums");$.extend(!0,obj,props),obj=Array.isArray(obj)?Gibber.construct(Gibberish.Bus2,obj).connect(Gibber.Master):new Gibberish.Bus2(obj).connect(Gibber.Master),obj.name="XOX",obj.type="Gen",obj.children=[],$.extend(!0,obj,Gibber.Audio.ugenTemplate),obj.fx.ugen=obj,Object.defineProperty(obj,"_",{get:function(){return obj.kill(),obj},set:function(){}}),obj.pitch=1,obj.kick=Gibber.Audio.Percussion.Kick().disconnect(),obj.snare=Gibber.Audio.Percussion.Snare().disconnect(),obj.hat=Gibber.Audio.Percussion.Hat().disconnect(),obj.kick.connect(obj),obj.snare.connect(obj),obj.hat.connect(obj),obj.children.push(obj.kick,obj.snare,obj.hat),obj.mod=obj.polyMod,obj.removeMod=obj.removePolyMod,obj.set=function(a){obj.seq.note=a.split("")},Gibber.createProxyProperties(obj,_mappingProperties.XOX),obj.start=function(){obj.seq.start(!0)},obj.stop=function(){obj.seq.stop()},obj.shuffle=function(){obj.seq.shuffle()},obj.reset=function(){obj.seq.reset()};var kcd=1,scd=1,hcd=1,kf=null,sf=null,hf=null;if(obj.note=function(a){switch(a){case"x":1===kcd&&(kcd=0),obj.kick.note(),null!==kf&&(kf(),kf=null),kf=Gibber.Utilities.future(function(){kcd=1,kf=null},11e4*obj.kick.decay);break;case"o":1===scd&&(scd=0),obj.snare.note(),null!==sf&&(sf(),sf=null),sf=Gibber.Utilities.future(function(){scd=1,sf=null},obj.snare.decay);break;case"*":1===hcd&&(hcd=0),obj.hat.note(5e3),null!==hf&&(hf(),hf=null),hf=Gibber.Utilities.future(function(){hcd=1,hf=null},5500);break;case"-":1===hcd&&(hcd=0),obj.hat.note(3e4),null!==hf&&(hf(),hf=null),hf=Gibber.Utilities.future(function(){hcd=1,hf=null},30500)}},Gibber.createProxyMethods(obj,["play","stop","shuffle","reset","start","send"]),"undefined"!=typeof props)switch($.type(props[0])){case"string":for(var notes=props[0],_seqs=[],_durations=[],__durations=[],seqs=notes.split("|"),timeline={},i=0;i<seqs.length;i++)!function(num){var seq=seqs[num],duration,hasTime=!1,idx=seq.indexOf(",");if(idx>-1){var _value=seq.substr(0,idx),duration=seq.substr(idx+1);duration=eval(duration),hasTime=!0,seq=_value.trim().split("")}else seq=seq.trim().split(""),duration=1/seq.length;if(seq.indexOf(".rnd(")>-1&&(seq=seq.split(".rnd")[0],seq=seq.split("").rnd()),"undefined"!=typeof props[1]){duration=props[1],Array.isArray(duration)||(duration=[duration]);var durationsPattern=Gibber.construct(Gibber.Pattern,duration);if(duration.randomFlag){durationsPattern.filters.push(function(){return[durationsPattern.values[rndi(0,durationsPattern.values.length-1)],1]});for(var i=0;i<duration.randomArgs.length;i+=2)durationsPattern.repeat(duration.randomArgs[i],duration.randomArgs[i+1])}duration=durationsPattern}obj.seq.add({key:"note",values:Gibber.construct(Gibber.Pattern,seq),durations:Gibber.construct(Gibber.Pattern,[duration]),target:obj});var seqNumber=obj.seq.seqs.length-1;Object.defineProperties(obj.note,{values:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].values},set:function(a){var b=Gibber.construct(Gibber.Pattern,a);Array.isArray(b)||(b=[b]),obj.seq.seqs[seqNumber].values=b}},durations:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].durations},set:function(a){Array.isArray(a)||(a=[a]),obj.seq.seqs[seqNumber].durations=a}}})}(i);break;case"object":"string"==typeof props[0].note&&(props[0].note=props[0].note.split("")),props[0].target=obj,props[0].durations=Gibber.Clock.Time(props[0].durations?props[0].durations:1/props[0].note.length),props[0].offset=props[0].offset?Gibber.Clock.time(props[0].offset):0,obj.seq=Seq(props[0])}return"undefined"==typeof props&&(props={}),props.pitch&&(obj.pitch=props.pitch),"undefined"!=typeof props.snare&&($.extend(obj.snare.sampler,props.snare),$.extend(obj.snare,props.snare)),"undefined"!=typeof props.kick&&($.extend(obj.kick.sampler,props.kick),$.extend(obj.kick,props.kick)),"undefined"!=typeof props.hat&&($.extend(obj.hat.sampler,props.hat),$.extend(obj.hat,props.hat)),"undefined"!=typeof props.openHat&&($.extend(obj.openHat.sampler,props.openHat),$.extend(obj.openHat,props.openHat)),obj.amp=isNaN(_amp)?1:_amp,obj.seq.tick&&Gibberish.future(obj.seq.tick,1),obj.seq.start(!0),obj.toString=function(){return"EDrums : "+obj.seq.seqs[0].values.join("")},obj},Percussion.XOX=Percussion.EDrums,Percussion.Drums.kits={original:{kick:{file:"resources/audiofiles/kick.wav",symbol:"x",amp:1,pitch:1,pan:0},snare:{file:"resources/audiofiles/snare.wav",symbol:"o",amp:1,pitch:1,pan:.15},hat:{file:"resources/audiofiles/hat.wav",symbol:"*",amp:1,pitch:1,pan:-.1},openHat:{file:"resources/audiofiles/openHat.wav",symbol:"-",amp:1,pitch:1,pan:-.2}},electronic:{kick:{file:"resources/audiofiles/electronic/kick.wav",symbol:"x",amp:1.5,pitch:1,pan:0},snare:{file:"resources/audiofiles/electronic/snare.wav",symbol:"o",amp:1.5,pitch:1,pan:.15},hat:{file:"resources/audiofiles/electronic/hat.wav",symbol:"*",amp:1.5,pitch:1,pan:-.1},openHat:{file:"resources/audiofiles/electronic/openhat.wav",symbol:"-",amp:1.5,pitch:1,pan:-.2}},beatbox:{in_tss:{file:"resources/audiofiles/beatbox/^tss.wav",symbol:"T",amp:1,pitch:1,pan:.1},f:{file:"resources/audiofiles/beatbox/f.wav",symbol:"f",amp:1,pitch:1,pan:-.1},h:{file:"resources/audiofiles/beatbox/h.wav",symbol:"h",amp:1,pitch:1,pan:.1},s:{file:"resources/audiofiles/beatbox/s.wav",symbol:"s",amp:1,pitch:1,pan:-.1},d:{file:"resources/audiofiles/beatbox/d.wav",symbol:"d",amp:1,pitch:1,pan:.8},t:{file:"resources/audiofiles/beatbox/t.wav",symbol:"t",amp:1,pitch:1,pan:.4},k:{file:"resources/audiofiles/beatbox/k.wav",symbol:"k",amp:1,pitch:1,pan:-.1},in_k:{file:"resources/audiofiles/beatbox/^k.wav",symbol:"K",amp:1,pitch:1,pan:-.4},eight:{file:"resources/audiofiles/beatbox/8.wav",symbol:"8",amp:1,pitch:1,pan:-.8},psh:{file:"resources/audiofiles/beatbox/psh.wav",symbol:"p",amp:1,pitch:1,pan:.1},in_p:{file:"resources/audiofiles/beatbox/^p.wav",symbol:"P",amp:1,pitch:1,pan:-.1},pf:{file:"resources/audiofiles/beatbox/pf.wav",symbol:"F",amp:1,pitch:1,pan:.2},phs:{file:"resources/audiofiles/beatbox/phs.wav",symbol:"H",amp:1,pitch:1,pan:-.2},b:{file:"resources/audiofiles/beatbox/b.wav",symbol:"b",amp:1,pitch:1,pan:.3},dot:{file:"resources/audiofiles/beatbox/dot.wav",symbol:".",amp:1,pitch:1,pan:0},duf:{file:"resources/audiofiles/beatbox/duf.wav",symbol:"D",amp:1,pitch:1,pan:-.3},o:{file:"resources/audiofiles/beatbox/o.wav",symbol:"o",amp:1,pitch:1,pan:.6},a:{file:"resources/audiofiles/beatbox/a.wav",symbol:"a",amp:1,pitch:1,pan:.8},u:{file:"resources/audiofiles/beatbox/u.wav",symbol:"u",amp:1,pitch:1,pan:-.8},m:{file:"resources/audiofiles/beatbox/m.wav",symbol:"m",amp:1,pitch:1,pan:-.6},n:{file:"resources/audiofiles/beatbox/n.wav",symbol:"n",amp:1,pitch:1,pan:0}}},Percussion.Drums.kits["default"]=Percussion.Drums.kits.electronic,Percussion}},{"gibberish-dsp":2}],12:[function(a,b){b.exports=function(b){"use strict";for(var c={},d=a("gibberish-dsp"),e=b.dollar,f=(b.Clock,b.outputCurves),g=f.LINEAR,h=(f.LOGARITHMIC,["Line","AD","ADSR"]),i={Line:{start:{min:0,max:1,output:g,timescale:"audio"},end:{min:0,max:1,output:g,timescale:"audio"},time:{min:0,max:8,output:g,timescale:"audio"}},AD:{attack:{min:0,max:8,output:g,timescale:"audio"},decay:{min:0,max:8,output:g,timescale:"audio"},ADSR:{attack:{min:0,max:8,output:g,timescale:"audio"},decay:{min:0,max:8,output:g,timescale:"audio"},sustain:{min:0,max:8,output:g,timescale:"audio"},release:{min:0,max:8,output:g,timescale:"audio"}}}},j=0;j<h.length;j++)!function(){var a=Array.isArray(h[j])?h[j][0]:h[j],f=Array.isArray(h[j])?h[j][1]:h[j];c[f]=function(){var c,g=Array.prototype.slice.call(arguments,0);return c="object"!=typeof g[0]?new d[a](g[0],g[1],b.Clock.time(g[2]),g[3]):b.construct(d[a],g[0]),c.name=f,e.extend(!0,c,b.Audio.ugenTemplate),b.createProxyProperties(c,i[f]),b.processArguments2(c,g,c.name),("AD"===f||"ADSR"===f)&&b.createProxyMethods(c,["run"]),console.log(f+" is created."),c}}();return c}},{"gibberish-dsp":2}],13:[function(a,b){b.exports=function(b){"use strict";var c={Presets:{}},d=a("gibberish-dsp"),e=b.dollar,f=b.outputCurves,g=f.LINEAR,h=f.LOGARITHMIC;d.Gain=function(){d.extend(this,{name:"gain",type:"effect",properties:{input:0,amount:1},callback:function(a,b){return"object"==typeof a?(a[0]*=b,a[1]*=b):a*=b,a}}).init().processProperties(arguments)},d.Gain.prototype=d._effect;for(var i=["Reverb",["StereoReverb","StereoVerb"],"Delay","Flanger","Vibrato","Distortion","Biquad","Gain","Filter24",["RingModulation","RingMod"],["BufferShuffler","Schizo"],["Decimator","Crush"],"Tremolo"],j={Reverb:{roomSize:{min:.5,max:.995,output:g,timescale:"audio"},damping:{min:0,max:1,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},StereoReverb:{roomSize:{min:.5,max:.995,output:g,timescale:"audio"},damping:{min:0,max:1,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Delay:{feedback:{min:0,max:1,output:g,timescale:"audio"},time:{min:50,max:88200,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},RingMod:{frequency:{min:20,max:3e3,output:g,timescale:"audio"},amp:{min:0,max:1,output:g,timescale:"audio"},mix:{min:0,max:1,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Flanger:{rate:{min:.01,max:20,output:h,timescale:"audio"},feedback:{min:0,max:.99,output:g,timescale:"audio"},amount:{min:25,max:300,output:g,
timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Gain:{amount:{min:0,max:1,output:g,timescale:"audio"}},Vibrato:{rate:{min:.2,max:8,output:h,timescale:"audio"},amount:{min:25,max:300,output:g,timescale:"audio"},feedback:{min:.45,max:.55,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Filter24:{cutoff:{min:0,max:.7,output:g,timescale:"audio"},resonance:{min:0,max:5.5,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},LPF:{cutoff:{min:.05,max:.7,output:g,timescale:"audio"},resonance:{min:0,max:5.5,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},HPF:{cutoff:{min:0,max:.7,output:g,timescale:"audio"},resonance:{min:0,max:5.5,output:g,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Crush:{bitDepth:{min:1,max:16,output:g,timescale:"audio"},sampleRate:{min:0,max:1,output:g,timescale:"audio"},amp:{min:0,max:1,output:h,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Schizo:{amp:{min:0,max:1,output:h,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}},Tremolo:{amp:{min:0,max:1,output:h,timescale:"audio"},frequency:{min:.05,max:20,output:h,timescale:"audio"},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}}},k=0;k<i.length;k++)!function(){var a=Array.isArray(i[k])?i[k][0]:i[k],f=Array.isArray(i[k])?i[k][1]:i[k];c[f]=function(){var c,g=Array.prototype.slice.call(arguments,0);return c=new d[a],c.type="FX",c.name=f,e.extend(!0,c,b.Audio.ugenTemplate),b.createProxyProperties(c,j[f]),b.createProxyMethods(c,["send"]),b.processArguments2(c,g,c.name),g.input=0,c.toString=function(){return"> "+f},c}}();return c.Chorus=function(a,b,c){var d=a||1,e=c||ms(1),f=b||0,g=Flanger(d,f,e,30*ms(1));return g.name="Chorus",g.type="FX",g},c.LPF=function(a,b){var c=isNaN(a)?.2:a,d=isNaN(b)?3.5:b,e=Filter24(c,d,!0);return e.name="LPF",e.type="FX",e},c.HPF=function(a,b){var c=isNaN(a)?.25:a,d=isNaN(b)?3.5:b,e=Filter24(c,d,!0);return e.isLowPass=!1,e.name="HPF",e.type="FX",e},c.Presets.Schizo={sane:{chance:.1,reverseChance:0,pitchChance:.5,mix:.5},borderline:{chance:.1,pitchChance:.25,reverseChance:.5,mix:1},paranoid:{chance:.2,reverseChance:.5,pitchChance:.5,mix:1}},c.Presets.Reverb={space:{roomSize:.99,damping:.23,wet:.75,dry:.25},small:{roomSize:.6,damping:.75,wet:.15,dry:.85},medium:{roomSize:.8,damping:.5,wet:.35,dry:.65},large:{roomSize:.85,damping:.3,wet:.55,dry:.45}},c.Presets.StereoVerb={space:{roomSize:.99,damping:.23,wet:.75,dry:.25},small:{roomSize:.6,damping:.75,wet:.15,dry:.85},medium:{roomSize:.8,damping:.5,wet:.35,dry:.65},large:{roomSize:.85,damping:.3,wet:.55,dry:.45}},c.Presets.Crush={clean:{sampleRate:1,bitDepth:16},dirty:{sampleRate:.25,bitDepth:4},filthy:{sampleRate:.1,bitDepth:2.5}},c}},{"gibberish-dsp":2}],14:[function(a,b){b.exports=function(a){a.apiKey="4287s0onpqpp492n8snr27sp3o228nns".replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(("Z">=a?90:122)>=(a=a.charCodeAt(0)+13)?a:a-26)});var b=function(){var c,d,e=Sampler(),f=arguments[0]||96541,g=null;e.done=function(a){g=a};var h=function(a){Gibber.log(c+" loaded."),Gibber.Audio.Core.context.decodeAudioData(a.response,function(a){b.loaded[c]=a.getChannelData(0),e.buffer=b.loaded[c],e.bufferLength=e.buffer.length,e.isLoaded=!0,e.end=e.bufferLength,e.setBuffer(e.buffer),e.setPhase(e.bufferLength),e.filename=c,e.send(Master,1),g&&g()},function(a){console.log("Error with decoding audio data"+a.err)})};if("string"==typeof f){var i=f;Gibber.log("searching freesound for "+i),a.search(i,0,"duration:[0.0 TO 10.0]","rating_desc",null,null,null,function(d){if(c=d.sounds[0].original_filename,"undefined"==typeof b.loaded[c]){var f=new XMLHttpRequest;Gibber.log("now downloading "+c+", "+d.sounds[0].duration+" seconds in length"),f.open("GET",d.sounds[0].serve+"?&api_key="+a.apiKey,!0),f.responseType="arraybuffer",f.onload=function(){h(f)},f.send()}else e.buffer=b.loaded[c],e.filename=c,e.bufferLength=e.buffer.length,e.isLoaded=!0,e.end=e.bufferLength,e.setBuffer(e.buffer),e.setPhase(e.bufferLength),e.send(Master,1),g&&g()},function(){displayError("Error while searching...")})}else if("object"==typeof f){var i=f.query,j=f.filter||"",k=f.sort||"rating_desc",l=f.page||0;pick=f.pick||0,Gibber.log("searching freesound for "+i),j+=" duration:[0.0 TO 10.0]",a.search(i,l,j,k,null,null,null,function(i){if(i.num_results>0){var j=0;"number"==typeof f.pick?j=f.pick:"function"==typeof f.pick?j=f.pick():"random"===f.pick&&(j=rndi(0,i.sounds.length)),c=i.sounds[j].original_filename,"undefined"==typeof b.loaded[c]?(d=new XMLHttpRequest,Gibber.log("now downloading "+c+", "+i.sounds[j].duration+" seconds in length"),d.open("GET",i.sounds[j].serve+"?&api_key="+a.apiKey,!0),d.responseType="arraybuffer",d.onload=function(){h(d)},d.send()):(Gibber.log("using exising loaded sample "+c),e.buffer=b.loaded[c],e.bufferLength=e.buffer.length,e.isLoaded=!0,e.end=e.bufferLength,e.setBuffer(e.buffer),e.setPhase(e.bufferLength),e.send(Master,1),g&&g())}else Gibber.log("No Freesound files matched your query.")},function(){console.log("Error while searching...")})}else"number"==typeof f&&(Gibber.log("downloading sound #"+f+" from freesound.org"),a.get_sound(f,function(b){d=new XMLHttpRequest,c=b.original_filename,d.open("GET",b.serve+"?api_key="+a.apiKey,!0),d.responseType="arraybuffer",d.onload=function(){h(d)},d.send()}));return e};return b.loaded={},b}},{}],15:[function(a,b){b.exports=function(b){"use strict";for(var c=b.dollar,d={Presets:{}},e=a("gibberish-dsp"),f=b.outputCurves,g=f.LINEAR,h=f.LOGARITHMIC,i=["Sine","Triangle","Saw","Square","Noise","PWM"],j={frequency:{min:50,max:3200,hardMin:.01,hardMax:22050,output:h,timescale:"audio",dimensions:1},amp:{min:0,max:1,hardMax:2,output:h,timescale:"audio",dimensions:1},pulsewidth:{min:.01,max:.99,output:g,timescale:"audio",dimensions:1},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1},pan:{min:-1,max:1,output:h,timescale:"audio"},note:{min:50,max:3200,hardMin:.01,hardMax:22050,output:h,timescale:"audio",doNotProxy:!0}},k=0;k<i.length;k++)!function(){var a=Array.isArray(i[k])?i[k][0]:i[k],f=Array.isArray(i[k])?i[k][1]:i[k];d[f]=function(){var d=(new e[a]).connect(b.Master),g=Array.prototype.slice.call(arguments,0);d.type="Gen",c.extend(!0,d,b.Audio.ugenTemplate),d.fx.ugen=d,Object.defineProperty(d,"_",{get:function(){return d.kill(),d},set:function(){}}),"undefined"==typeof d.note&&(d.note=function(a){var b=this.frequency();"number"==typeof b||"function"==typeof b?this.frequency="function"==typeof a?a():a:b[0]=a}),d.name=f,b.createProxyProperties(d,j);var h=["note","send"];return"Sampler"===f&&h.push("pickBuffer"),b.createProxyMethods(d,h),b.processArguments2(d,g,f),d.toString=function(){return"> "+f},d}}();return d.Wavetable=function(a){var d=(new e.Table).connect(b.Master);return a&&d.setTable(a),d.type="Gen",c.extend(!0,d,b.Audio.ugenTemplate),d.fx.ugen=d,Object.defineProperty(d,"_",{get:function(){return d.kill(),d},set:function(){}}),"undefined"==typeof d.note&&(d.note=function(a){var b=this.frequency();"number"==typeof b||"function"==typeof b?this.frequency="function"==typeof a?a():a:b[0]=a}),b.createProxyProperties(d,{frequency:{min:50,max:3200,output:h,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:h,timescale:"audio",dimensions:1},out:{min:0,max:1,output:g,timescale:"audio",dimensions:1}}),b.createProxyMethods(d,["note"]),obj.toString=function(){return"> Wavetable"},d},d.Grains=function(){var a,d="object"==typeof arguments[0]?arguments[0]:arguments[1],f=d.bufferLength||88200,g=Sampler().record(d.input,f);if("string"==typeof arguments[0]){var h=b.Presets.Grains[arguments[0]];"undefined"!=typeof d&&c.extend(h,d),a=new e.Granulator(h)}else a=new e.Granulator(d);return a.loop=function(a,c,d,f){var g=this.position;a=isNaN(a)?.25:a,c=isNaN(c)?.75:c,d=b.Clock.time(isNaN(d)?1:d),f="undefined"==typeof f?!0:f,this.position=new e.Line(a,c,d,f);var h=this;f===!1&&future(function(){h.position=g},b.Clock.time(d))},future(function(){a.setBuffer(g.getBuffer()),a.connect(),a.loop(0,1,f),g.disconnect()},f+1),a.type="Gen",c.extend(!0,a,b.Audio.ugenTemplate),a.fx.ugen=a,Object.defineProperty(a,"_",{get:function(){return a.disconnect(),a},set:function(){}}),a.toString=function(){return"Grains"},a},d.Presets.Grains={tight:{numberOfGrains:10,grainSize:1100,positionMin:-.05,positionMax:.05,speedMin:-.1,speedMax:.1,shouldReverse:!1},cloudy:{numberOfGrains:20,positionMin:-.25,positionMax:.25,speedMin:-.1,speedMax:4,grainSize:4400,shouldReverse:!0},flurry:{speed:2,speedMin:-2,speedMax:2,position:0,positionMin:0,positionMax:0,numberOfGrains:20,grainSize:1100}},d}},{"gibberish-dsp":2}],16:[function(a,b){b.exports=function(){"use strict";var b,c=a("gibberish-dsp"),d=null,e=null,f=null,g=b={Compressor:function(a){if(null===d){d=c.context.createDynamicsCompressor();var b=d.threshold,e=d.ratio,f=d.attack,h=d.release;Object.defineProperties(d,{threshold:{get:function(){return b.value},set:function(a){b.value=a}},ratio:{get:function(){return e.value},set:function(a){e.value=a}},attack:{get:function(){return f.value},set:function(a){f.value=a}},release:{get:function(){return h.value},set:function(a){h.value=a}}}),g.insert(d,a)}return d},LowShelf:function(a){if(null===f){f=c.context.createBiquadFilter(),f.type=3,f.frequency.value=220,f.Q.value=0,f.gain.value=6;var b=f.gain,d=f.frequency,e=f.Q;Object.defineProperties(f,{frequency:{get:function(){return d.value},set:function(a){d.value=a}},gain:{get:function(){return b.value},set:function(a){b.value=a}},Q:{get:function(){return e.value},set:function(a){e.value=a}}}),g.insert(f,a)}return f},HiShelf:function(a){if(null===e){e=c.context.createBiquadFilter(),e.type=4,e.frequency.value=880,e.Q.value=0,e.gain.value=6;var b=e.gain,d=e.frequency,f=e.Q;Object.defineProperties(e,{frequency:{get:function(){return d.value},set:function(a){d.value=a}},gain:{get:function(){return b.value},set:function(a){b.value=a}},Q:{get:function(){return f.value},set:function(a){f.value=a}}}),g.insert(e,a)}return e}};return b}},{"gibberish-dsp":2}],17:[function(a,b){b.exports=function(b){"use strict";var c={Presets:{}},d=a("gibberish-dsp"),e=b.dollar,f=a("./clock")(b),g=b.outputCurves,h=g.LINEAR,i=g.LOGARITHMIC,j={amp:{min:0,max:1,hardMax:2,output:i,timescale:"audio",dimensions:1},start:{min:0,max:1,output:h,timescale:"audio",dimensions:1},end:{min:0,max:1,output:h,timescale:"audio",dimensions:1},pitch:{min:1,max:4,hardMin:.01,hardMax:20,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1},pan:{min:-1,max:1,output:i,timescale:"audio"},note:{min:.1,max:4,output:i,timescale:"audio",doNotProxy:!0}};return c.Sampler=function(){var a=Array.prototype.slice.call(arguments,0),c=a[0]&&a[0].file?a[0].file:void 0,f=new d.Sampler(c).connect(b.Master);name="Sampler",f.type="Gen",e.extend(!0,f,b.Audio.ugenTemplate),f.fx.ugen=f,Object.defineProperty(f,"_",{get:function(){return f.kill(),f},set:function(){}}),"undefined"==typeof f.note&&(f.note=function(a){var b=this.frequency();"number"==typeof b||"function"==typeof b?this.frequency="object"==typeof a?a.value:a:b[0]=a});var g=f.__lookupSetter__("start").bind(f),h=0;Object.defineProperty(f,"start",{configurable:!0,get:function(){return h},set:function(a){return h=1>=a?a*f.bufferLength:a,g(h),h}});var i=f.__lookupSetter__("end").bind(f),k=1;Object.defineProperty(f,"end",{configurable:!0,get:function(){return k},set:function(a){return k=1>=a?a*f.bufferLength:a,i(k),k}}),b.createProxyProperties(f,j);var l=["note","pickBuffer"];return b.createProxyMethods(f,l),b.processArguments2(f,a,name),f.toString=function(){return name},f},d.Sampler.prototype.readFile=function(a){var b=this;if(a.isFile)return void a.file(function(a){b.readFile(a)});var c=new FileReader;c.readAsArrayBuffer(a),c.onload=function(){d.context.decodeAudioData(c.result,function(c){var e=c.getChannelData(0);b.setBuffer(e),b.length=b.end=e.length,b.buffers[a.name]=e,b.isPlaying=!0,console.log("LOADED",a.name,e.length),d.audioFiles[a.name]=e,b.onload&&b.onload(),0!==b.playOnLoad&&b.note(b.playOnLoad),b.isLoaded=!0})}},d.Sampler.prototype.ondrop=function(a){for(var b=0;b<a.length;b++)!function(c){{var d,e=a[b];new FileReader}if(d=e.webkitGetAsEntry(),d.isDirectory){var f=d.createReader();f.readEntries(function(a){for(var b=a.length;b--;)c.readFile(a[b])})}else c.readFile(d)}(this)},d.Sampler.prototype.pickBuffer=function(){this.switchBuffer(rndi(0,this.getNumberOfBuffers()))},d.Sampler.prototype.record=function(a,c){this.isRecording=!0,console.log("starting recording");var e=this;return this.recorder=new d.Record(a,b.Clock.time(c),function(){console.log("recording finished"),e.setBuffer(this.getBuffer()),e.length=e.end=e.getBuffer().length,e.setPhase(e.length),e.isRecording=!1}).record(),this},c.Looper=function(a,c,d){var g=Bus();e.extend(g,{children:[],input:a,length:f.time(c),numberOfLoops:d,pitch:1,currentLoop:0,loop:function(){g.children[g.currentLoop].record(g.input,g.length);var a={target:g.children[g.currentLoop],durations:g.length,key:"note",values:[null]};return g.seq.add(a),g.seq.start(),future(g.nextLoop,c),g},nextLoop:function(){g.children[++g.currentLoop].record(g.input,g.length),g.currentLoop<g.numberOfLoops-1&&future(g.nextLoop,c);var a={target:g.children[g.currentLoop],durations:g.length,key:"note",values:[null]};g.seq.add(a)}});var h=1;Object.defineProperty(g,"pitch",{configurable:!0,get:function(){return h},set:function(a){h=a;for(var b=0;b<g.children.length;b++)g.children[b].pitch=h}});for(var i=0;d>i;i++)g.children.push(Sampler({pitch:g.pitch})._),g.children[i].send(g,1);return b.createProxyProperties(g,{pitch:j.pitch}),g.stop=function(){g.seq.stop()},g.play=function(){g.seq.play()},g},c}},{"./clock":10,"gibberish-dsp":2}],18:[function(a,b){b.exports=function(b){var c=a("gibberish-dsp"),d=b.dollar,e=["durations","target","scale","offset","doNotStart","priority"],f=function(){var a,g={},h=[];if("object"!=typeof arguments[0]||Array.isArray(arguments[0]))("function"==typeof arguments[0]||Array.isArray(arguments[0]))&&(g.seqs=[{key:"functions",values:Array.isArray(arguments[0])?arguments[0]:[arguments[0]],durations:b.Clock.time(arguments[1])}],h.push("functions"));else{{var i=arguments[0];typeof i.durations,typeof i.target,i.priority}if(g.target=i.target,"object"==typeof i.scale&&(g.scale=i.scale),"number"==typeof i.offset&&(g.offset=b.Clock.time(i.offset)),g.durations=i.durations,g.keysAndValues={},g.seqs=[],g.autofire=[],g.durations){Array.isArray(g.durations)||(g.durations=[g.durations]);var j=b.construct(b.Pattern,g.durations);if(g.durations.randomFlag){j.filters.push(function(){var a=b.Utilities.rndi(0,j.values.length-1);return[j.values[a],1,a]});for(var k=0;k<g.durations.randomArgs.length;k+=2)j.repeat(g.durations.randomArgs[k],g.durations.randomArgs[k+1])}}for(var l in i)!function(){var a=l;if(-1===e.indexOf(a)){var c,d=Array.isArray(i[a]),f={key:a,target:g.target,durations:j};if(d?c=b.construct(b.Pattern,i[a]):"undefined"!=typeof i[a]&&(c=b.construct(b.Pattern,[i[a]])),i[a].randomFlag){c.filters.push(function(){var a=b.Utilities.rndi(0,c.values.length-1);return[c.values[a],1,a]});for(var k=0;k<i[a].randomArgs.length;k+=2)c.repeat(i[a].randomArgs[k],i[a].randomArgs[k+1])}"note"===a&&c.filters.push(function(){var a=arguments[0][0];return a<b.minNoteFrequency&&(a=g.scale?g.scale.notes[a]:b.scale.notes[a]),[a,arguments[0][1],arguments[0][2]]}),f.values=c,g.seqs.push(f),h.push(a)}}();if("scale"in g){var m=(h.indexOf("note"),h.indexOf("chord"));if(m>-1){var n=d.extend([],g.seqs[m]),o=0;g.seqs[m]=[function(){var a,b=[];return a="function"==typeof n.pick?n[n.pick()]:"function"==typeof n[o]?n[o]():n[o++],b=g.scale.chord(a),o>=n.length&&(o=0),b}]}}}a=new c.PolySeq(g),a.timeModifier=b.Clock.time.bind(b.Clock),a.name="Seq",a.save={},a.oldShuffle=a.shuffle,delete a.shuffle,a.rate=b.Clock;var p=a.__lookupSetter__("rate"),q=a.rate;Object.defineProperty(a,"rate",{get:function(){return q},set:function(c){q=Mul(b.Clock,c),p.call(a,q)}});var r=a.nextTime,s=a.__lookupSetter__("nextTime");Object.defineProperty(a,"nextTime",{get:function(){return r},set:function(a){r=b.Clock.time(a),s(r)}});var t=a.offset;Object.defineProperty(a,"offset",{get:function(){return t},set:function(b){t=b,a.nextTime+=t}}),a.nextTime+=a.offset;for(var k=0;k<h.length;k++)!function(a){var b=h[k],c=k;Object.defineProperty(a,b,{get:function(){return a.seqs[c].values},set:function(b){a.seqs[c].values=b}})}(a);var u=j;return Object.defineProperty(a,"durations",{get:function(){return u},set:function(b){u=b;for(var c=0;c<a.seqs.length;c++){var d=a.seqs[c];d.durations=u}}}),arguments[0]&&!arguments[0].doNotStart&&a.start(!0),a.toString=function(){return"> Seq"},a.gibber=!0,d.extend(a,{constructor:f,replaceWith:function(){this.kill()},kill:function(){this.target&&this.target.sequencers&&this.target.sequencers.splice(this.target.sequencers.indexOf(this),1),console.log("SEQ KILL",this),this.stop().disconnect()},applyScale:function(){},once:function(){return this.repeat(1),this},reset:function(){for(var a=0;a<this.seqs.length;a++)this.seqs[a].values[0].reset()},shuffle:function(){for(var a=0;a<this.seqs.length;a++)this.seqs[a].values[0].shuffle()}}),a},g=function(){var a,c=arguments[0];return c.root=c.root||"c4",c.mode=c.mode||"aeolian",a=b.Theory.Scale(c.root,c.mode),delete c.root,delete c.mode,c.scale=a,f(c)},h={Seq:f,ScaleSeq:g};return h}},{"gibberish-dsp":2}],19:[function(a,b){b.exports=function(b,c){var d,e=a("gibberish-dsp"),f=b.outputCurves,g=a("./theory")(b).Teoria,h=(f.LINEAR,f.LOGARITHMIC),i={amp:{min:0,max:1,hardMax:2,output:h,timescale:"audio",dimensions:1}},j=function(a,b){return a*Math.pow(2,b/1200)};d={piano:"acoustic_grand_piano",guitar:"electric_guitar_clean",bass:"acoustic_bass",organ:"rock_organ",brass:"synth_brass_1",strings:"synth_strings_1",choir:"choir_aahs"};var k=function(a){var c,f=k.path;return b.Environment&&b.Environment.Storage.values.soundfonts&&b.Environment.Storage.values.soundfonts[a]&&(f=b.Environment.Storage.values.soundfonts[a]),d[a]&&(a=d[a]),c=new e.SoundFont(arguments[0],f).connect(b.Master),$.extend(!0,c,b.Audio.ugenTemplate),c.fx.ugen=c,c.chord=b.Theory.chord,Object.defineProperty(c,"_",{get:function(){return c.kill(),c},set:function(){}}),c.onload=function(){if(b.Environment&&b.Environment.Storage.values.saveSoundFonts){if(b.Environment.Storage.values.soundfonts){if(b.Environment.Storage.values.soundfonts[a])return}else b.Environment.Storage.values.soundfonts={};b.Environment.Storage.values.soundfonts[a]=b.Audio.Core.SoundFont.storage[a];try{b.Environment.Storage.save()}catch(c){console.log("STORAGE ERROR",c),"QuotaExceededError"===c.name&&console.log("Your localStorage for Gibber has been exceeded; we can't save the soundfile. It is still usable.")}}},c._note=c.note.bind(c),c.note=function(a,d){if("number"==typeof a){if(a<b.minNoteFrequency){var e=this.scale||b.scale,f=e.notes[a];if(this.octave&&0!==this.octave)for(var h=this.octave>0?1:0,i=Math.abs(this.octave),k=0;i>k;k++)f*=h?2:.5;a=f}var l,m=g.frequency.note(a),n=0;if(1===m.note.accidental.value&&"b"!==m.note.accidental.sign)for(var o=m.note.enharmonics(),k=0;k<o.length;k++){var p=o[k];if("b"===p.accidental.sign){m.note=p;break}}n=m.cents,l=m.note.name.toUpperCase(),0!==m.note.accidental.value&&(l+=m.note.accidental.sign),l+=m.note.octave,a=l}c._note(a,isNaN(d)?1:d,j(1,n))},b.createProxyProperties(c,i),b.createProxyMethods(c,["note","chord","send"]),c};return k.path=c||"../../../resources/soundfonts/",k}},{"./theory":21,"gibberish-dsp":2}],20:[function(a,b){b.exports=function(b){"use strict";for(var c={Presets:{}},d=a("gibberish-dsp"),e=b.dollar,f=a("./clock")(b),g=b.outputCurves,h=g.LINEAR,i=g.LOGARITHMIC,j=[["PolySynth","Synth"],["PolyFM","FM"],["PolySynth2","Synth2"],["MonoSynth","Mono"],["PolyKarplusStrong","Pluck"]],k={Synth:{note:{min:50,max:3200,output:i,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:i,timescale:"audio"},amp:{min:0,max:1,output:i,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:h,timescale:"audio"},attack:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},decay:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},sustain:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},release:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},pan:{min:-1,max:1,output:i,timescale:"audio"},sustainLevel:{min:.01,max:1,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1}},Synth2:{note:{min:50,max:3200,output:i,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:h,timescale:"audio"},amp:{min:0,max:1,output:i,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:h,timescale:"audio"},attack:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},decay:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},sustain:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},release:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},sustainLevel:{min:.01,max:1,output:i,timescale:"audio"},cutoff:{min:0,max:.7,output:h,timescale:"audio"},resonance:{min:0,max:5.5,output:h,timescale:"audio"},pan:{min:-1,max:1,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1}},Mono:{note:{min:50,max:3200,output:i,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:h,timescale:"audio"},amp:{min:0,max:1,output:i,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:h,timescale:"audio"},attack:{min:f.maxMeasures+1,max:176400,output:i,timescale:"audio"},decay:{min:f.maxMeasures+1,max:176400,output:i,timescale:"audio"},cutoff:{min:0,max:.7,output:h,timescale:"audio"},detune2:{min:0,max:.15,output:h,timescale:"audio"},detune3:{min:0,max:.15,output:h,timescale:"audio"},glide:{min:.99,max:.999995,output:h,timescale:"audio"},resonance:{min:0,max:5.5,output:h,timescale:"audio"},pan:{min:-1,max:1,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1}},FM:{note:{min:50,max:3200,output:i,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:h,timescale:"audio"},amp:{min:0,max:1,output:i,timescale:"audio"},attack:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},decay:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},sustain:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},release:{min:f.maxMeasures+1,max:176400,output:h,timescale:"audio"},sustainLevel:{min:.01,max:1,output:i,timescale:"audio"},cmRatio:{min:.1,max:50,output:h,timescale:"audio"},index:{min:.1,max:50,output:h,timescale:"audio"},pan:{min:-1,max:1,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1}},Pluck:{note:{min:50,max:3200,output:i,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:h,timescale:"audio"},amp:{min:0,max:1,output:i,timescale:"audio"},blend:{min:0,max:1,output:h,timescale:"audio"},damping:{min:0,max:1,output:h,timescale:"audio"},pan:{min:-1,max:1,output:i,timescale:"audio"},out:{min:0,max:1,output:h,timescale:"audio",dimensions:1}}},l=0;l<j.length;l++)!function(){var a=Array.isArray(j[l])?j[l][0]:j[l],f=Array.isArray(j[l])?j[l][1]:j[l];c[f]=function(){var c,g,h=Array.prototype.slice.call(arguments),i=1,j=!1,l=!1;if("object"==typeof h[0]&&("undefined"!=typeof h[0].maxVoices&&h[0].maxVoices&&(i=h[0].maxVoices),"undefined"!=typeof h[0].useADSR?(j=h[0].useADSR,"undefined"!=typeof h[0].requireReleaseTrigger&&(l=h[0].requireReleaseTrigger)):l=!1,"undefined"!=typeof h[0].useADSR&&(j=h[0].useADSR),"undefined"!=typeof h[0].scale&&(g=h[0].scale)),c=new d[a]({maxVoices:i,useADSR:j,requireReleaseTrigger:l,scale:g}).connect(b.Master),c.type="Gen",e.extend(!0,c,b.Audio.ugenTemplate),c.fx.ugen=c,"Mono"===f&&(c.note=function(a,b){"undefined"!=typeof b&&0!==b&&(this.amp=b),0!==b&&("object"!=typeof this.frequency?this.frequency=a:"property"!==this.frequency.type?(this.frequency[0]=a,d.dirty(this)):this.frequency=a,c.envelope.getState()>0&&c.envelope.run())}),c._note=c.note.bind(c),c.note=function(){var a=Array.prototype.splice.call(arguments,0);if("string"==typeof a[0])a[0]=b.Theory.Teoria.note(a[0]).fq();else if(a[0]<b.minNoteFrequency){var d=c.scale||b.scale,e=d.notes[a[0]];if(c.octave&&0!==c.octave)for(var f=c.octave>0?1:0,g=Math.abs(c.octave),h=0;g>h;h++)e*=f?2:.5;a[0]=e}return this._note.apply(this,a),this},c.chord=b.Theory.chord,Object.defineProperty(c,"_",{get:function(){return c.kill(),c},set:function(){}}),b.createProxyProperties(c,k[f]),b.createProxyMethods(c,["note","chord","send"]),c.name=f,b.processArguments2(c,h,c.name),c.toString=function(){return f},"Mono"!==f){var m=c._frequency;Object.defineProperty(c,"frequency",{configurable:!0,get:function(){return this._frequency},set:function(a){if(m=a,this.children)for(var b=0;b<this.children.length;b++)"number"==typeof this.children[b].frequency?this.children[b].frequency=m:this.children[b].frequency[0]=m}})}var n=c.scale;return c.scale&&(c.seq.scale=n),Object.defineProperty(c,"scale",{get:function(){return n},set:function(a){n=a,c.seq.scale=n}}),c}}();return c.Presets.Synth={"short":{attack:44,decay:1/16},bleep:{waveform:"Sine",attack:44,decay:1/16},cascade:{waveform:"Sine",maxVoices:10,attack:f.maxMeasures,decay:f.beats(1/32),presetInit:function(){this.fx.add(b.Audio.FX.Delay(1/9,.2),b.Audio.FX.Flanger()),this.pan=Sine(.25,1)._}},rhodes:{waveform:"Sine",maxVoices:4,attack:44,decay:1,presetInit:function(){this.fx.add(b.Audio.FX.Tremolo(2,.2))}},calvin:{waveform:"PWM",maxVoices:4,amp:.075,attack:f.maxMeasures,decay:.25,presetInit:function(){this.fx.add(b.Audio.FX.Delay(1/6,.5),b.Audio.FX.Vibrato())}},warble:{waveform:"Sine",attack:f.maxMeasures,presetInit:function(){this.fx.add(b.Audio.FX.Vibrato(2),b.Audio.FX.Delay(1/6,.75))}}},c.Presets.Synth2={pad2:{waveform:"Saw",maxVoices:4,attack:1.5,decay:.5,cutoff:.3,filterMult:.35,resonance:4.5,amp:.2,presetInit:function(){this.fx.add(b.Audio.FX.Delay(1/9,.75))}},pad4:{waveform:"Saw",maxVoices:4,attack:2,decay:2,cutoff:.3,filterMult:.35,resonance:4.5,amp:.2,presetInit:function(){this.fx.add(b.Audio.FX.Delay(1/9,.75))}}},c.Presets.Mono={"short":{attack:44,decay:1/16},lead:{presetInit:function(){this.fx.add(b.Audio.FX.Delay(.25,.35),b.Audio.FX.Reverb())},attack:1/8,decay:.5,octave3:0,cutoff:.2,filterMult:.5,resonance:5,isLowPass:!1},winsome:{presetInit:function(){this.lfo=b.Audio.Oscillators.Sine(.234375)._,this.lfo.amp=.075,this.lfo.frequency=2,this.cutoff=this.lfo,this.detune2=this.lfo},attack:f.maxMeasures,decay:1,cutoff:.2},bass:{attack:f.maxMeasures,decay:1/8-f.maxMeasures,octave:-2,octave2:-1,cutoff:.5,filterMult:.2,resonance:1},bass2:{attack:f.maxMeasures,decay:1/6,octave:-2,octave2:0,octave3:0,cutoff:.5,filterMult:.2,resonance:1,amp:.65},easy:{attack:f.maxMeasures,decay:2,octave2:0,octave3:0,cutoff:.3,glide:.9995},easyfx:{attack:f.maxMeasures,decay:2,presetInit:function(){this.fx.add(b.Audio.FX.Delay(f.time(1/6),.3))},amp:.3,octave2:0,octave3:0,cutoff:.3,glide:.9995},dark:{resonance:0,attack:44,cutoff:.075,amp:.35,filterMult:0},dark2:{filterMult:.1,attack:f.maxMeasures,octave2:0,octave3:0,decay:.25,amp:.45},noise:{resonance:20,decay:.5,cutoff:.3,glide:.99995,detune3:0,detune2:0,filterMult:0,presetInit:function(){this.fx.add(b.Audio.FX.Gain(.1),b.Audio.FX.Delay(1/6,.35))}}},c.Presets.FM={stabs:{maxVoices:4,cmRatio:1/1.0007,index:5,attack:f.maxMeasures,decay:1/8,amp:.1,presetInit:function(){this.bus=b.Audio.Busses.Bus().fx.add(b.Audio.FX.Delay(1/8,.75),b.Audio.FX.LPF({resonance:4})),this.bus.fx[1].cutoff=b.Audio.Core.Binops.Add(.25,b.Audio.Oscillators.Sine(.1,.2)._),this.send(this.bus,.65)}},bass:{cmRatio:1,index:3,presetInit:function(){this.attack=ms(1)},decay:1/16,octave:-2},glockenspiel:{cmRatio:3.5307,index:1,attack:44,decay:44100},radio:{cmRatio:1,index:40,attack:13230,decay:22050},noise:{cmRatio:.04,index:1e3,attack:44.1,decay:4410},frog:{cmRatio:.1,index:2,attack:13230,decay:220.5},gong:{cmRatio:1.4,index:.95,attack:44.1,decay:220500},drum:{cmRatio:1.40007,index:2,attack:44,decay:44100},drum2:{cmRatio:1+Math.sqrt(2),index:.2,attack:44,decay:882},brass:{maxVoices:4,cmRatio:1/1.0007,index:5,attack:4100,decay:1},clarinet:{cmRatio:1.5,index:1.5,attack:2205,decay:8820}},c}},{"./clock":10,"gibberish-dsp":2}],21:[function(a,b){b.exports=function(b){"use strict";var c=a("../../external/teoria.min"),d=b.dollar,e={Teoria:c,Scale:function(a,f){var g={root:"string"==typeof a?c.note(a):a,notes:[],degree:1,chord:function(a,b){var c=[];b=b||0;for(var d=0;d<a.length;d++)c.push(this.notes[a[d]+b]);return c},create:function(){var a="number"!=typeof i?c.note(i).fq():i,d=h;if(this.notes.length=0,b.Theory.Scales[d]){var e=b.Theory.Scales[d](a);e.create(a),this.notes=e.notes}else console.log("No scale for the mode "+h+" exists.")},set:function(a,b){Array.isArray(arguments[0])?(this.root=arguments[0][0],this.mode=arguments[0][1]):(this.root=a,this.mode=b)}},h=f||"aeolian";Object.defineProperty(g,"mode",{configurable:!0,get:function(){return h},set:function(a){h=a,g.create()}});var i=a||440;return Object.defineProperty(g,"root",{get:function(){return i},set:function(a){"number"==typeof a?i=a:"string"==typeof a?i=e.Teoria.note(a).fq():"object"==typeof a&&(i=a.accidental?a.fq():e.Teoria.note(a.value).fq()),g.create()}}),g.gibber=!0,b.createProxyProperty(g,"root",!0,!1,null,!1,1),b.createProxyProperty(g,"mode",!0,!1,null,!1,1),d.subscribe("/gibber/clear",function(){g.seq.isConnected=!1,g.seq.isRunning=!1,g.seq.destinations.length=0}),g.create(i),g},CustomScale:function(a,b){var d={notes:[],degree:1,ratios:b||[1,1.1,1.25,1.3333,1.5,1.666,1.75],create:function(a){this.notes=[];for(var b="number"==typeof a?a:c.note(a).fq(),d=0;8>d;d++){for(var e=0;e<this.ratios.length;e++){var f=e,g=b*(1+Math.floor(f/this.ratios.length));this.notes.push(g*this.ratios[f%this.ratios.length])}b*=2}b="number"==typeof a?a:c.note(a).fq();for(var d=-1;d>=-8;d--){b/=2;for(var e=0;e<this.ratios.length;e++){var h=d*this.ratios.length+e,f=e,g=b*(1+Math.floor(f/this.ratios.length));this.notes[h]=g*this.ratios[f%this.ratios.length]}}},chord:function(a,b){var c=[];b=b||0;for(var d=0;d<a.length;d++)c.push(this.notes[a[d]+b]);return c}};return d.create(a),d},Scales:{Major:function(a){return e.CustomScale(a,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Ionian:function(a){return e.CustomScale(a,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Dorian:function(a){return e.CustomScale(a,[1,9/8,1.2,4/3,1.5,5/3,1.8])},Phrygian:function(a){return e.CustomScale(a,[1,16/15,1.2,4/3,1.5,1.6,1.8])},Lydian:function(a){return e.CustomScale(a,[1,9/8,5/4,45/32,1.5,5/3,15/8])},Mixolydian:function(a){return e.CustomScale(a,[1,9/8,5/4,4/3,1.5,1.6,1.8])},Minor:function(a){return e.CustomScale(a,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Aeolian:function(a){return e.CustomScale(a,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Locrian:function(a){return e.CustomScale(a,[1,16/15,1.2,4/3,62/45,1.6,15/8])},MajorPentatonic:function(a){return e.CustomScale(a,[1,9/8,5/4,1.5,5/3])},MinorPentatonic:function(a){return e.CustomScale(a,[1,1.2,4/3,1.5,15/8])},Chromatic:function(a){return e.CustomScale(a,[1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,7/4,15/8])},HalfWhole:function(a){return e.CustomScale(a,[1,1.059463,1.189207,1.259921,1.414214,1.498307,1.681793,1.781797])},WholeHalf:function(a){return e.CustomScale(a,[1,1.122462,1.189207,1.33484,1.414214,1.587401,1.681793,1.887749])},Pythagorean:function(a){return e.CustomScale(a,[1,256/243,9/8,32/27,81/64,4/3,729/512,1.5,128/81,27/16,16/9,243/128])},PythagoreanMajor:function(a){return e.CustomScale(a,[1,9/8,81/64,4/3,1.5,27/16,243/128])},PythagoreanMinor:function(a){return e.CustomScale(a,[1,9/8,32/27,4/3,1.5,128/81,16/9])},Limit5:function(a){return e.CustomScale(a,[1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,1.8,15/8])},Limit5Major:function(a){return e.CustomScale(a,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Limit5Minor:function(a){return e.CustomScale(a,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Mess3:function(a){return e.CustomScale(a,[1,1.122462,1.189207,1.259921,1.414214,1.498307,1.587401,1.781797,1.887749]);

},Mess4:function(a){return e.CustomScale(a,[1,1.059463,1.122462,1.33484,1.414214,1.498307,1.587401,1.887749])},Mess5:function(a){return e.CustomScale(a,[1,1.059463,1.33484,1.414214,1.498307,1.887749])},Mess6:function(a){return e.CustomScale(a,[1,1.122462,1.259921,1.33484,1.414214,1.587401,1.781797,1.887749])},Mess7:function(a){return e.CustomScale(a,[1,1.059463,1.122462,1.189207,1.33484,1.414214,1.498307,1.587401,1.681793,1.887749])},Adams:function(a){return e.CustomScale(a,[1,1.122462,1.259921,1.414214,1.498307,1.681793,1.781797])},Equal5Tone:function(a){return e.CustomScale(a,[1,1.15,1.32,1.35,1.52,1.74])},Equal7Tone:function(a){return e.CustomScale(a,[1,1.1,1.22,1.35,1.49,1.64,1.81])},Just:function(a){return e.CustomScale(a,[1,1.0417,1.125,1.2,1.25,1.3333,1.4063,1.5,1.6,1.6667,1.8,1.875])},Shruti:function(a){return e.CustomScale(a,[1,256/243,16/15,10/9,9/8,32/27,1.2,5/4,81/64,4/3,1.35,45/32,729/512,1.5,128/81,1.6,5/3,27/16,16/9,1.8,15/8,243/128,2])}},chord:function(a){if(this.notation=a,"string"==typeof this.notation){var b,d,f=this.notation.slice(0,1);isNaN(this.notation.charAt(1))?(f+=this.notation.charAt(1),b=parseInt(this.notation.slice(2,3)),d=this.notation.slice(3)):(b=parseInt(this.notation.slice(1,2)),d=this.notation.slice(2));for(var g=c.note(f+b).chord(d),h=0;h<g.notes.length;h++){var i=g.notes[h];this.note("number"==typeof k?k:i.fq())}}else for(var j=0;j<this.notation.length;j++){var k,l=this.scale?this.scale.notes[this.notation[j]]:this.notation[j];switch(typeof l){case"number":k=l;break;case"object":k=l.fq?l.fq():l;break;case"string":k=e.Teoria.note(l).fq()}this.note(k)}return"undefined"!=typeof arguments[1]&&(this.amp=arguments[1]),this}};return e}},{"../../external/teoria.min":4}],22:[function(a,b){(function(a){!function(){"use strict";function c(a,b,d){for(var e in b)d&&(k(b[e])||i(b[e]))?(k(b[e])&&!k(a[e])&&(a[e]={}),i(b[e])&&!i(a[e])&&(a[e]=[]),c(a[e],b[e],d)):void 0!==b[e]&&(a[e]=b[e])}var d="function"==typeof Zepto,e="function"==typeof jQuery,f="object"==typeof a.$||"function"==typeof a.$,g=null,h=d||e||f,i=Array.isArray,j=function(a){return"object"==typeof a},k=function(a){return j(a)&&Object.getPrototypeOf(a)==Object.prototype};g=h?e?jQuery:d?Zepto:f?a.$:{}:{},h||(g.extend=function(a){var b,d=Array.prototype.slice.call(arguments,1);return"boolean"==typeof a&&(b=a,a=d.shift()),d.forEach(function(d){c(a,d,b)}),a},g.isArray=Array.isArray,g.isPlainObject=k,g.type=function(a){return typeof a});var l={};g.subscribe=function(a,b){"undefined"==typeof l[a]&&(l[a]=[]),l[a].push(b)},g.unsubscribe=function(a,b){if("undefined"!=typeof l[a]){var c=l[a];c.splice(c.indexOf(b),1)}},g.publish=function(a,b){if("undefined"!=typeof l[a])for(var c=l[a],d=0;d<c.length;d++)c[d](b)},b.exports=g}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(require,module,exports){!function(){var $=require("./dollar"),Gibber={dollar:$,Presets:{},scale:null,minNoteFrequency:50,started:!1,outputCurves:{LINEAR:0,LOGARITHMIC:1},Pattern:require("./pattern"),"export":function(a){Gibber.Utilities["export"](a),a.Pattern=Gibber.Pattern,Gibber.Audio&&Gibber.Audio["export"](a),Gibber.Graphics&&Gibber.Graphics["export"](a),Gibber.Interface&&Gibber.Interface["export"](a),Gibber.Communication&&Gibber.Communication["export"](a)},init:function(a){"undefined"==typeof window?(window=GLOBAL,document=GLOBAL.document=!1):"undefined"!=typeof GLOBAL&&(GLOBAL.document||(document=GLOBAL.document=!1));var b={globalize:!0,canvas:null,target:window,graphicsMode:"3d"};if("object"==typeof a&&$.extend(b,a),Gibber.Audio)if(Gibber.Audio.init(),b.globalize)b.target.Master=Gibber.Audio.Master;else{var c=Gibber["export"].bind(Gibber);$.extend(Gibber,Gibber.Audio),Gibber["export"]=c}Gibber.Graphics,Gibber.Interface,b.globalize&&Gibber["export"](b.target),b.target.$=$,Gibber.Utilities.init()},Modules:{},"import":function(a,b){var c=null;if(console.log("Loading module "+a+"..."),-1===a.indexOf("http:"))console.log("loading via post",a),$.post(Gibber.Environment.SERVER_URL+"/gibber/"+a,{},function(d){d=JSON.parse(d);var e=new Function("return "+d.text);return Gibber.Modules[a]=e(),b&&Gibber.Modules[a]&&$.extend(b,Gibber.Modules[a]),Gibber.Modules[a]?("function"==typeof Gibber.Modules[a].init&&Gibber.Modules[a].init(),console.log("Module "+a+" is now loaded.")):console.log("Publication "+a+" is loaded. It may not be a valid module."),null!==c&&c(Gibber.Modules[a]),!1});else{var d=document.createElement("script");d.src=a,d.onload=function(){console.log("Module "+a+" is now loaded."),null!==c&&c()},document.head.appendChild(d)}return{done:function(a){c=a}}},scriptCallbacks:[],run:function(script,pos,cm){var _start=pos.start?pos.start.line:pos.line,tree;try{tree=Gibber.Esprima.parse(script,{loc:!0,range:!0})}catch(e){return void console.error("Parse error on line "+(_start+e.lineNumber)+" : "+e.message.split(":")[1])}for(var __i__=0;__i__<tree.body.length;__i__++){var obj=tree.body[__i__],start={line:_start+obj.loc.start.line-1,ch:obj.loc.start.column},end={line:_start+obj.loc.end.line-1,ch:obj.loc.end.column},src=cm.getRange(start,end),result=null;try{result=eval(src),log("function"!=typeof result?result:"Function")}catch(e){console.error("Error evaluating expression beginning on line "+(start.line+1)+"\n"+e.message)}if(this.scriptCallbacks.length>0)for(var ___i___=0;___i___<this.scriptCallbacks.length;___i___++)this.scriptCallbacks[___i___](obj,cm,pos,start,end,src,_start)}},processArguments:function(a,b){var c;return a.length?"string"==typeof a[0]&&"Drums"!==b&&"XOX"!==b?(c=Gibber.getPreset(a[0],b),"object"==typeof a[1]&&$.extend(c,a[1]),c):Array.prototype.slice.call(a,0):c},processArguments2:function(a,b,c){if(b.length){var d=b[0];if("string"==typeof d&&"Drums"!==c&&"XOX"!==c&&"Shader"!==c)preset=Gibber.getPreset(b[0],c),"object"==typeof b[1]&&$.extend(preset,b[1]),$.extend(a,preset),a.presetInit&&a.presetInit();else if($.isPlainObject(d)&&"undefined"==typeof d.type)$.extend(a,d);else{var e=Object.keys(a.properties);if("FX"===a.type)for(var f=0;f<b.length;f++)a[e[f+1]]=b[f];else for(var f=0;f<b.length;f++)a[e[f]]=b[f]}}},getPreset:function(a,b){var c={};return Gibber.Presets[b]&&Gibber.Presets[b][a]?c=Gibber.Presets[b][a]:Gibber.log(b+" does not have a preset named "+a+"."),c},clear:function(){var b=Array.prototype.slice.call(arguments,0);Gibber.Audio&&Gibber.Audio.clear.apply(Gibber.Audio,b),Gibber.Graphics&&Gibber.Graphics.clear(Gibber.Graphics,b),Gibber.proxy(window,[a]),$.publish("/gibber/clear",{}),console.log("Gibber has been cleared.")},proxy:function(a){for(var b="abcdefghijklmnopqrstuvwxyz",c=0;c<b.length;c++){var d=b.charAt(c);"undefined"!=typeof window[d]&&-1===arguments[1].indexOf(window[d])&&(delete window[d],delete window["___"+d]),function(){var b=d;Object.defineProperty(a,b,{configurable:!0,get:function(){return a["___"+b]},set:function(c){if(c)a["___"+b]&&"function"==typeof a["___"+b].replaceWith&&(a["___"+b].replaceWith(c),console.log(a["___"+b].name+" was replaced with "+c.name)),a["___"+b]=c;else if(a["___"+b]){var d=a["___"+b];d&&"function"==typeof d.kill&&d.kill()}}})}()}},construct:function(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c},createMappingObject:function(a,b){var c="function"==typeof a.min?a.min():a.min,d="function"==typeof a.max?a.max():a.max,e="function"==typeof b.min?b.min():b.min,f="function"==typeof b.max?b.max():b.max;if("undefined"==typeof b.object&&b.Value&&(b=b.Value),"undefined"!=typeof a.object[a.Name].mapping)return void a.object[a.Name].mapping.replace(b.object,b.propertyName,b.Name);"undefined"!=typeof b.targets&&-1===b.targets.indexOf(a)&&b.targets.push([a,a.Name]);var g="Out"!==b.Name?b.timescale:"audioOut";return mapping=Gibber.mappings[a.timescale][g](a,b),Object.defineProperties(a.object[a.Name],{min:{configurable:!0,get:function(){return c},set:function(b){c=b,a.object[a.Name].mapping.outputMin=c}},max:{configurable:!0,get:function(){return d},set:function(b){d=b,a.object[a.Name].mapping.outputMax=d}}}),a.object[a.Name].mappingObjects=[],Gibber.createProxyProperty(a.object[a.Name],"min",1,0,{min:c,max:d,output:a.output,timescale:a.timescale,dimensions:1}),Gibber.createProxyProperty(a.object[a.Name],"max",1,0,{min:c,max:d,output:a.output,timescale:a.timescale,dimensions:1}),Object.defineProperties(b.object[b.Name],{min:{configurable:!0,get:function(){return e},set:function(b){e=b,a.object[a.Name].mapping.inputMin=e}},max:{configurable:!0,get:function(){return f},set:function(b){f=b,a.object[a.Name].mapping.inputMax=f}}}),a.object[a.Name].invert=function(){a.object[a.Name].mapping.invert()},"undefined"==typeof a.object.mappings&&(a.object.mappings=[]),a.object.mappings.push(mapping),"undefined"==typeof b.object.mappings&&(b.object.mappings=[]),b.object.mappings.push(mapping),Gibber.defineSequencedProperty(a.object[a.Name],"invert"),mapping},defineSequencedProperty:function(a,b,c){var d,e,f=a[b];!a.seq&&Gibber.Audio&&(a.seq=Gibber.Audio.Seqs.Seq({doNotStart:!0,scale:a.scale,priority:c,target:a})),f.seq=function(g,h){var i=$.isArray(g)?g:[g],j=$.isArray(h)?h:"undefined"!=typeof h?[h]:null,k={key:b,values:[Gibber.construct(Gibber.Pattern,i)],durations:null!==j?[Gibber.construct(Gibber.Pattern,j)]:null,target:a,priority:c};"undefined"!=typeof d&&(d.shouldStop=!0,a.seq.seqs.splice(e,1));var l=k.values[0];if(i.randomFlag){l.filters.push(function(){var a=Gibber.Utilities.rndi(0,l.values.length-1);return[l.values[a],1,a]});for(var m=0;m<i.randomArgs.length;m+=2)l.repeat(i.randomArgs[m],i.randomArgs[m+1])}if(null!==j){var n=k.durations[0];if(j.randomFlag){n.filters.push(function(){var a=Gibber.Utilities.rndi(0,n.values.length-1);return[n.values[a],1,a]});for(var m=0;m<j.randomArgs.length;m+=2)n.repeat(j.randomArgs[m],j.randomArgs[m+1])}}return a.seq.add(k),e=null!==j?a.seq.seqs.length-1:a.seq.autofire.length-1,d=null!==j?a.seq.seqs[e]:a.seq.autofire[e],Object.defineProperties(f,{values:{configurable:!0,get:function(){return null!==j?a.seq.seqs[e].values[0]:a.seq.autofire[e].values[0]},set:function(b){var c=Gibber.construct(Gibber.Pattern,b);Array.isArray(c)||(c=[c]),null!==j?a.seq.seqs[e].values=c:a.seq.autofire[e].values=c}},durations:{configurable:!0,get:function(){return null!==j?a.seq.seqs[e].durations[0]:null},set:function(b){Array.isArray(b)||(b=[b]),a.seq.seqs[e].durations=b}}}),a.seq.isRunning||(a.seq.offset=Gibber.Clock.time(a.offset),a.seq.start(!0,c)),a},f.seq.stop=function(){d.shouldStop=!0},f.seq.start=function(){d.shouldStop=!1,a.seq.timeline[0]=[d],a.seq.nextTime=0,a.seq.isRunning||a.seq.start(!1,c)}},defineRampedProperty:function(a,b){var c,d=a[b],e=b.slice(1);d.ramp=function(b,d,f){return arguments.length<2?void console.err("ramp requires at least two arguments: target and time."):("undefined"==typeof f&&(f=d,d=b,b=a[e]()),c&&c(),"object"!=typeof b?a[e]=Line(b,d,f):b.retrigger(d,Gibber.Clock.time(f)),c=future(function(){a[e]=d},f),a)}},createProxyMethods:function(a,b,c){for(var d=0;d<b.length;d++)Gibber.defineSequencedProperty(a,b[d],c)},defineProperty:function(a,b,c,d,e,f,g){var h="object"==typeof a[b]?a[b].valueOf():a[b],i=b.charAt(0).toUpperCase()+b.slice(1),j=function(c){var d=j;return"undefined"!=typeof c&&(j.oldSetter?j.oldSetter.call(a,c):a[b]=c,d=a),d};e=f?e||a.mappingProperties[b]:null,$.extend(j,e),$.extend(j,{propertyName:b,Name:i,value:h,type:"property",object:a,targets:[],valueOf:function(){return j.value},toString:function(){var a="";return a="object"==typeof j.value?j.value.toString():j.value},oldSetter:a.__lookupSetter__(b),oldGetter:a.__lookupGetter__(b),oldMappingObjectGetter:a.__lookupGetter__(i),oldMappingObjectSetter:a.__lookupSetter__(i)}),Object.defineProperty(a,b,{configurable:!0,get:function(){return j},set:function(b){if("function"!=typeof b&&("object"!=typeof b||"mapping"!==b.type)||"property"!==b.type&&"mapping"!==b.type){f&&a[j.Name]&&"undefined"!=typeof a[j.Name].mapping&&a[j.Name].mapping.remove&&a[j.Name].mapping.remove(!0);var c=b;if(j.oldSetter){var d=j.oldSetter.call(a,b);"undefined"!=typeof d&&(c=d)}j.value=c}else Gibber.createMappingObject(j,b);return a}}),c&&Gibber.defineSequencedProperty(a,b,g),d&&Gibber.defineRampedProperty(a,b),f&&Object.defineProperty(a,j.Name,{configurable:!0,get:function(){return"function"==typeof j.oldMappingObjectGetter&&j.oldMappingObjectGetter(),j},set:function(b){a[j.Name]=b,"function"==typeof mapping.oldMappingObjectSetter&&mapping.oldMappingObjectSetter(b)}})},createProxyProperty:function(a,b,c,d,e,f,g){f=f===!1?!1:!0,Gibber.defineProperty(a,b,c,d,e,f,g)},createProxyProperties:function(a,b,c,d){var e="undefined"==typeof c?!0:c,f="undefined"==typeof d?!0:d;a.gibber=!0,a.mappingProperties=b,a.mappingObjects=[];for(var g in b)b[g].doNotProxy||Gibber.createProxyProperty(a,g,e,f,b[g])}};Gibber.Utilities=require("./utilities")(Gibber),Gibber.mappings=require("./mappings")(Gibber),module.exports=Gibber}()},{"./dollar":22,"./mappings":24,"./pattern":25,"./utilities":26}],24:[function(a,b){b.exports=function(a){var b={audio:{graphics:function(b,c){"undefined"==typeof c.object.track&&(c.object.track={});var d,e="undefined"!=typeof c.object.track[c.propertyName]?c.object.track[c.propertyName]:new a.Audio.Core.Proxy2(c.object,c.propertyName),f=new a.Audio.Core.OnePole({a0:.005,b1:.995});return c.object.track=e,d=b.object[b.Name].mapping=a.Audio.Core.Binops.Map(e,b.min,b.max,c.min,c.max,b.output,c.wrap),f.input=d,b.object[b.propertyName]=f,d.proxy=e,d.op=f,d.remove=function(a){a||(b.object[b.propertyName]=b.object[b.Name].mapping.getValue()),delete b.object[b.Name].mapping},d},"interface":function(b,c){var d,e="undefined"!=typeof c.track?c.track:new a.Audio.Core.Proxy2(c.object,c.propertyName),f=new a.Audio.Core.OnePole({a0:.005,b1:.995}),g=b.max-b.min,h=(b.object[b.propertyName]-b.min)/g,i=c.min+(c.max-c.min)*h;if(c.object.setValue&&c.object.setValue(i),c.track=e,d=b.object[b.Name].mapping=a.Audio.Core.Binops.Map(e,b.min,b.max,c.min,c.max,b.output,c.wrap),f.input=d,b.object[b.propertyName]=f,d.proxy=e,d.op=f,d.remove=function(a){a||(b.object[b.propertyName]=d.getValue()),delete d},"undefined"!=typeof c.object.label){for(var j="",k=0;k<c.targets.length;k++){var l=c.targets[k];j+=l[0].object.name+"."+l[1],k!==c.targets.length-1&&(j+=" & ")}c.object.label=j}return d.replace=function(a,c,d){e.setInput(a),-1===a[d].targets.indexOf(b)&&a[d].targets.push([b,b.Name])},d},audio:function(b,c){var d,e;return"undefined"!=typeof c.object.track?(d=c.object.track,d.count++):(d=new a.Audio.Core.Proxy2(c.object,c.propertyName),d.count=1),c.object.track=d,b.object[b.propertyName]=a.Audio.Core.Binops.Map(d,b.min,b.max,c.min,c.max),e=b.object[b.Name].mapping=b.object[b.propertyName],e.remove=function(a){a||(b.object[b.propertyName]=e.getValue()),e.op&&e.op.remove(),delete b.object[b.Name].mapping},e.replace=function(c,d,f){var g=new a.Audio.Core.Proxy2(c,d);e.input=g,c[f].targets&&-1===c[f].targets.indexOf(b)&&c[f].targets.push([b,b.Name])},e},audioOut:function(b,c){var d;d=a.Audio.Core.Binops.Map(null,b.min,b.max,0,1,0),b.object[b.propertyName]=b.object[b.Name].mapping=d,"undefined"!=typeof c.object.track?(d.follow=c.object.track,d.follow.count++):(d.follow=new a.Audio.Analysis.Follow({input:c.object,useAbsoluteValue:!0}),d.follow.count=1),c.object.track=d.input=d.follow,d.remove=function(a){a||(b.object[b.propertyName]=b.object[b.Name].mapping.getValue()),d.bus&&d.bus.disconnect(),d.follow&&(d.follow.count--,0===d.follow.count&&(delete c.object.track,d.follow.remove())),delete b.object[b.Name].mapping},d.replace=function(a,c,e){d.follow.input=a,-1===a[e].targets.indexOf(b)&&a[e].targets.push([b,b.Name])};var e=d.follow.bufferSize;return Object.defineProperty(b.object[b.Name],"env",{configurable:!0,get:function(){return e},set:function(b){e=a.Clock.time(b),d.follow.bufferSize=e}}),d}},graphics:{graphics:function(b,c){var d,e=a.Audio.Core.Binops.Map(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap),f=e.getValue.bind(e);return e.getValue=function(){return e.callback(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap),f()},d=b.object[b.Name].mapping=e,b.object.mod?b.object.mod(b.propertyName,d,"="):b.modObject.mod(b.modName,d,"="),d.remove=function(){b.object.mod?b.object.removeMod(b.propertyName):b.modObject.removeMod(b.modName),b.object[b.propertyName]=b.object[b.Name].mapping.getValue(),delete b.object[b.Name].mapping},d.replace=function(a){d.input=a},d},"interface":function(b,c){var d,e=a.Audio.Core.Binops.Map(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap);"undefined"==typeof c.object.functions&&(c.object.functions={},c.object.onvaluechange=function(){for(var a in c.object.functions)c.object.functions[a]()}),d=b.object[b.Name].mapping=e,b.mapping.from=c;var f=b.propertyName+" <- "+c.object.propertyName+"."+c.Name;if(c.object.functions[f]=function(){var a=d.callback(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap);b.object[b.Name].oldSetter.call(b.object[b.Name],a)},d.replace=function(){},d.remove=function(){console.log("mapping removed"),delete c.object.functions[f]},c.object.setValue&&c.object.setValue(b.object[b.propertyName]),"undefined"!=typeof c.object.label){for(var g="",h=0;h<c.targets.length;h++){var i=c.targets[h];g+=i[0].object.propertyName+"."+i[1],h!==c.targets.length-1&&(g+=" & ")}c.object.label=g}return d},audio:function(b,c){var d;d=b.object[b.Name].mapping=a.Audio.Core.Binops.Map(null,b.min,b.max,c.min,c.max,b.output,c.wrap),d.follow="undefined"!=typeof c.object.track?c.object.track:new a.Audio.Core.Follow({input:c.object[c.propertyName],useAbsoluteValue:!1}),c.object.track=b.object[b.Name].mapping.follow,d.input=d.follow,d.bus=new a.Audio.Core.Bus2({amp:0}).connect(),d.connect(d.bus),d.replace=function(a,c,e){d.follow.input=a,-1===a[e].targets.indexOf(b)&&a[e].targets.push([b,b.Name])};var e=d.follow.bufferSize;return Object.defineProperty(b.object[b.Name],"env",{get:function(){return e},set:function(b){e=a.Clock.time(b),d.follow.bufferSize=e}}),b.object.mod?b.object.mod(b.propertyName,d,"="):b.modObject.mod(b.modName,d,"="),d.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete c.object.track,this.follow.remove())),b.object.mod?b.object.removeMod(b.propertyName):b.modObject.removeMod(b.modName),delete b.object[b.Name].mapping},d},audioOut:function(c,d){if("undefined"!=typeof c.object[c.Name].mapping)return e.replace(d.object,d.propertyName,d.Name),e;var e=c.object[c.Name].mapping=a.Audio.Core.Binops.Map(null,c.min,c.max,0,1,0);"undefined"!=typeof d.object.track?(e.follow=d.object.track,e.follow.count++):(e.follow=new a.Audio.Core.Follow({input:d.object}),e.follow.count=1),d.object.track=e.follow;var f=e.follow.bufferSize;return Object.defineProperty(c.object[c.Name],"env",{configurable:!0,get:function(){return f},set:function(b){f=a.Clock.time(b),e.follow.bufferSize=f}}),e.input=e.follow,e.bus=new a.Audio.Core.Bus2({amp:0}).connect(),e.connect(e.bus),e.replace=function(b,f,g){if(b[g].timescale===d.timescale){var h=e.follow.input[d.Name].targets.indexOf(c);h>=-1&&e.follow.input[d.Name].targets.splice(h,1),e.follow.input=b,-1===b[g].targets.indexOf(c)&&b[g].targets.push([c,c.Name])}else e.bus.disconnect(),e.follow.remove(),a.createMappingObject(c,b)},c.object.mod?c.object.mod(c.propertyName,e,"="):c.modObject?c.modObject.mod(c.modName,e,"="):!function(){var a=e;c.object.update=function(){c.object[c.propertyName](a.getValue())}}(),e.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete d.object.track,this.follow.remove())),c.object.mod?c.object.removeMod(c.propertyName):c.modObject&&c.modObject.removeMod(c.modName),c.object.mappings.splice(c.object.mappings.indexOf(e),1),d.object.mappings.splice(d.object.mappings.indexOf(e),1);var a=c.object[c.Name].targets,f=a.indexOf(b);-1!==f&&a.splice(f,1),delete c.object[c.Name].mapping},e}},notation:{graphics:function(b,c){var d,e=a.Audio.Core.Binops.Map(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap),f=e.getValue.bind(e);return e.getValue=function(){return e.callback(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap),f()},d=b.object[b.Name].mapping=e,b.object.mod?b.object.mod(b.propertyName,d,"="):b.modObject.mod(b.modName,d,"="),d.remove=function(){b.object.mod?b.object.removeMod(b.propertyName):b.modObject.removeMod(b.modName),b.object[b.propertyName]=b.object[b.Name].mapping.getValue(),delete b.object[b.Name].mapping},d.replace=function(a){d.input=a},d},"interface":function(b,c){var d,e=a.Audio.Core.Binops.Map(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap);"undefined"==typeof c.object.functions&&(c.object.functions={},c.object.onvaluechange=function(){for(var a in c.object.functions)c.object.functions[a]()}),d=b.object[b.Name].mapping=e,b.mapping.from=c;var f=b.propertyName+" <- "+c.object.propertyName+"."+c.Name;if(c.object.functions[f]=function(){var a=d.callback(c.object[c.propertyName],b.min,b.max,c.min,c.max,b.output,c.wrap);b.object[b.Name].oldSetter.call(b.object[b.Name],a)},d.replace=function(){},d.remove=function(){console.log("mapping removed"),delete c.object.functions[f]},c.object.setValue&&c.object.setValue(b.object[b.propertyName]),"undefined"!=typeof c.object.label){for(var g="",h=0;h<c.targets.length;h++){var i=c.targets[h];g+=i[0].object.propertyName+"."+i[1],h!==c.targets.length-1&&(g+=" & ")}c.object.label=g}return d},audio:function(b,c){var d;d=b.object[b.Name].mapping=a.Audio.Core.Binops.Map(null,b.min,b.max,c.min,c.max,b.output,c.wrap),"undefined"!=typeof c.object.track&&c.object.track.input===c.object.properties[c.propertyName]?(d.follow=c.object.track,d.follow.count++):(d.follow=new a.Audio.Core.Follow({input:c.object.properties[c.propertyName],useAbsoluteValue:!1}),d.follow.count=1),c.object.track=b.object[b.Name].mapping.follow,d.input=d.follow,d.bus=new a.Audio.Core.Bus2({amp:0}).connect(),d.connect(d.bus),d.replace=function(a,c,e){d.follow.input=a,-1===a[e].targets.indexOf(b)&&a[e].targets.push([b,b.Name])};var e=d.follow.bufferSize;return Object.defineProperty(b.object[b.Name],"env",{get:function(){return e},set:function(b){e=a.Clock.time(b),d.follow.bufferSize=e}}),d.update=function(){b.object[b.propertyName](d.getValue())},d.text=b.object,a.Environment.Notation.add(d),d.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete c.object.track,this.follow.remove())),a.Environment.Notation.remove(d),delete b.object[b.Name].mapping},d},audioOut:function(b,c){if("undefined"!=typeof b.object[b.Name].mapping)return d.replace(c.object,c.propertyName,c.Name),d;var d=b.object[b.Name].mapping=a.Audio.Core.Binops.Map(null,b.min,b.max,0,1,0);"undefined"!=typeof c.object.track&&c.object.track.input===c.object.properties[c.propertyName]?(d.follow=c.object.track,d.follow.count++):(d.follow=new a.Audio.Core.Follow({input:c.object,useAbsoluteValue:!0}),d.follow.count=1),c.object.track=d.follow;var e=d.follow.bufferSize;return Object.defineProperty(b.object[b.Name],"env",{configurable:!0,get:function(){return e},set:function(b){e=a.Clock.time(b),d.follow.bufferSize=e}}),d.input=d.follow,d.bus=new a.Audio.Core.Bus2({amp:0}).connect(),d.connect(d.bus),d.replace=function(e,f,g){if(e[g].timescale===c.timescale){var h=d.follow.input[c.Name].targets.indexOf(b);h>=-1&&d.follow.input[c.Name].targets.splice(h,1),d.follow.input=e,-1===e[g].targets.indexOf(b)&&e[g].targets.push([b,b.Name])}else d.bus.disconnect(),d.follow.remove(),a.createMappingObject(b,e)},d.update=function(){b.object[b.propertyName](d.getValue())},d.text=b.object,a.Environment.Notation.add(d),d.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete c.object.track,this.follow.remove())),a.Environment.Notation.remove(d),delete b.object[b.Name].mapping},d}}};return b},b.exports.outputCurves={LINEAR:0,LOGARITHMIC:1}},{}],25:[function(a,b){!function(){"use strict";var a={concat:function(a){this.values=this.values.concat(a.values)},toString:function(){return this.values.toString()},valueOf:function(){return this.values},getLength:function(){var a;return a=this.start<=this.end?this.end-this.start+1:this.values.length+this.end-this.start+1},runFilters:function(a,b){for(var c=[a,1,b],d=0;d<this.filters.length;d++)c=this.filters[d](c);return c},_onchange:function(){}},c=function(){if(!(this instanceof c)){var a=Array.prototype.slice.call(arguments,0);return Gibber.construct(c,a)}var b=function(){var a,c,d,e=b.getLength();return a=1===e?0:Math.floor(b.phase>-1?b.start+b.phase%e:b.end+b.phase%e),c=b.values[Math.floor(a%b.values.length)],d=b.runFilters(c,a),b.phase+=b.stepSize*d[1],c=d[0],"function"==typeof c&&(c=c()),b.update&&(b.update.value=c),c};return $.extend(b,{start:0,end:0,phase:0,values:Array.prototype.slice.call(arguments,0),original:null,storage:[],stepSize:1,integersOnly:!1,repeats:[],filters:[],onchange:null,range:function(){return Array.isArray(arguments[0])?(b.start=arguments[0][0],b.end=arguments[0][1]):(b.start=arguments[0],b.end=arguments[1]),b},reverse:function(){var a,c=b.values,d=null,e=null,f=c.length;for(d=0,e=f-1;e>d;d+=1,e-=1)a=c[d],c[d]=c[e],c[e]=a;return b._onchange(),b},repeat:function(){for(var a={},c=0;c<arguments.length;c+=2)a[arguments[c]]={phase:0,target:arguments[c+1]};var d=!1,e=null,f=function(b){var c=b[0],f=(b[1],b);return d===!1&&a[c]&&(d=!0,e=c),d===!0&&(a[e].phase!==a[e].target?(f[0]=e,f[1]=0,a[e].phase++):(a[e].phase=0,f[1]=1,c!==e?d=!1:a[e].phase++)),f};return b.filters.push(f),b},reset:function(){return b.values=b.original.slice(0),b._onchange(),b},store:function(){return b.storage[b.storage.length]=b.values.slice(0),b},transpose:function(a){for(var c=0;c<b.values.length;c++)b.values[c]+=a;return b._onchange(),b},shuffle:function(){return Gibber.Utilities.shuffle(b.values),b._onchange(),b},scale:function(a){for(var c=0;c<b.values.length;c++)b.values[c]=b.integersOnly?Math.round(b.values[c]*a):b.values[c]*a;return b._onchange(),b},flip:function(){var a=[],c=null;c=b.values.filter(function(b){var c=-1===a.indexOf(b);return c&&a.push(b),c}),c=c.sort(function(a,b){return a-b});for(var d=0;d<b.values.length;d++){var e=c.indexOf(b.values[d]);b.values[d]=c[c.length-e-1]}return b._onchange(),b},invert:function(){for(var a=b.values[0],c=1;c<b.values.length;c++){var d=a+(a-b.values[c]);b.values[c]=d}return b._onchange(),b},"switch":function(a){return b.storage[a]&&(b.values=b.storage[a].slice(0)),b._onchange(),b},rotate:function(a){if(a>0)for(;a>0;){var c=b.values.pop();b.values.unshift(c),a--}else if(0>a)for(;0>a;){var d=b.values.shift();b.values.push(d),a++}return b._onchange(),b}}),b.retrograde=b.reverse.bind(b),b.end=b.values.length-1,b.original=b.values.slice(0),b.storage[0]=b.original.slice(0),b.integersOnly=b.values.every(function(a){return a===+a&&a===(0|a)}),Gibber.createProxyMethods(b,["rotate","switch","invert","reset","flip","transpose","reverse","shuffle","scale","store","range"],!0),Gibber.createProxyProperties(b,{stepSize:0,start:0,end:0}),b.__proto__=this.__proto__,b};c.prototype=a,b.exports=c}()},{}],26:[function(a,b){b.exports=function(a){"use strict";var b=[],c=!1,d=(a.dollar,a.Audio?a.Audio.Core:null,a.Clock,Math.random,{seq:function(){var a=arguments[0],b=typeof a,c=null;return"object"===b&&Array.isArray(a)&&(b="array"),c},random:function(){return this.randomFlag=!0,this.randomArgs=Array.prototype.slice.call(arguments,0),this},random2:function(){for(var a={},b=null,c=this,e=0;e<arguments.length;e+=2)a[""+arguments[e]]={repeat:arguments[e+1],count:0};return this.pick=function(){var e,f,g=0;return c[b]&&(f=c[b]),null!==b&&a[f].count++<=a[f].repeat?(e=b,a[f].count>=a[f].repeat&&(a[f].count=0,b=null)):(e=d.rndi(0,c.length-1),g=c[e],"undefined"!=typeof a[""+g]?(a[""+g].count=1,b=e):b=null),c[e]},this.pick},choose:function(a){var b=null;if(isNaN(a)&&(a=1),1!==a){for(var c=[],e=0;a>e;e++)c[e]=this[d.rndi(0,this.length-1)];b=c}else b=this[d.rndi(0,this.length-1)];return b},future:function(b,c){var d=0,e=a.Audio.Seqs.Seq(function(){1===d&&(b(),e.stop(),e.disconnect()),d++},a.Audio.Clock.time(c));return function(){e.stop(),e.disconnect()}},shuffle:function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);},solo:function(a){var e=Array.prototype.slice.call(arguments,0);if(a){c&&d.solo();for(var f=0;f<e.length;f++){var g=e[f];g.fx.length>0&&(e[f]=g.fx[g.fx.length-1])}for(var h=0;h<Master.inputs.length;h++){var i=e.indexOf(Master.inputs[h].value),j=Master.inputs[h].value,k=j.name;-1===i&&"polyseq"!==k&&"Seq"!==k&&(Master.inputs[h]._amp=Master.inputs[h].amp,Master.inputs[h].amp=0,b.push(Master.inputs[h]))}c=!0}else{for(var h=0;h<b.length;h++)b[h].amp=b[h]._amp;b.length=0,c=!1}},fill:function(a,b){isNaN(a)&&(a=16),"function"!=typeof b&&(b=Rndf()),b=b.bind(this);for(var c=0;a>c;c++)this[c]=b();return this},merge:function(){for(var a=[],b=0;b<this.length;b++){var c=this[b];if(Array.isArray(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(c)}return a},weight:function(){var a=Array.prototype.slice.call(arguments,0);return this.pick=function(){for(var b=this[0],c=0,e=d.rndf(),f=0;f<a.length;f++)if(c+=a[f],c>e){b=f;break}return b},this},gibberArray:function(){},rndf:function(a,b,c,e){if(e="undefined"==typeof e?!0:e,"undefined"==typeof c&&"object"!=typeof a){1==arguments.length?(b=arguments[0],a=0):2==arguments.length?(a=arguments[0],b=arguments[1]):(a=0,b=1);var f=b-a,g=Math.random(),h=f*g;return a+h}var i=[],j=[];"undefined"==typeof c&&(c=b||a.length);for(var k=0;c>k;k++){var l;if("object"==typeof arguments[0])l=arguments[0][rndi(0,arguments[0].length-1)];else if(e)l=d.rndf(a,b);else{for(l=d.rndf(a,b);j.indexOf(l)>-1;)l=d.rndf(a,b);j.push(l)}i.push(l)}return i},Rndf:function(){{var a,b,c,e;Math.random}return 0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):3===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2]):(a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3]),function(){var f,g,h;return g="function"==typeof a?a():a,h="function"==typeof b?b():b,f="undefined"==typeof c?d.rndf(g,h):d.rndf(g,h,c,e)}},rndi:function(a,b,c,e){var f;if(0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):(a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3]),f=b-a,c>f&&(e=!0),"undefined"==typeof c)return f=b-a,Math.round(a+Math.random()*f);for(var g=[],h=[],i=0;c>i;i++){var j;if(e)j=d.rndi(a,b);else{for(j=d.rndi(a,b);h.indexOf(j)>-1;)j=d.rndi(a,b);h.push(j)}g.push(j)}return g},Rndi:function(){{var a,b,c,e,f;Math.random,Math.round}return 0===arguments.length?(a=0,b=1):1===arguments.length?(b=arguments[0],a=0):2===arguments.length?(a=arguments[0],b=arguments[1]):3===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2]):(a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3]),f=b-a,"number"==typeof c&&c>f&&(e=!0),function(){var f,g,h;return g="function"==typeof a?a():a,h="function"==typeof b?b():b,f="undefined"==typeof c?d.rndi(g,h):d.rndi(g,h,c,e)}},"export":function(a){a.rndi=d.rndi,a.rndf=d.rndf,a.Rndi=d.Rndi,a.Rndf=d.Rndf,a.future=d.future,a.solo=d.solo},init:function(){Array.prototype.random=Array.prototype.rnd=d.random}});return d}},{}]},{},[1]);